var PDF_Function = require("PDF_Function");
var PDF_Function = require("PDF_Function");
var mvObjects = require("mvObjects");
var Data = require("Data");
var webObjects = require("webObjects");

function Debug ()
{
//test app 
var vProcess = Sys.Process("iMDSoft.Metavision");
exestatus = true;
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox", "White",exestatus);
//MvAdmissionSummary("CMP11_TC003",exestatus)
   


} 



//******************************************************************************************//
//******************************************************************************************//
// Name :MvLogin
// Desc :Function to login to MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for Login to MV
function MvLogin(TestName,exestatus)
{// starting the TC execution;
 //var objData = Data.getData(TestName,"Navigation");
 var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
 Log.Checkpoint("Start Test Case "+tcDesc );
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//Start of the feature 
Log.Checkpoint("Start Login","The flow is started");

//object to fetch all the data for the parameter
   
    var userName = Data.getData(TestName,"Navigation","UserID");
    var password = Data.getData(TestName,"Navigation","Password");
    var userDepartment = Data.getData(TestName,"Navigation","Department");
    
//Terminate any existing MV Process to tidy up
	if (Sys.WaitProcess("iMDSoft.Metavision").Exists){
  	vProcess = Sys.Process("iMDSoft.Metavision");
  if (vProcess.Find("Name", "WPFObject(\"cboUserName\")", 1000).Exists){
    Log.Message("Already session is active and Relogging in it." );
  
  }
  else {
		Sys.Process("iMDSoft.Metavision").Terminate();
      	// Start MV
    Log.Message("Terminating Metavision session and opening new one");   
  //  var WinFolder = "C:\\Program Files (x86)\\Metavision\\iMDSoft.Metavision.exe";  
    //DbgServices.LaunchApplication(WinFolder);
    TestedApps.iMDSoft_Metavision.Run();
     var Res = Sys.Process("iMDSoft.Metavision").Exists;
   
  // Checks whether MV has started successfully
  if (Res) {
    Log.Picture(Sys.Desktop.Picture());
    Log.Checkpoint("MetaVision has been started successfully.");}
  else{
    Log.Error("MetaVision hasn't been started.");
    exestatus = false;}
    
       }
   
	 }
   else {
    Log.Message("Opening new session of Metavision");   
  	//TestedApps.iMDSoft_Metavision.Run(); 
   // var WinFolder = "C:\\Program Files (x86)\\Metavision\\iMDSoft.Metavision.exe";  
    //DbgServices.LaunchApplication(WinFolder);
    TestedApps.iMDSoft_Metavision.Run();
     var Res = Sys.Process("iMDSoft.Metavision").Exists;
   
  // Checks whether MV has started successfully
  if (Res) {
    Log.Picture(Sys.Desktop.Picture());
    Log.Checkpoint("MetaVision has been started successfully.");}
  else {
    Log.Error("MetaVision hasn't been started.");
    exestatus = false;}
    
     }

	
	// use default password if not passed in
	if (equal(password, "")) {
		password = "P@ssword1";
	} else {
  		password = password;
	}
	
   	vProcess = Sys.Process("iMDSoft.Metavision");
    MemoryVal = vProcess.MemUsage
     Log.Message("The Memory of MetaVision application at Login is "+(MemoryVal/1000)+ " MB."  );  
    
  	// Wait for the login screen to appear
  	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboUserName\")", 120,exestatus);

  	// Enter Login details
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"cboUserName\")", userName,exestatus);
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"passwordBox1\")", password,exestatus);
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"cboDepartment\")", userDepartment,exestatus);
  	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"btnLogin\")",exestatus);

    Sys.WaitProcess("iMDSoft.Metavision",1000);  
    
    	// Check if unsigned actions still open dialog exists and close
	if (vProcess.Find("Name", "WinFormsObject(\"OK\")", 1000).Exists) {
		
    details = mvObjects.getObjectProperty(vProcess, "Name", "WinFormsObject(\"Message\")", "Text",exestatus);
    Log.Error("Login",details)
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    
    exestatus = false;
	}	 
  else {
  	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"HwndSource\: root\")", 30000,exestatus);
    }
  	//Objects.txtParamName1.Check(Aliases.iMDSoft_Metavision.HwndSource_root.root.Part_MainPlaceHolder.FloatingDockPanel.Grid.Items.ContentControl.patientView.Grid.ContentControl.FooterView.Grid.Grid.footerItemsGrid.ContentPresenter.Border.StackPanel.txtParamName);


	
  	// check if on Worklist screen. If so, close Worklist 
   control = vProcess.Find("Name", "WPFObject(\"view\")", 1000);
   if (control.Exists) {
  	  control = vProcess.Find("ToolTip", "Close", 1000);
  	  control.click();
      Log.Checkpoint("MetaVision logged in successfully as '"+ userName+"'" );
      Log.Checkpoint("End Login","MetaVision logged in successfully.");
      
      Log.Picture(Sys.Desktop.Picture());
	}
  
  }
  else {
  Log.Message("Skip Login","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvLogout
// Desc :Function to logout of MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for Logout of MV
function MvLogout(TestName,exestatus)
{
 //var objData = Data.getData(TestName,"Navigation");
 
if (equal(exestatus,true)) {

Log.Checkpoint("Start Logout","The flow is started");   

//object to fetch all the data for the parameter
 
   
  
    vProcess = Sys.Process("iMDSoft.Metavision");
	
    iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
   
   
   // iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.ContentControl.Menu.WPFMenu.Click("[2]|[12]");
     iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.Menu.WPFMenu.Click("[11]");
     
    //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"btnLogin\")",exestatus);
    
    control = vProcess.Find("Name", "WPFObject(\"cboUserName\")", 1000);
   if (control.Exists) {
     Log.Checkpoint("MetaVision session loggged out successfully.");
     Log.Checkpoint("End Logout","MetaVision session loggged out successfully.");
     Log.Picture(Sys.Desktop.Picture());
     MemoryVal = vProcess.MemUsage
     vProcess = null;
     Log.Message("The Memory of MetaVision application at Logout is "+(MemoryVal/1000)+" MB." );  
   }
   else
   {
    Log.Error("Logout","MetaVision session is NOT loggged out successfully.");
    exestatus = false;
   }
   
 }
  else {
  Log.Message("Skip Logout","The feature is skipped since the execution status is set as '"+exestatus+"'");   
  }
 

 var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
 Log.Checkpoint("End Test Case "+tcDesc );   
  return exestatus;

}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientRegister
// Desc :Function to Register patient on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : Satheeshkumar C
// Update date:19-Dec-2018
// Update desc:Updated the feature to register a patient with 48 hrs advance from current time in case the validation is related to Arhive DB
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV Patient Registeration to MV
function MvPatientRegister(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Navigation");
var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
Log.Checkpoint("Start Patient Registeration","The flow is started");
	//Start of the feature 
  
  //If test number CMP2_TC005 is running the check for the bed number from Patient sheet in the data sheet
  //of automation excel sheet and release that bed so that it can be assigned to the patient during the test run.
  if (equal(TestName,"CMP2_TC005"))
  {
     var bed = Data.getData(TestName,"Patient","TransferBed");
     var bedNumber = bed;

     // Open Worklist
  	 exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  
  	 // Wait for Worklist screen to appear
  	 exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
   
     // Find a bed that is empty (or close Bed 02)
    var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
    patientsGrid.Keys("[Home]");
    var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
    Log.Message(RowCount)
    var j = 0;
    for (i = 1; i <= RowCount; i++) {
    // Log.Message(i+ " space "+ RowCount )
     // aqUtils.Delay (3000, "Move to next list item");
          j = j+1; 
     //Log.Message("value of counter" + i);
    // Log.Message( "value of row id "+ j);
    var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  
    if(!patGridRow.exists)
    {
    j=1;
    }
    var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
         patGridRow.Click();
         patGridRow.Keys("[Down]");
         patGridRow.Keys("[Down]");
   
    var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
  	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
  	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
  	Log.Message("Patient Bed Details: "+ patientListDetails);
  
  	if (aqString.Contains(patientListDetails, bedNumber) != -1) {
  		admittedPatientList.ClickR();
  		exestatus = mvObjects.buttonClick(vProcess, "Text", "Patient File",exestatus);
  
  		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
  		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
  		// Enter the Status as  Released
  		exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Released",exestatus);
      exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
      exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient Released as part of Test Automation execution",exestatus);
  		frmPatientRegistration.WinFormsObject("picButtonsContainer").WinFormsObject("cmdOK").Click()
       var MsgForm = vProcess.Find("Name", "WinFormsObject(\"Message\")", 1000);
     
      if (MsgForm.Exists)
      {
      iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("No").Click();
      }
        var ms = 60000;
        var HelpStr = "Delaying test run for " + ms + " milliseconds, To register new patient.";
        aqUtils.Delay (ms, HelpStr);
          Log.CheckPoint("Patient Bed Details is Released "+ patientListDetails);
      break;
    
  	}
  
    
  
  	}
    
  	// Close Worklist
  	control = vProcess.Find("ToolTip", "Close", 1000);
  	control.click();
  }
	

	var facility = Data.getData(TestName,"Navigation","Department");
	var bed = Data.getData(TestName,"Navigation","Bed");
	var layout = Data.getData(TestName,"Navigation","Layout");
  var bedNumber = bed + "  (Active)"
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open Worklist
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  
	// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

     
      
	// Find a bed that is empty (or close Bed 02)
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
	Log.Message("Patient Bed Details: "+ patientListDetails);
  
	if (aqString.Contains(patientListDetails, bedNumber) != -1) {
		admittedPatientList.ClickR();
		exestatus = mvObjects.buttonClick(vProcess, "Text", "Patient File",exestatus);
  
		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
		// Enter the Status as  Released
		exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Released",exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient Released as part of Test Automation execution",exestatus);
		frmPatientRegistration.WinFormsObject("picButtonsContainer").WinFormsObject("cmdOK").Click()
     var MsgForm = vProcess.Find("Name", "WinFormsObject(\"Message\")", 1000);
     
    if (MsgForm.Exists)
    {
    iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("No").Click();
    }
      var ms = 60000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To register new patient.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient Bed Details is Released "+ patientListDetails);
    break;
    
	}
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
    
	// Close Worklist
	control = vProcess.Find("ToolTip", "Close", 1000);
	control.click();
	
	// Create Unique MRN and enter in the datasheet
	//Data.UpdateData(TestName,"Patient","MRN",mvObjects.generateRandomMRN(10));
  
	let patientDetails = new Object();
	patientDetails.gender = Data.getData(TestName,"Patient","Gender");
	patientDetails.dob = Data.getData(TestName,"Patient","DOB");
	patientDetails.allergies = Data.getData(TestName,"Patient","Allergies");
	var bedNumber = Data.getData(TestName,"Patient","Bed");
	
	// Add Patient and demographics
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Emergency Patient Registration");
	
	
	// fetch Patient identifier to the datasheet
	var newPatientMRNTemp = Data.getData(TestName,"Patient","MRN");
  
  newPatientMRN = newPatientMRNTemp + Math.floor(Math.random() * Math.floor(10000));
  
	patientDetails.patientID = newPatientMRN;
	Log.Message("New Patient MRN = " + newPatientMRN);
  
  //Store the new MRN in the excel sheet for further verification
  //This is done as MRN was showing error 
  Data.UpdateData(TestName,"Patient","newPatientMRN",newPatientMRN);
  
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtMRNumber\")", newPatientMRN,exestatus);
  
	// Visit ID WinFormsObject("cboSocialSecurity")
	var newPatientVisitID = Data.getData(TestName,"Patient","VisitID");
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"cboSocialSecurity\")", newPatientVisitID,exestatus);
  
	// first name WinFormsObject("txtFirstName")

	var firstName = Data.getData(TestName,"Patient","FirstName");
	patientDetails.firstName = firstName;
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtFirstName\")", firstName,exestatus);
  
	// last name WinFormsObject("txtLastName")
	var lastName =  Data.getData(TestName,"Patient","LastName");
	patientDetails.lastName = lastName;
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtLastName\")", lastName,exestatus);
  
	// Enter the Status
	exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Admitted",exestatus);
	aqUtils.Delay(500);
  
	// Select BedfreePatientBed
	exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboBed\")", bedNumber,exestatus);
	aqUtils.Delay(500);
  
	// comments WinFormsObject("txtComments")
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient registered " + firstName +" "+ lastName + " for automation testing.",exestatus);
  
	// Change the status and from date to be the same so can save..
	//var statusValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpStatusFromTime\")", 1000);
	//var fromValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpLocationFromTime\")", 1000);
    // have to select the time as current system time
   
 // var dateObj = new Date();
  //var month = dateObj.getUTCMonth() + 1; //months from 1-12
  //var day = dateObj.getUTCDate();
  //var year = dateObj.getUTCFullYear();
  //var hour = dateObj.getHours();
  //var minute = dateObj.getMinutes();
  
  // To proceed with normal registration
  var statusValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpStatusFromTime\")", 1000);
	var fromValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpLocationFromTime\")", 1000);
  
  var TypeOfDB = Data.getData(TestName,"DBUpdate","TypeOfDB");
  if (TypeOfDB == null || TypeOfDB == "" || TypeOfDB == undefined )
  
  { 
	
    // have to select the time as current system time and Change the status and from date to be the same so can save..
	statusValueText = aqObject.GetPropertyValue(statusValueObject.Value, "OleValue");
	admitTime = aqConvert.DateTimeToFormatStr(statusValueText, "%d/%m/%Y %H:%M");
	patientDetails.admissionTime = admitTime;
	fromValueResult = aqObject.SetPropertyValue(fromValueObject, "Value", statusValueText);
  
	     if (fromValueResult) {
		       Log.Checkpoint("Patient File From Date set to Status Date.");
	         } else {
		       Log.Error("Patient File From Date not set to Status Date");
		       exestatus = false;
	         }
           

}
  // To register a patient in 48 hrs advance incase of Archive DB scenarios
  else if (aqString.Compare(TypeOfDB, "Archive", false)== 0)
     {
    
	statusValueText = aqObject.GetPropertyValue(statusValueObject.Value, "OleValue");
	admitTime = aqConvert.DateTimeToFormatStr(statusValueText, "%d/%m/%Y %H:%M");
	ArcRegisDateTime = aqDateTime.AddTime(admitTime, -2, -5, -10, -10);
  patientDetails.admissionTime = ArcRegisDateTime;
  
  statusValueResult = aqObject.SetPropertyValue(statusValueObject, "Value", ArcRegisDateTime);
	fromValueResult = aqObject.SetPropertyValue(fromValueObject, "Value", ArcRegisDateTime);
  
  if (fromValueResult) {
		       Log.Checkpoint("Patient File From Date set to Status Date.");
	         } else {
		       Log.Error("Patient File From Date not set to Status Date");
		       exestatus = false;
	         }
     }  

	// Apply
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdApply\")",exestatus);
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
	// Save Patient
	exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
	// Wait for screen to appear
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WinFormsObject(\"FormCaption\")", 120,exestatus);
	//aqUtils.Delay(10000);
	
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
	exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"FormCaption\")", 30,exestatus);
	patientListFormObject = vProcess.Find("Name", "WinFormsObject(\"frmPatientRegistration\")");
  
	screenMRNObject = vProcess.Find("Name", "WinFormsObject(\"txtMRNumber\")", 100); 
	// Find Patient Number
	screenMRNValue =  aqObject.GetPropertyValue(screenMRNObject, "Text");
	if (aqString.Compare(screenMRNValue, newPatientMRN, false) == 0) {
		Log.Checkpoint("Found expected value "+ newPatientMRN);
	} else {
		Log.Error("Expected value, "+ newPatientMRN +", not found. Found: "+ screenMRNValue);
		exestatus = false;
	}
  
	// Find First Name
	screenFirstNameObject = vProcess.Find("Name", "WinFormsObject(\"txtFirstName\")", 100);
	screenFirstNameValue =  aqObject.GetPropertyValue(screenFirstNameObject, "Text");
	if (aqString.Compare(screenFirstNameValue, firstName, false) == 0) {
		Log.Checkpoint("Found expected value "+ firstName);
	} else {
		Log.Error("Expected value, "+ firstName +", not found. Found: "+ screenFirstNameObject);
		exestatus = false;
	}
    
	// Find Last Name
	screenLastNameObject = vProcess.Find("Name", "WinFormsObject(\"txtLastName\")", 100);
	screenLastNameValue =  aqObject.GetPropertyValue(screenLastNameObject, "Text");
	if (aqString.Compare(screenLastNameValue, lastName, false) == 0) {
    Log.Picture(Sys.Desktop.Picture());
		Log.Checkpoint("Found expected value "+ lastName);
	} else {
		Log.Error("Expected value, "+ lastName +", not found. Found: "+ screenLastNameObject);
		exestatus = false;
	}
  
 if (TypeOfDB == null || TypeOfDB == "" || TypeOfDB == undefined )
 {
	var admission = patientDetails.admissionTime + " ."
	exestatus = mvObjects.verifyCaptionElement("8", admission, "Admission Time",exestatus);
 
  }
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"CmdCancel\")",exestatus);  
  if (equal(exestatus,true)) {
     
	 	  Log.Checkpoint("Patient Registeration is successful for '"+newPatientMRN+"'.");
      Log.Checkpoint("End Patient Registeration","The flow is completed");
      SetHeartRate("50");
    }
  }
  else {
  Log.Message("Skipped Patient Registeration","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientRegisterNoBed
// Desc :Function to register a patient as admitted without bed assigned
// Owner : Jyoti S 
// Creation date: 21/02/2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPatientRegisterNoBed(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Navigation");
var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
Log.Checkpoint("Start Patient Registeration","The flow is started");
	//Start of the feature 
	

	var facility = Data.getData(TestName,"Navigation","Department");
	var bed = Data.getData(TestName,"Navigation","Bed");
	var layout = Data.getData(TestName,"Navigation","Layout");
  var bedNumber = bed + "  (Active)"
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open Worklist
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  
	// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

     
      
	// Find a bed that is empty (or close Bed 02)
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
	Log.Message("Patient Bed Details: "+ patientListDetails);
  
	if (aqString.Contains(patientListDetails, bedNumber) != -1) {
		admittedPatientList.ClickR();
		exestatus = mvObjects.buttonClick(vProcess, "Text", "Patient File",exestatus);
  
		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
		// Enter the Status as  Released
		exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Released",exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient Released as part of Test Automation execution",exestatus);
		frmPatientRegistration.WinFormsObject("picButtonsContainer").WinFormsObject("cmdOK").Click()
     var MsgForm = vProcess.Find("Name", "WinFormsObject(\"Message\")", 1000);
     
    if (MsgForm.Exists)
    {
    iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("No").Click();
    }
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To register new patient.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient Bed Details is Released "+ patientListDetails);
    break;
    
	}
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
    
	// Close Worklist
	control = vProcess.Find("ToolTip", "Close", 1000);
	control.click();
	
	// Create Unique MRN and enter in the datasheet
	//Data.UpdateData(TestName,"Patient","MRN",mvObjects.generateRandomMRN(10));
  
	let patientDetails = new Object();
	patientDetails.gender = Data.getData(TestName,"Patient","Gender");
	patientDetails.dob = Data.getData(TestName,"Patient","DOB");
	patientDetails.allergies = Data.getData(TestName,"Patient","Allergies");
	var bedNumber = Data.getData(TestName,"Patient","Bed");
	
	// Add Patient and demographics
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Emergency Patient Registration");
	
	
	// fetch Patient identifier to the datasheet
	var newPatientMRN = Data.getData(TestName,"Patient","MRN");
  
	patientDetails.patientID = newPatientMRN;
	Log.Message("New Patient MRN = " + newPatientMRN);
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtMRNumber\")", newPatientMRN,exestatus);
  
	// Visit ID WinFormsObject("cboSocialSecurity")
	var newPatientVisitID = Data.getData(TestName,"Patient","VisitID");
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"cboSocialSecurity\")", newPatientVisitID,exestatus);
  
	// first name WinFormsObject("txtFirstName")

	var firstName = Data.getData(TestName,"Patient","FirstName");
	patientDetails.firstName = firstName;
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtFirstName\")", firstName,exestatus);
  
	// last name WinFormsObject("txtLastName")
	var lastName =  Data.getData(TestName,"Patient","LastName");
	patientDetails.lastName = lastName;
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtLastName\")", lastName,exestatus);
  
	// Enter the Status
	exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Admitted",exestatus);
	aqUtils.Delay(500);
  
	// Select BedfreePatientBed
	//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboBed\")", bedNumber,exestatus);
	aqUtils.Delay(500);
  
	// comments WinFormsObject("txtComments")
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient registered " + firstName +" "+ lastName + " for automation testing.",exestatus);
  
 
  // To proceed with normal registration
  var statusValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpStatusFromTime\")", 1000);
	var fromValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpLocationFromTime\")", 1000);
  
  var TypeOfDB = Data.getData(TestName,"DBUpdate","TypeOfDB");
  if (TypeOfDB == null || TypeOfDB == "" || TypeOfDB == undefined )
  
  { 
	
    // have to select the time as current system time and Change the status and from date to be the same so can save..
	statusValueText = aqObject.GetPropertyValue(statusValueObject.Value, "OleValue");
	admitTime = aqConvert.DateTimeToFormatStr(statusValueText, "%d/%m/%Y %H:%M");
	patientDetails.admissionTime = admitTime;
	fromValueResult = aqObject.SetPropertyValue(fromValueObject, "Value", statusValueText);
  
	     if (fromValueResult) {
		       Log.Checkpoint("Patient File From Date set to Status Date.");
	         } else {
		       Log.Error("Patient File From Date not set to Status Date");
		       exestatus = false;
	         }
           

}
  // To register a patient in 48 hrs advance incase of Archive DB scenarios
  else if (aqString.Compare(TypeOfDB, "Archive", false)== 0)
     {
    
	statusValueText = aqObject.GetPropertyValue(statusValueObject.Value, "OleValue");
	admitTime = aqConvert.DateTimeToFormatStr(statusValueText, "%d/%m/%Y %H:%M");
	ArcRegisDateTime = aqDateTime.AddTime(admitTime, -2, -5, -10, -10);
  patientDetails.admissionTime = ArcRegisDateTime;
  
  statusValueResult = aqObject.SetPropertyValue(statusValueObject, "Value", ArcRegisDateTime);
	fromValueResult = aqObject.SetPropertyValue(fromValueObject, "Value", ArcRegisDateTime);
  
  if (fromValueResult) {
		       Log.Checkpoint("Patient File From Date set to Status Date.");
	         } else {
		       Log.Error("Patient File From Date not set to Status Date");
		       exestatus = false;
	         }
     }  

	//Handle the expected error popup
  
  // Apply
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdApply\")",exestatus);
  
  //Handle the Pop Up - Please select a bed for the patient.  
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
    
  // Assign a bed to the patient
  exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboBed\")", bedNumber,exestatus);
	aqUtils.Delay(500);
  
	// Save Patient
	exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
	// Wait for screen to appear
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WinFormsObject(\"FormCaption\")", 120,exestatus);
	//aqUtils.Delay(10000);
	
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
	exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"FormCaption\")", 30,exestatus);
	patientListFormObject = vProcess.Find("Name", "WinFormsObject(\"frmPatientRegistration\")");
  
	screenMRNObject = vProcess.Find("Name", "WinFormsObject(\"txtMRNumber\")", 100); 
	// Find Patient Number
	screenMRNValue =  aqObject.GetPropertyValue(screenMRNObject, "Text");
	if (aqString.Compare(screenMRNValue, newPatientMRN, false) == 0) {
		Log.Checkpoint("Found expected value "+ newPatientMRN);
	} else {
		Log.Error("Expected value, "+ newPatientMRN +", not found. Found: "+ screenMRNValue);
		exestatus = false;
	}
  
	// Find First Name
	screenFirstNameObject = vProcess.Find("Name", "WinFormsObject(\"txtFirstName\")", 100);
	screenFirstNameValue =  aqObject.GetPropertyValue(screenFirstNameObject, "Text");
	if (aqString.Compare(screenFirstNameValue, firstName, false) == 0) {
		Log.Checkpoint("Found expected value "+ firstName);
	} else {
		Log.Error("Expected value, "+ firstName +", not found. Found: "+ screenFirstNameObject);
		exestatus = false;
	}
    
	// Find Last Name
	screenLastNameObject = vProcess.Find("Name", "WinFormsObject(\"txtLastName\")", 100);
	screenLastNameValue =  aqObject.GetPropertyValue(screenLastNameObject, "Text");
	if (aqString.Compare(screenLastNameValue, lastName, false) == 0) {
    Log.Picture(Sys.Desktop.Picture());
		Log.Checkpoint("Found expected value "+ lastName);
	} else {
		Log.Error("Expected value, "+ lastName +", not found. Found: "+ screenLastNameObject);
		exestatus = false;
	}
  
 if (TypeOfDB == null || TypeOfDB == "" || TypeOfDB == undefined )
 {
	var admission = patientDetails.admissionTime + " ."
	exestatus = mvObjects.verifyCaptionElement("8", admission, "Admission Time",exestatus);
 
  }
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"CmdCancel\")",exestatus);  
  if (equal(exestatus,true)) {
     
	 	  Log.Checkpoint("Patient Registeration is successful for '"+newPatientMRN+"'.");
      Log.Checkpoint("End Patient Registeration","The flow is completed");
      SetHeartRate("50");
    }
  }
  else {
  Log.Message("Skipped Patient Registeration","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
  

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientDemographics
// Desc :Function to enter patient details on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV  PatientDemographics to MV
function MvPatientDemographics(TestName,exestatus)
{
 
//Controller for executing or skipping the feature

if (equal(exestatus,true)) {
	
	//Start of the feature 
	//var objData = Data.getData(TestName,"Navigation");
	var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
	var facility = Data.getData(TestName,"Navigation","Department");
	var layout = Data.getData(TestName,"Navigation","Layout");
Log.Checkpoint("Start Patient Demographics","The flow is started.");

	//var objData = Data.getData(TestName,"Patient"); 
	// Patient Details and defaults
	let patientDetails = new Object();
	patientDetails.gender = Data.getData(TestName,"Patient","Gender");
	patientDetails.dob = Data.getData(TestName,"Patient","DOB");
	patientDetails.allergies = Data.getData(TestName,"Patient","Allergies");
  
	var lastName =  Data.getData(TestName,"Patient","LastName");
	var firstName = Data.getData(TestName,"Patient","FirstName");
	patientDetails.lastName = lastName;
	patientDetails.firstName = firstName;
  
var MRN = Data.getData(TestName,"Patient","MRN");
var newPatientMRN = Data.getData(TestName,"Patient","newPatientMRN");
var bedNumber = Data.getData(TestName,"Patient","Bed");
var Title = Data.getData(TestName,"Patient","Title");
var BirthCountry = Data.getData(TestName,"Patient","BirthCountry");
var Aboriginal = Data.getData(TestName,"Patient","Aboriginal");
var Religion = Data.getData(TestName,"Patient","Religion");
var Maritalstatus = Data.getData(TestName,"Patient","Maritalstatus");
var Pref_language = Data.getData(TestName,"Patient","Pref_language");
var Interpreter = Data.getData(TestName,"Patient","Interpreter");
var DateofDeath = Data.getData(TestName,"Patient","DateofDeath");
var TimeofDeath = Data.getData(TestName,"Patient","TimeofDeath");
var Contact_HmC1 = Data.getData(TestName,"Patient","Contact_HmC1");
var Contact_HmC2 = Data.getData(TestName,"Patient","Contact_HmC2");
var Contact_HmC3 = Data.getData(TestName,"Patient","Contact_HmC3");
var Contact_Bus_C1 = Data.getData(TestName,"Patient","Contact_Bus_C1");
var Contact_Bus_C2 = Data.getData(TestName,"Patient","Contact_Bus_C2");
var Contact_Bus_C3 = Data.getData(TestName,"Patient","Contact_Bus_C3");
var Res_Add_L1 = Data.getData(TestName,"Patient","Res_Add_L1");
var Res_Add_L2 = Data.getData(TestName,"Patient","Res_Add_L2");
var Res_Suburb = Data.getData(TestName,"Patient","Res_Suburb");
var Res_State = Data.getData(TestName,"Patient","Res_State");
var Res_Pcode = Data.getData(TestName,"Patient","Res_Pcode");
var Res_Country = Data.getData(TestName,"Patient","Res_Country");
var Mail_Add_L1 = Data.getData(TestName,"Patient","Mail_Add_L1");
var Mail_Add_L2 = Data.getData(TestName,"Patient","Mail_Add_L2");
var Mail_Suburb = Data.getData(TestName,"Patient","Mail_Suburb");
var Mail_Pcode = Data.getData(TestName,"Patient","Mail_Pcode");
var Mail_Country = Data.getData(TestName,"Patient","Mail_Country");
var PC_ConType = Data.getData(TestName,"Patient","PC_ConType");
var PC_Rel_Pat = Data.getData(TestName,"Patient","PC_Rel_Pat");
var PC_Title = Data.getData(TestName,"Patient","PC_Title");
var PC_Gname = Data.getData(TestName,"Patient","PC_Gname");
var PC_Fname = Data.getData(TestName,"Patient","PC_Fname");
var PC_HC1 = Data.getData(TestName,"Patient","PC_HC1");
var PC_HC2 = Data.getData(TestName,"Patient","PC_HC2");
var PC_HC3 = Data.getData(TestName,"Patient","PC_HC3");
var PC_BC1 = Data.getData(TestName,"Patient","PC_BC1");
var PC_BC2 = Data.getData(TestName,"Patient","PC_BC2");
var PC_BC3 = Data.getData(TestName,"Patient","PC_BC3");
var PC_Add_L1 = Data.getData(TestName,"Patient","PC_Add_L1");
var PC_Add_L2 = Data.getData(TestName,"Patient","PC_Add_L2");
var PC_Suburb = Data.getData(TestName,"Patient","PC_Suburb");
var PC_State = Data.getData(TestName,"Patient","PC_State");
var PC_Pcode = Data.getData(TestName,"Patient","PC_Pcode");
var PC_Country = Data.getData(TestName,"Patient","PC_Country");
var PC_Comments = Data.getData(TestName,"Patient","PC_Comments");
var SC_ConType = Data.getData(TestName,"Patient","SC_ConType");
var SC_Rel_Pat = Data.getData(TestName,"Patient","SC_Rel_Pat");
var SC_Title = Data.getData(TestName,"Patient","SC_Title");
var SC_Gname = Data.getData(TestName,"Patient","SC_Gname");
var SC_Fname = Data.getData(TestName,"Patient","SC_Fname");
var SC_HC1 = Data.getData(TestName,"Patient","SC_HC1");
var SC_HC2 = Data.getData(TestName,"Patient","SC_HC2");
var SC_HC3 = Data.getData(TestName,"Patient","SC_HC3");
var SC_BC1 = Data.getData(TestName,"Patient","SC_BC1");
var SC_BC2 = Data.getData(TestName,"Patient","SC_BC2");
var SC_BC3 = Data.getData(TestName,"Patient","SC_BC3");
var SC_Add_L1 = Data.getData(TestName,"Patient","SC_Add_L1");
var SC_Add_L2 = Data.getData(TestName,"Patient","SC_Add_L2");
var SC_Suburb = Data.getData(TestName,"Patient","SC_Suburb");
var SC_State = Data.getData(TestName,"Patient","SC_State");
var SC_Pcode = Data.getData(TestName,"Patient","SC_Pcode");
var SC_Country = Data.getData(TestName,"Patient","SC_Country");
var SC_Comments = Data.getData(TestName,"Patient","SC_Comments");
var SDM_ConType = Data.getData(TestName,"Patient","SDM_ConType");
var SDM_Rel_Pat = Data.getData(TestName,"Patient","SDM_Rel_Pat");
var SDM_Title = Data.getData(TestName,"Patient","SDM_Title");
var SDM_Gname = Data.getData(TestName,"Patient","SDM_Gname");
var SDM_Fname = Data.getData(TestName,"Patient","SDM_Fname");
var SDM_HC1 = Data.getData(TestName,"Patient","SDM_HC1");
var SDM_HC2 = Data.getData(TestName,"Patient","SDM_HC2");
var SDM_HC3 = Data.getData(TestName,"Patient","SDM_HC3");
var SDM_BC1 = Data.getData(TestName,"Patient","SDM_BC1");
var SDM_BC2 = Data.getData(TestName,"Patient","SDM_BC2");
var SDM_BC3 = Data.getData(TestName,"Patient","SDM_BC3");
var SDM_Add_L1 = Data.getData(TestName,"Patient","SDM_Add_L1");
var SDM_Add_L2 = Data.getData(TestName,"Patient","SDM_Add_L2");
var SDM_Suburb = Data.getData(TestName,"Patient","SDM_Suburb");
var SDM_State = Data.getData(TestName,"Patient","SDM_State");
var SDM_Pcode = Data.getData(TestName,"Patient","SDM_Pcode");
var SDM_Country = Data.getData(TestName,"Patient","SDM_Country");
var SDM_Comments = Data.getData(TestName,"Patient","SDM_Comments");
var AC1_ConType = Data.getData(TestName,"Patient","AC1_ConType");
var AC1_Rel_Pat = Data.getData(TestName,"Patient","AC1_Rel_Pat");
var AC1_Title = Data.getData(TestName,"Patient","AC1_Title");
var AC1_Gname = Data.getData(TestName,"Patient","AC1_Gname");
var AC1_Fname = Data.getData(TestName,"Patient","AC1_Fname");
var AC1_HC1 = Data.getData(TestName,"Patient","AC1_HC1");
var AC1_HC2 = Data.getData(TestName,"Patient","AC1_HC2");
var AC1_HC3 = Data.getData(TestName,"Patient","AC1_HC3");
var AC1_BC1 = Data.getData(TestName,"Patient","AC1_BC1");
var AC1_BC2 = Data.getData(TestName,"Patient","AC1_BC2");
var AC1_BC3 = Data.getData(TestName,"Patient","AC1_BC3");
var AC1_Add_L1 = Data.getData(TestName,"Patient","AC1_Add_L1");
var AC1_Add_L2 = Data.getData(TestName,"Patient","AC1_Add_L2");
var AC1_Suburb = Data.getData(TestName,"Patient","AC1_Suburb");
var AC1_State = Data.getData(TestName,"Patient","AC1_State");
var AC1_Pcode = Data.getData(TestName,"Patient","AC1_Pcode");
var AC1_Country = Data.getData(TestName,"Patient","AC1_Country");
var AC1_Comments = Data.getData(TestName,"Patient","AC1_Comments");
var AC2_ConType = Data.getData(TestName,"Patient","AC2_ConType");
var AC2_Rel_Pat = Data.getData(TestName,"Patient","AC2_Rel_Pat");
var AC2_Title = Data.getData(TestName,"Patient","AC2_Title");
var AC2_Gname = Data.getData(TestName,"Patient","AC2_Gname");
var AC2_Fname = Data.getData(TestName,"Patient","AC2_Fname");
var AC2_HC1 = Data.getData(TestName,"Patient","AC2_HC1");
var AC2_HC2 = Data.getData(TestName,"Patient","AC2_HC2");
var AC2_HC3 = Data.getData(TestName,"Patient","AC2_HC3");
var AC2_BC1 = Data.getData(TestName,"Patient","AC2_BC1");
var AC2_BC2 = Data.getData(TestName,"Patient","AC2_BC2");
var AC2_BC3 = Data.getData(TestName,"Patient","AC2_BC3");
var AC2_Add_L1 = Data.getData(TestName,"Patient","AC2_Add_L1");
var AC2_Add_L2 = Data.getData(TestName,"Patient","AC2_Add_L2");
var AC2_Suburb = Data.getData(TestName,"Patient","AC2_Suburb");
var AC2_State = Data.getData(TestName,"Patient","AC2_State");
var AC2_Pcode = Data.getData(TestName,"Patient","AC2_Pcode");
var AC2_Country = Data.getData(TestName,"Patient","AC2_Country");
var AC2_Comments = Data.getData(TestName,"Patient","AC2_Comments");
var AC3_ConType = Data.getData(TestName,"Patient","AC3_ConType");
var AC3_Rel_Pat = Data.getData(TestName,"Patient","AC3_Rel_Pat");
var AC3_Title = Data.getData(TestName,"Patient","AC3_Title");
var AC3_Gname = Data.getData(TestName,"Patient","AC3_Gname");
var AC3_Fname = Data.getData(TestName,"Patient","AC3_Fname");
var AC3_HC1 = Data.getData(TestName,"Patient","AC3_HC1");
var AC3_HC2 = Data.getData(TestName,"Patient","AC3_HC2");
var AC3_HC3 = Data.getData(TestName,"Patient","AC3_HC3");
var AC3_BC1 = Data.getData(TestName,"Patient","AC3_BC1");
var AC3_BC2 = Data.getData(TestName,"Patient","AC3_BC2");
var AC3_BC3 = Data.getData(TestName,"Patient","AC3_BC3");
var AC3_Add_L1 = Data.getData(TestName,"Patient","AC3_Add_L1");
var AC3_Add_L2 = Data.getData(TestName,"Patient","AC3_Add_L2");
var AC3_Suburb = Data.getData(TestName,"Patient","AC3_Suburb");
var AC3_State = Data.getData(TestName,"Patient","AC3_State");
var AC3_Pcode = Data.getData(TestName,"Patient","AC3_Pcode");
var AC3_Country = Data.getData(TestName,"Patient","AC3_Country");
var AC3_Comments = Data.getData(TestName,"Patient","AC3_Comments");
var GP_Title = Data.getData(TestName,"Patient","GP_Title");
var GP_Gname = Data.getData(TestName,"Patient","GP_Gname");
var GP_Fname = Data.getData(TestName,"Patient","GP_Fname");
var GP_Pnum = Data.getData(TestName,"Patient","GP_Pnum");
var GP_Mnum = Data.getData(TestName,"Patient","GP_Mnum");
var GP_Fax = Data.getData(TestName,"Patient","GP_Fax");
var GP_Email = Data.getData(TestName,"Patient","GP_Email");
var GP_Add_L1 = Data.getData(TestName,"Patient","GP_Add_L1");
var GP_Add_L2 = Data.getData(TestName,"Patient","GP_Add_L2");
var GP_Suburb = Data.getData(TestName,"Patient","GP_Suburb");
var GP_State = Data.getData(TestName,"Patient","GP_State");
var GP_Pcode = Data.getData(TestName,"Patient","GP_Pcode");
var GP_Country = Data.getData(TestName,"Patient","GP_Country");
var MO_CHS = Data.getData(TestName,"Patient","MO_CHS");
var MO_AD_Title = Data.getData(TestName,"Patient","MO_AD_Title");
var MO_AD_Gname = Data.getData(TestName,"Patient","MO_AD_Gname");
var MO_AD_Mname = Data.getData(TestName,"Patient","MO_AD_Mname");
var MO_AD_Fname = Data.getData(TestName,"Patient","MO_AD_Fname");
var MO_AM_Title = Data.getData(TestName,"Patient","MO_AM_Title");
var MO_AM_Gname = Data.getData(TestName,"Patient","MO_AM_Gname");
var MO_AM_Mname = Data.getData(TestName,"Patient","MO_AM_Mname");
var MO_AM_Fname = Data.getData(TestName,"Patient","MO_AM_Fname");
var MO_CM1_Title = Data.getData(TestName,"Patient","MO_CM1_Title");
var MO_CM1_Gname = Data.getData(TestName,"Patient","MO_CM1_Gname");
var MO_CM1_Mname = Data.getData(TestName,"Patient","MO_CM1_Mname");
var MO_CM1_Fname = Data.getData(TestName,"Patient","MO_CM1_Fname");
var MO_CM2_Title = Data.getData(TestName,"Patient","MO_CM2_Title");
var MO_CM2_Gname = Data.getData(TestName,"Patient","MO_CM2_Gname");
var MO_CM2_Mname = Data.getData(TestName,"Patient","MO_CM2_Mname");
var MO_CM2_Fname = Data.getData(TestName,"Patient","MO_CM2_Fname");
var MO_RM_Title = Data.getData(TestName,"Patient","MO_RM_Title");
var MO_RM_Gname = Data.getData(TestName,"Patient","MO_RM_Gname");
var MO_RM_Mname = Data.getData(TestName,"Patient","MO_RM_Mname");
var MO_RM_Fname = Data.getData(TestName,"Patient","MO_RM_Fname");
var Add_Cont_Info = Data.getData(TestName,"Patient","Add_Cont_Info");

	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open Patient demographcs
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient Demographics");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"capXP\")", 120,exestatus);
	
	// ** Fill in the Patient details
	Log.Message("*** enter patient demographics form data ***");
	
	
	// Patient Details tab
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TextBlock\", \"Patient Details\", 1)",exestatus);
	tabUpObject = vProcess.Find("Name", "WPFObject(\"cmdTabUp\")", 120);
	
	//dobDay = aqString.substring(patientDetails.dob, 0, 2);
  dobDay =  aqDateTime.GetDay(patientDetails.dob);
	//dobmonth = aqString.substring(patientDetails.dob, 3, 2);
  dobmonth =  aqDateTime.GetMonth(patientDetails.dob);
	//dobyear = aqString.substring(patientDetails.dob, 6, 4);
  dobyear = aqDateTime.GetYear(patientDetails.dob);
  
   
	exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", dobDay, dobmonth, dobyear, "04", "45",exestatus);
	exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")", patientDetails.gender,exestatus);

   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Title,exestatus);
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")", Aboriginal,exestatus);
//<<<<<<< HEAD
   	exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",BirthCountry,exestatus);
//=======
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",BirthCountry,exestatus);
//>>>>>>> 97b79a015b17a49c84c04036b31595b7daf33fe4
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",Religion,exestatus);
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",Maritalstatus,exestatus);
   //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",Pref_language,exestatus);
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",Interpreter,exestatus);
   //exestatus = mvObjects.enterImdDateTimePicker(vProcess,"WPFObject(\"dtpDate_2\")",dobDay,dobmonth,dobyear, "04", "45",exestatus);
   //exestatus = mvObjects.enterImdDateTimePicker(vProcess,"WPFObject(\"dtpDate_3\")",TimeofDeathTime, "04", "45",exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_2\")",Contact_HmC1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_3\")",Contact_HmC2,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_4\")",Contact_HmC3,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_5\")",Contact_Bus_C1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_6\")",Contact_Bus_C2,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_7\")",Contact_Bus_C3,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_8\")",Res_Add_L1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_9\")",Res_Add_L2,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_10\")",Res_Suburb,exestatus);
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",Res_State,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_11\")",Res_Pcode,exestatus);
   //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",Res_Country,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_12\")",Mail_Add_L1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_13\")",Mail_Add_L2,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_14\")",Mail_Suburb,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_15\")",Mail_Pcode,exestatus);
   //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Mail_Country,exestatus);
//<<<<<<< HEAD
  
//=======
//>>>>>>> 97b79a015b17a49c84c04036b31595b7daf33fe4
  
	// ******* Add other combo boxes

	// Contacts tab
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TextBlock\", \"Contacts\", 1)",exestatus);
	tabUpObject.click();

  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_16\")",PC_ConType,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_17\")",PC_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_18\")",PC_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_19\")",PC_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_20\")",PC_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_21\")",PC_HC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_22\")",PC_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_23\")",PC_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_24\")",PC_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_25\")",PC_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_26\")",PC_BC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_27\")",PC_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_28\")",PC_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_29\")",PC_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",PC_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_30\")",PC_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",PC_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_31\")",PC_Comments,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_32\")",SC_ConType,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_33\")",SC_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_34\")",SC_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_35\")",SC_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_36\")",SC_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_37\")",SC_HC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_38\")",SC_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_39\")",SC_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_40\")",SC_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_41\")",SC_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_42\")",SC_BC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_43\")",SC_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_44\")",SC_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_45\")",SC_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",SC_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_46\")",SC_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",SC_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_47\")",SC_Comments,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_52\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_48\")",SDM_ConType,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_16\")",SDM_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_49\")",SDM_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_50\")",SDM_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_51\")",SDM_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_52\")",SDM_HC1,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_57\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_53\")",SDM_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_54\")",SDM_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_55\")",SDM_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_56\")",SDM_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_57\")",SDM_BC3,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_62\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_58\")",SDM_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_59\")",SDM_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_60\")",SDM_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_17\")",SDM_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_61\")",SDM_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_18\")",SDM_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_62\")",SDM_Comments,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_68\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_63\")",AC1_ConType,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_64\")",AC1_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_65\")",AC1_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_66\")",AC1_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_67\")",AC1_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_68\")",AC1_HC1,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_73\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_69\")",AC1_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_70\")",AC1_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_71\")",AC1_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_72\")",AC1_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_73\")",AC1_BC3,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_78\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_74\")",AC1_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_75\")",AC1_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_76\")",AC1_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_19\")",AC1_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_77\")",AC1_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_20\")",AC1_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_78\")",AC1_Comments,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_88\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_79\")",AC2_ConType,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_21\")",AC2_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_80\")",AC2_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_81\")",AC2_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_82\")",AC2_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_83\")",AC2_HC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_84\")",AC2_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_85\")",AC2_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_86\")",AC2_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_87\")",AC2_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_88\")",AC2_BC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_89\")",AC2_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_90\")",AC2_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_91\")",AC2_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_22\")",AC2_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_92\")",AC2_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_23\")",AC2_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_93\")",AC2_Comments,exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_103\")",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_94\")",AC3_ConType,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_24\")",AC3_Rel_Pat,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_95\")",AC3_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_96\")",AC3_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_97\")",AC3_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_98\")",AC3_HC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_99\")",AC3_HC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_100\")",AC3_HC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_101\")",AC3_BC1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_102\")",AC3_BC2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_103\")",AC3_BC3,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_104\")",AC3_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_105\")",AC3_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_106\")",AC3_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_25\")",AC3_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_107\")",AC3_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_26\")",AC3_Country,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_108\")",AC3_Comments,exestatus);
  
  
	// GP and Carers tab
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TextBlock\", \"GP and Carers\", 1)", exestatus);
	tabUpObject.click();    
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_109\")",GP_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_110\")",GP_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_111\")",GP_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_112\")",GP_Pnum,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_113\")",GP_Mnum,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_114\")",GP_Fax,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_115\")",GP_Email,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_119\")",GP_Add_L1,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_116\")",GP_Add_L2,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_117\")",GP_Suburb,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_27\")",GP_State,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_118\")",GP_Pcode,exestatus);
  //exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_28\")",GP_Country,exestatus);
  
	// Medical Officers tab
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TextBlock\", \"Medical Officers\", 1)",exestatus); 
	tabUpObject.click();   
//<<<<<<< HEAD
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_120\")",MO_CHS,exestatus);  
//=======
	//exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_120\")",MO_CHS,exestatus);  
//>>>>>>> 97b79a015b17a49c84c04036b31595b7daf33fe4
	exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_121\")",MO_AD_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_122\")",MO_AD_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_123\")",MO_AD_Mname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_124\")",MO_AD_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_125\")",MO_AM_Title,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_126\")",MO_AM_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_127\")",MO_AM_Mname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_128\")",MO_AM_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_129\")",MO_CM1_Title,exestatus);	 
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_130\")",MO_CM1_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_131\")",MO_CM1_Mname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_132\")",MO_CM1_Fname,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_133\")",MO_CM2_Title,exestatus);	 
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_134\")",MO_CM2_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_135\")",MO_CM2_Mname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_136\")",MO_CM2_Fname,exestatus);
   exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_137\")",MO_RM_Title,exestatus);	 
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_138\")",MO_RM_Gname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_139\")",MO_RM_Mname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_140\")",MO_RM_Fname,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_141\")",Add_Cont_Info,exestatus);
//<<<<<<< HEAD
  
  
  	 
//=======
    	 
//>>>>>>> 97b79a015b17a49c84c04036b31595b7daf33fe4
	// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("PatientDemographics Saved Time: "+ timeSavedValue);
  
	// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 
	// to do - check values..
  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	
	// find Status bar object
	vContentControl5 = vProcess.Find("Name", "WPFObject(\"ContentControl\", \"\", 5)", 1000);
	
	// Check logged in user
	vGrid1 = vContentControl5.Find("Name", "WPFObject(\"ContentPresenter\", \"\", 2)", 1000);
	vStatusBarText1 = mvObjects.getObjectProperty(vGrid1, "Name", "WPFObject(\"txtParamValue\")", "Text",exestatus);
	
	   Log.Checkpoint( vStatusBarText1 + " user logged on");
	
	// Check for correct facility
 	vGrid2 = vContentControl5.Find("Name", "WPFObject(\"ContentPresenter\", \"\", 3)", 1000);
	vStatusBarText2 = mvObjects.getObjectProperty(vGrid2, "Name", "WPFObject(\"txtParamValue\")", "Text",exestatus);
	if (aqString.Compare(vStatusBarText2, facility, false) == 0) {
	   Log.Checkpoint(facility + " Department Loaded");
	} else {
	   Log.Error(facility + " Department not loaded, found value: " + vStatusBarText2);
	   exestatus = false;
	}
	
	var status = "Admitted";
 
	// Check for correct status
	if (!equal(status, undefined)) {
	 	vGrid2 = vContentControl5.Find("Name", "WPFObject(\"ContentPresenter\", \"\", 4)", 1000);
		vStatusBarText3 = mvObjects.getObjectProperty(vGrid2, "Name", "WPFObject(\"txtParamValue\")", "Text",exestatus);
    
		if (aqString.Compare(vStatusBarText3, status, false) == 0) {
		   Log.Checkpoint("Patient Status is " + status);
		} else {
		   Log.Error("Patient Status should be " + status + ". Found status: " + vStatusBarText3);
		   exestatus = false;
		}
	}
	
	// Check for correct Research Studies
	//if (!equal(research, undefined)) {
	// 	vGrid2 = vContentControl5.Find("Name", "WPFObject(\"ContentPresenter\", \"\", 5)", 1000);
	//	vStatusBarText4 = mvObjects.getObjectProperty(vGrid2, "Name", "WPFObject(\"txtParamValue\")", "Text");
		//if (aqString.Compare(vStatusBarText4, research, false) == 0) {
		//   Log.Checkpoint("Research Studies are " + research);
	//	} else {
		//   Log.Error("Research Studies are " + research + ". Found research: " + vStatusBarText4);
		//   exestatus = false;
	//	}
	//}
	// find Caption bar object
	vContentControl5 = vProcess.Find("Name", "WPFObject(\"captionItemsGrid\", \"\")", 1000);
	
	exestatus = mvObjects.verifyCaptionElement("1", layout, "Layout",exestatus);
	exestatus = mvObjects.verifyCaptionElement("2", bedNumber, "Bed",exestatus);
	exestatus = mvObjects.verifyCaptionElement("3", newPatientMRN, "MRN",exestatus);
	
	// Combine First and last name
	var patientName = patientDetails.firstName + " " + patientDetails.lastName
	exestatus = mvObjects.verifyCaptionElement("4", patientName, "Patient Name",exestatus);
	
	exestatus = mvObjects.verifyCaptionElement("5", patientDetails.allergies, "Allergies",exestatus);
	exestatus = mvObjects.verifyCaptionElement("6", patientDetails.gender, "Patient Gender",exestatus);
  
  if (dobDay < 10) 
  {dobDay = "0"+dobDay}
  if (dobmonth < 10) 
  {dobmonth = "0"+dobmonth}
  
  var tDOB = dobDay +"/"+ dobmonth +"/"+ dobyear;
	exestatus = mvObjects.verifyCaptionElement("7", tDOB, "Patient DOB",exestatus);
	
	
		
	if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient Demographics is successful.");
      Log.Checkpoint("End Patient Demographics","The flow is completed.");
    }
	
  }
  else {
  Log.Message("Skipped Patient Demographics","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvChangePatientStatus
// Desc :Function to change patient status on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV Patient Status to MV
function MvChangePatientStatus(TestName,PatStatus,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start Change Patient Status ","The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 60000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Change patient status.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
	exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"FormCaption\")", 30,exestatus);
	
	patientListFormObject = vProcess.Find("Name", "WinFormsObject(\"frmPatientRegistration\")");
  
	screenMRNObject = vProcess.Find("Name", "WinFormsObject(\"txtMRNumber\")", 100); 
	// Find Patient Number
	var newPatientMRN = Data.getData(TestName,"Patient","newPatientMRN");
	screenMRNValue =  aqObject.GetPropertyValue(screenMRNObject, "Text");
	
	if (aqString.Compare(screenMRNValue, newPatientMRN, false) == 0) {
		Log.Checkpoint("Found expected value "+ newPatientMRN);
	} else {
		Log.Error("Expected value, "+ newPatientMRN +", not found. Found: "+ screenMRNValue);
		exestatus = false;
	}
	
  	// Enter the Status
    
	exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", PatStatus,exestatus);
  
  
	aqUtils.Delay(500);
	
  // Transferring the bed with Admitted status
  var NewBed = Data.getData(TestName,"Patient","TransferBed");
  NewBed = NewBed.replace(/\s/g,'');
  
  if (PatStatus=== "Admitted" && typeof NewBed != 'undefined' && NewBed){    
  
	// Select BedfreePatientBed
	exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboBed\")", NewBed,exestatus);
    aqUtils.Delay(500);
  
	// comments WinFormsObject("txtComments")
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "**Changed Bed for the patient**" ,exestatus);
  
   Log.Checkpoint(" Change Bed "+ NewBed +"is successful for '"+newPatientMRN+"'.");
     aqUtils.Delay(500);
  }
  
  
  
	exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdApply\")",exestatus);
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
	
	     
    if (MsgForm.Exists)
    {
   	 var Msgbutton = vProcess.Find("Name", "WinFormsObject(\"Yes\")", 1000);
	 if (Msgbutton.Exists){
		exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
		}
		var Msgbutton1 = vProcess.Find("Name", "WinFormsObject(\"Proceed\")", 1000);
	 if (Msgbutton1.Exists){
		exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Proceed\")",exestatus);
		}
    }
    
  	// Save Patient
	exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
   
	
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Change Patient Status to "+ PatStatus +"is successful for '"+newPatientMRN+"'.");
      Log.Checkpoint("End Change Patient Status ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Change Patient Status","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientBelongings
// Desc :Function to enter patient Belongings on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV Patient Belongings
function MvPatientBelongings(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start Patient Belongings for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add patient belongings.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Patient Belongings");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter patient belongings form data ***");
	var Clothing = Data.getData(TestName,"Patient","Clothing");
	var Effects = Data.getData(TestName,"Patient","Effects");
	var Security = Data.getData(TestName,"Patient","Security");
	var SecRecNo = Data.getData(TestName,"Patient","SecRecNo");
	var PerChkBel = Data.getData(TestName,"Patient","PerChkBel");
	var PerVerBel = Data.getData(TestName,"Patient","PerVerBel");
	var newPatientMRN = Data.getData(TestName,"Patient","MRN");
  
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Clothing,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Effects,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Security,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",SecRecNo,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",PerChkBel,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",PerVerBel,exestatus);
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Patient Belongings Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Patient Belongings");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", Clothing, "Clothing",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", Effects, "Effects",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Security, "Security",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", SecRecNo, "Security Ref No",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", PerChkBel, "Person Checked",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", PerVerBel, "Person Verified",exestatus);  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Patient Belongings to is successful for '"+newPatientMRN+"'.");
      Log.Checkpoint("End Patient Belongings","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Patient Belongings","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvWorklist
// Desc :Function to search a patient on worklist on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvWorklist(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start MV Work lists ","The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");
  exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

	//Checks or unchecks the specified menu item.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Change Work List Display|NSW|Medical, Default");
 
  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  aqUtils.Delay ("500", "Wait for worklist load data");
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.view.Keys("^[Home]");
  aqUtils.Delay ("500", "Wait for worklist load data");
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
       
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
 
	Log.CheckPoint("Patient Bed Details: "+ patientListDetails);
  		
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
  

  
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Change Work List Display|NSW|Medical, Discharge");


  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  aqUtils.Delay ("500", "Wait for worklist load data");
   Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.view.Keys("^[Home]");
  aqUtils.Delay ("500", "Wait for worklist load data");
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 

  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
 
	Log.CheckPoint("Patient Bed Details: "+ patientListDetails);
  		
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
  

  
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Change Work List Display|NSW|Nursing");

  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  aqUtils.Delay ("500", "Wait for worklist load data");
   Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.view.Keys("^[Home]");
  aqUtils.Delay ("500", "Wait for worklist load data");
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 

  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
 
	Log.CheckPoint("Patient Bed Details: "+ patientListDetails);
  		
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
  

  
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Change Work List Display|NSW|Nursing, In-charge");

  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  aqUtils.Delay ("500", "Wait for worklist load data");
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.view.Keys("^[Home]");
  aqUtils.Delay ("500", "Wait for worklist load data");
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
 
	Log.CheckPoint("Patient Bed Details: "+ patientListDetails);
  		
  
    //if (j === 21 &&  i >=21) 
    //{j=0;}
  
	}
  

  
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|My List");

  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  

  
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("My List|Change Patient Set|NSW|Pre-admit and Admitted Only");
  
  // Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);
  // check if on Worklist screen. If so, close Worklist 
   control = vProcess.Find("Name", "WPFObject(\"view\")", 1000);
   if (control.Exists) {
  	  control = vProcess.Find("ToolTip", "Close", 1000);
  	  control.click();
     
	}
  
  if (equal(exestatus,true)) {
	 
      Log.Checkpoint("End MV Work lists","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  MV Work lists","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvSearchPatient
// Desc :Function to search a patient  on MV
// Owner :Arul 
// Creation date:June 2017
// Update By : Satheeshkumar C
// Update date:14-Dec-17
// Update desc:Updated the feature to get the updateMRN value from different sheet
//******************************************************************************************//
//******************************************************************************************//
function MvSearchPatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc =Data.getData(TestName,"DBUpdate","TC_DESC");
var TypeOfValidation = Data.getData(TestName,"DBUpdate","TypeOfValidation");

   if (TypeOfValidation == null || TypeOfValidation == "" || TypeOfValidation == undefined ){

    var tcDesc =Data.getData(TestName,"Patient","TC_DESC");
    var MRN = Data.getData(TestName,"Patient","newPatientMRN");
   }

   else if (aqString.Compare(TypeOfValidation,"DBUpdatetool",false)==0)
  {
  var tcDesc =Data.getData(TestName,"DBUpdate","TC_DESC");
  var MRN = Data.getData(TestName,"DBUpdate","UpdateMRN");
  } 


//Log.Message("MRN details "+MRN);
Log.Checkpoint("Start MV Search Patient","The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");
  exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

	//Checks or unchecks the specified menu item.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Patient Search");
  
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"PatientSearchViewModel\")", 120,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtSearchText\")", MRN ,exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"ImdButton\", \"Find\", 1)",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  //Log.Message(RowCount)
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 4)", 1000);  
	var searchMRN = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);  
	
	var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
	//var freePatientBed = getEmptyBedFromAdmittedPatientList();  
	Log.Message("Patient MRN: "+ listMRN);
  
	if (aqString.Contains(listMRN, MRN) != -1) {
		admittedPatientList.DblClick();
	
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To load the patient details.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient Found with MRN "+ listMRN);
    k = 1
    break;
    
	}
  
    //if (j === 14 &&  i >=14) 
    //{j=0;}
    k = 0;
	}
  
	control = vProcess.Find("Name","WPFObject(\"btnClose\")", 1000);
	if (control.Exists )
	{
		exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"btnClose\")",exestatus);
		}
    
		control = vProcess.Find("Name", "WPFObject(\"view\")", 1000);
	if (control.Visible) {
  	  control = vProcess.Find("ToolTip", "Close", 1000);
  	  control.click();
       	}
  if (k===0){  
		Log.Error("Patient with MRN "+ MRN +" is not found")
		exestatus = false
    }
			
	

	 
  if (equal(exestatus,true)) {
	 
      Log.Checkpoint("End MV Search Patient","The flow is completed");
      
	    }
  }
  else {
  Log.Message("Skipped  MV Search Patient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVFamilyMeetingNote
// Desc :Feature to validate the family meeting note
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVFamilyMeetingNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start family meeting note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	   
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Medical Notes","ICU","Family Meeting Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_2\")", 120,exestatus);
		// ** Fill in the family meeting notes
	Log.Message("*** enter family meeting note ***");
	var FamMeetingAtten = Data.getData(TestName,"MedicalCare","FamMeetingAtten");
	var FamMeetingNote  = Data.getData(TestName,"MedicalCare","FamMeetingNote");


  
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",FamMeetingAtten,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",FamMeetingNote,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Guardianship order Saved Time: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Family meeting note Saved Time: "+ MsgValue);
  
	
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Medical Notes","ICU","Family Meeting Note");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_2\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", FamMeetingAtten, "FamMeetingAtten",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", FamMeetingNote, "FamMeetingNote",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Family Meeting Note",exestatus);
  
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_2\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", FamMeetingAtten, "FamMeetingAtten",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", FamMeetingNote, "FamMeetingNote",exestatus);
  
  // close the form 
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully updated family meeting note");
      Log.Checkpoint("End family meeting note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Family Meeting Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV Guardianship order
function MvGuardianshiporder(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Guardianship order for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Guardianship order.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes", "Social Work Notes", "Guardianship Order");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Guardianship order form data ***");
	//var OrderExpires = objData("OrderExpires").Value;
	var Relationship = Data.getData(TestName,"MedicalCare","Relationship");
	var Name = Data.getData(TestName,"MedicalCare","Name");
	var Contact_HmC1 = Data.getData(TestName,"MedicalCare","Contact_HmC1");
	var Contact_HmC2 = Data.getData(TestName,"MedicalCare","Contact_HmC2");
	var Contact_Bus = Data.getData(TestName,"MedicalCare","Contact_Bus");
	var Action_Order = Data.getData(TestName,"MedicalCare","Action_Order");
  var Req_Order = Data.getData(TestName,"MedicalCare","Req_Order");
  
  	 exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Relationship,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Name,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Contact_HmC1,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Contact_HmC2,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Contact_Bus,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Action_Order,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Req_Order,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	//timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	//timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Guardianship order Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   // iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes", "Social Work Notes", "Guardianship order");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  //exestatus = mvObjects.waitForObject(vprocess,"WPFObject(\"sessionscontrol\")",120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")", "Text", OrderExpires, "OrderExpires",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text", Relationship, "Relationship",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", Name, "Name",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", Contact_HmC1, "Contact_HmC1",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Contact_HmC2, "Contact_HmC2",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Contact_Bus, "Contact_Bus",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Action_Order, "Action_Order",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text", Req_Order, "Req_Order",exestatus);
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Guardianship order",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text", Relationship, "Relationship",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", Name, "Name",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", Contact_HmC1, "Contact_HmC1",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Contact_HmC2, "Contact_HmC2",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Contact_Bus, "Contact_Bus",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Action_Order, "Action_Order",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text", Req_Order, "Req_Order",exestatus);
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
 
   
  
  
  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Guardianship order to is successful");
      Log.Checkpoint("End Guardianship order","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Guardianship order","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVClinicalProcedureSafetyChecklist
// Desc :Feature to validate clinical Procedure Safety Checklist
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:24-Nov-17
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVClinicalProcedureSafetyChecklist(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Clinical Procedure Safety Checklist for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Clinical Procedure Safety Checklist (Timeout) ", "Level 1 & 2");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
		// ** Fill in the details for Clinical procedure safety checklist **
	Log.Message("*** enter details for Clinical procedure safety checklist ***");
	
  var Procedure = Data.getData(TestName,"MedicalCare","Procedure");
	var PatientIndentification = Data.getData(TestName,"MedicalCare","PatientIndentification");
  var ProcedureVerification  = Data.getData(TestName,"MedicalCare","ProcedureVerification");
  var AllergyAdverseReaction = Data.getData(TestName,"MedicalCare","AllergyAdverseReaction");
  var AnticipatedCriticalEvents = Data.getData(TestName,"MedicalCare","AnticipatedCriticalEvents");
  var ConsentObtained = Data.getData(TestName,"MedicalCare","ConsentObtained");
  var PatientPosition = Data.getData(TestName,"MedicalCare","PatientPosition");
  var EssentialImag = Data.getData(TestName,"MedicalCare","EssentialImag");
  var SpecialMedicationAdmini = Data.getData(TestName,"MedicalCare","SpecialMedicationAdmini");
  var Antibiotics = Data.getData(TestName,"MedicalCare","Antibiotics");
  var Documentation = Data.getData(TestName,"MedicalCare","Documentation");
  var ClinicalHandOver = Data.getData(TestName,"MedicalCare","ClinicalHandOver");
  var SpecimanOrImageLabelled = Data.getData(TestName,"MedicalCare","SpecimanOrImageLabelled");
  var PostProcedureTest = Data.getData(TestName,"MedicalCare","PostProcedureTest");
  var EquipmentOrIssueDocumneted = Data.getData(TestName,"MedicalCare","EquipmentOrIssueDocumneted");
  var CPSCComments = Data.getData(TestName,"MedicalCare","CPSCComments");
  var Other = Data.getData(TestName,"MedicalCare","Other");
  	
 

    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Procedure,exestatus);
  
  switch (Procedure)
{
  case "Ascitic tab":
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "Biopsies":
 
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "CVC insertion":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "CVC removal":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "ICC insertion":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "ICC removal":
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "IV contrast":
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "IV or IT chemotherapy":
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "Lumbar puncture":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "Stress test":
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "IDC insertion":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "IDC removal":

  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "NGT insertion":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "NGT removal":
    
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "Peripheral cannula insertion":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);

  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  case "Superficial skin lesions biopsies":
  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);

  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  break;
  
  default :
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",PatientIndentification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ProcedureVerification,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",AllergyAdverseReaction,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",AnticipatedCriticalEvents,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",ConsentObtained,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",PatientPosition,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",EssentialImag,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SpecialMedicationAdmini,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",Antibiotics,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Documentation,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ClinicalHandOver,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",SpecimanOrImageLabelled,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",PostProcedureTest,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",EquipmentOrIssueDocumneted,exestatus);
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",CPSCComments,exestatus);
  exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_1\")",Other,exestatus);
  break;
  }
  
  
  
  
  
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Clinical Procedure Safety Checklist Saved Time: "+ timeSavedValue);
	
        // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);    
       

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	
  //Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Clinical Procedure Safety Checklist (Timeout) ", "Level 1 & 2");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  //Validation of documented values 
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",Procedure,"Procedure",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",PatientIndentification,"PatientIndentification",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",ProcedureVerification,"ProcedureVerification",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",AllergyAdverseReaction,"AllergyAdverseReaction",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",AnticipatedCriticalEvents,"AnticipatedCriticalEvents",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",ConsentObtained,"ConsentObtained",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",PatientPosition,"PatientPosition",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",EssentialImag,"EssentialImag",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")", "Text",SpecialMedicationAdmini,"SpecialMedicationAdmini",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_10\")", "Text",Antibiotics,"Antibiotics",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",Documentation,"Documentation",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_12\")", "Text",ClinicalHandOver,"ClinicalHandOver",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_13\")", "Text",SpecimanOrImageLabelled,"SpecimanOrImageLabelled",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_14\")", "Text",PostProcedureTest,"PostProcedureTest",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_15\")", "Text",EquipmentOrIssueDocumneted,"EquipmentOrIssueDocumneted",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",CPSCComments,"CPSCComments",exestatus);
  
  
  
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
    
    
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented clinical procedure safety checklist");
      Log.Checkpoint("End clinical procedure safety checklist","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped successfully documented clinical procedure safety checklist","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

// Feature created for MV Referral/Consultation Form
function MvReferralConsultationForm(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Referral/Consultation Form for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Referral/Consultation Form.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Nursing Notes", "Referral/Consultation Form");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Referral/Consultation form data ***");
	var ClinicalTeam = Data.getData(TestName,"MedicalCare","ClinicalTeam");
	var ClinicalTeamContact = Data.getData(TestName,"MedicalCare","ClinicalTeamContact");
	var Ref_ClinicianName = Data.getData(TestName,"MedicalCare","Ref_ClinicianName");
	var Refd_ClinicianName = Data.getData(TestName,"MedicalCare","Refd_ClinicianName");
	var Rsn_Consul = Data.getData(TestName,"MedicalCare","Rsn_Consul");
	var Prov_Diagnosis = Data.getData(TestName,"MedicalCare","Prov_Diagnosis");
	var Summary = Data.getData(TestName,"MedicalCare","Summary");
        var Obj_Consul = Data.getData(TestName,"MedicalCare","Obj_Consul");
        var Consul_Rep = Data.getData(TestName,"MedicalCare","Consul_Rep");
        var As_Req = Data.getData(TestName,"MedicalCare","As_Req");
    
  exestatus= mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_1\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "WPFControlText", "ICU",exestatus);
  exestatus= mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_1\")",exestatus);
  
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",ClinicalTeamContact,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Ref_ClinicianName,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Refd_ClinicianName,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Rsn_Consul,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Prov_Diagnosis,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Summary,exestatus);
         //uncomment it back
         //exestatus = mvObjects.objectFocusClick(vProcess, "Name","WPFObject(\"picTextList_2\")",exestatus);
      // exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 1)",Obj_Consul,exestatus);
      
       set = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Advise on management ",exestatus);
       exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",Consul_Rep,exestatus);
       //exestatus = mvObjects.objectFocusClick(vProcess, "Name","WPFObject(\"picTextList_3\")",exestatus);
       //exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 1)",As_Req,exestatus);
       
        set = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")","Advise on management ",true);
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	//timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	//timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Referral/Consultation Form Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);

  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Nursing Notes", "Referral/Consultation Form");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  //uncomment below line
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", ClinicalTeam, "ClinicalTeam",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", ClinicalTeamContact, "ClinicalTeamContact",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Ref_ClinicianName, "Ref_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Refd_ClinicianName, "Refd_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Rsn_Consul, "Rsn_Consul",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", Prov_Diagnosis, "Prov_Diagnosis",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", Summary, "Summary",exestatus);
 //uncomment below line
 //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", Obj_Consul, "Obj_Consul",exestatus);
 exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"txtFreeText_8\")", "Text", Consul_Rep, "Consul_Rep",exestatus);
 //exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"ListBoxItem\", \"\", 1)", "Text", As_Req, "As_Req",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
 // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Referral/Consultation Form",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", ClinicalTeamContact, "ClinicalTeamContact",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Ref_ClinicianName, "Ref_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Refd_ClinicianName, "Refd_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Rsn_Consul, "Rsn_Consul",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", Prov_Diagnosis, "Prov_Diagnosis",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", Summary, "Summary",exestatus);
 //uncomment below line
 //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", Obj_Consul, "Obj_Consul",exestatus);
 exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"txtFreeText_8\")", "Text", Consul_Rep, "Consul_Rep",exestatus);
 //exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"ListBoxItem\", \"\", 1)", "Text", As_Req, "As_Req",exestatus);
  
	// close the form 
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  //function ProgressNotes(ProgressNotes) {

	//vProcess = Sys.Process("iMDSoft.Metavision");
	//exestatus = mvObjects.buttonClick(vProcess, "WPFControlText", "Progress Notes");
	//mvObjects.waitForObject(vProcess, "WPFObject(\"ImdButton\", \"\", 1)", 60);
  //}
  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Referral/Consultation Form to is successful");
      Log.Checkpoint("End Referral/Consultation Form","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Referral/Consultation Form","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


// Name :MvUpdateProblemList
// Desc :Feature to Update problem List
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :Sangiliraja J
// Update date:Dec 08 2017
// Update desc:Added Estimated date field
//******************************************************************************************//
//******************************************************************************************//


// Feature created for MV UpdateProblemList
function MvUpdateProblemList(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start UpdateProblemList for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add UpdateProblemList.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Medical Notes","ICU","ICU Medical Ward Round Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter UpdateProblemList data ***");
	var WardRoundTeam = Data.getData(TestName,"MedicalCare","WardRoundTeam");
  var Estimated = Data.getData(TestName,"OtherCare1","Estimated");
	var Assessment = Data.getData(TestName,"MedicalCare","Assessment");
	var Significant = Data.getData(TestName,"MedicalCare","Significant");
	var ProblemList_Active = Data.getData(TestName,"MedicalCare","ProblemList_Active");
	var ProblemList_Chronic = Data.getData(TestName,"MedicalCare","ProblemList_Chronic");
	var ProblemList_Resolved = Data.getData(TestName,"MedicalCare","ProblemList_Resolved");
	var MedicalManagement = Data.getData(TestName,"MedicalCare","MedicalManagement");
        var JobList = Data.getData(TestName,"MedicalCare","JobList");
        let ICU = new Object();
        ICU.Estimated = Data.getData(TestName,"OtherCare1","Estimated");
        
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1)",WardRoundTeam,exestatus);
   EstimatedDay = aqDateTime.GetDay(ICU.Estimated);
	 Estimatedmonth = aqDateTime.GetMonth(ICU.Estimated);
	 Estimatedyear = aqDateTime.GetYear(ICU.Estimated);
   
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Assessment,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Significant,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",ProblemList_Active,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",ProblemList_Chronic,exestatus);
   exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_6\")",exestatus);
   
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",ProblemList_Resolved,exestatus);
   
   //exestatus = mvObjects.scrollUntilVisible("WPFObject(\"dtpDate_1\")",exestatus);
   exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_8\")",exestatus);
   //exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_7\")",exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",MedicalManagement,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",JobList,exestatus);
   //exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", EstimatedDay, Estimatedmonth, Estimatedyear, "00", "00",exestatus);
   
   exestatus = mvObjects.scrollUntilVisible("WPFObject(\"cboTextCombo_1\")",exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("UpdateProblemList Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);

	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Medical Notes","ICU","ICU Medical Ward Round Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", WardRoundTeam, "WardRoundTeam",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", Assessment, "Assessment",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Significant, "Significant",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", ProblemList_Active, "ProblemList_Active",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", ProblemList_Chronic, "ProblemList_Chronic",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", ProblemList_Resolved, "ProblemList_Resolved",exestatus);
  
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_8\")",exestatus);
  //exestatus = mvObjects.scrollUntilVisible("WPFObject(\"dtpDate_1\")",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")", "Value", Estimated, "Estimated",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", MedicalManagement, "MedicalManagement",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text", JobList, "JobList",exestatus);
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  aqUtils.Delay(1000);
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ucFormBuilder_FBForm\")",exestatus);
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Problem List");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter UpdateProblemList data ***");
	var ProblemList_Active1 = Data.getData(TestName,"MedicalCare","ProblemList_Active1");
	var ProblemList_Chronic1 = Data.getData(TestName,"MedicalCare","ProblemList_Chronic1");
	var ProblemList_Resolved1 = Data.getData(TestName,"MedicalCare","ProblemList_Resolved1");
	
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ProblemList_Active1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",ProblemList_Chronic1,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",ProblemList_Resolved1,exestatus);
         

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("UpdateProblemList Form Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);

  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Problem List");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", ProblemList_Active1, "ProblemList_Active1",ProblemList_Active,"ProblemList_Active",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", ProblemList_Chronic1, "ProblemList_Chronic1",ProblemList_Chronic,"ProblemList_Chronic",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", ProblemList_Resolved1, "ProblemList_Resolved1",ProblemList_Resolved,"ProblemList_Resolved",exestatus);
  
	aqUtils.Delay(2000);
  
  
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "WPFObject(\"frmMain\", \"\", 1)",exestatus);
	
  
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);
	
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
 

    if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" UpdateProblemList to is successful");
      Log.Checkpoint("End UpdateProblemList","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped UpdateProblemList","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

function MvEndotrachealTube(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Endotracheal Tube documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

  // Patient Details and defaults
 //var ms = 6000;
    //var HelpStr = "Delaying test run for " + ms + " milliseconds, To add family meeting note.";
    //aqUtils.Delay (ms, HelpStr);
  
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Tubes","Airway","Endotracheal Tube (Oral)");
// Wait for screen to appear

//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"\", 1)",exestatus);    
 Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrphanDoseEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutControl", "", 2).WPFObject("Buttom_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("AttachedFormsView", "", 1).WPFObject("Grid", "", 1).WPFObject("ScrollableToolBar", "", 1).WPFObject("ContentPresenter", "", 1).WPFObject("Button", "", 1).Click();   
// ** Fill in the details for Endotracheal Tube **
Log.Message("*** enter details for Endotracheal Tube ***");
 
var ETTType = Data.getData(TestName,"MedicalCare","ETTType");
var ETTSize  = Data.getData(TestName,"MedicalCare","ETTSize");
var CuffPressure = Data.getData(TestName,"MedicalCare","CuffPressure");
var ETTPositionatTeeth = Data.getData(TestName,"MedicalCare","ETTPositionatTeeth");


exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ETTType,exestatus);  
exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"txtNumeric_1\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"txtNumeric_1\")",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",ETTSize,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",CuffPressure,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",ETTPositionatTeeth,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);



var Airway = Data.getData(TestName,"MedicalCare","Airway");
var LarynxGrade = Data.getData(TestName,"MedicalCare","LarynxGrade");
var FailedExtubation = Data.getData(TestName,"MedicalCare","FailedExtubation");
var FailedNIV = Data.getData(TestName,"MedicalCare","FailedNIV");
var InsertionFailure = Data.getData(TestName,"MedicalCare","InsertionFailure");
var Malposition = Data.getData(TestName,"MedicalCare","Malposition");
var PositionConfirmed = Data.getData(TestName,"MedicalCare","PositionConfirmed");

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Airway,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",LarynxGrade,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_4\")",FailedExtubation,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_5\")",FailedNIV,exestatus);
exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"chkTrue_1\")", 120,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_1\")",InsertionFailure,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_2\")",Malposition,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_3\")",PositionConfirmed,exestatus);

// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

       
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Endotracheal Tube");
      Log.Checkpoint("End Endotracheal Tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Endotracheal Tube initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
// Name :MvOrogastricTube
// Desc :Flow to Document Presence of Orogastric Tube
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :Sangiliraja J
// Update date: Dec 5,2017
// Update desc: Switch case added and tested for different data
//******************************************************************************************//
//******************************************************************************************//
function MvOrogastricTube(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Orogastric Tube documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 vProcess = Sys.Process("iMDSoft.Metavision");
var TypeOfNavigation = Data.getData(TestName,"HandOver","TypeOfNavigation");  
 
 switch (TypeOfNavigation){
 case("Nursing"):
 
 // To select the Orogastric Tube via Nursing menu  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Tubes","Gastrointestinal","Orogastric Tube");
  break;
  
	case ("Medical"):
  // To select the Orogastric Tube via Medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Tubes","Gastrointestinal","Orogastric Tube");
  break;
  
  default:
  Log.Message("Did not enter type of Navigation");
}
  
// To select the attachment button
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
// ** Fill in the details for Orogastric Tube **
Log.Message("*** enter details for Orogastric Tube ***");
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

 
var Use = Data.getData(TestName,"MedicalCare","Use");
var TubeType  = Data.getData(TestName,"MedicalCare","TubeType");
var PositionatTeeth = Data.getData(TestName,"MedicalCare","PositionatTeeth");
var Size = Data.getData(TestName,"MedicalCare","Size");
var Drain = Data.getData(TestName,"HandOver","Drain");
var DrainVolume = Data.getData(TestName,"HandOver","DrainVolume");
var DrainDescription = Data.getData(TestName,"HandOver","DrainDescription");

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Use,exestatus); 
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",TubeType,exestatus);
exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"txtNumeric_1\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"txtNumeric_1\")",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",PositionatTeeth,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Size,exestatus);
 
switch (TypeOfNavigation){
case ("Medical"):
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",Drain,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",DrainDescription,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",DrainVolume,exestatus);
}

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdSave\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);


  
// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
    //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Orogastric Tube");
      Log.Checkpoint("End Orogastric Tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Orogastric Tube initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//***********************************************//
//***********************************************//



//******************************************************************************************//
//******************************************************************************************//
// Name :MvAllergies
// Desc :Feature to add allergies and prescribe medications
// Owner :Ragurathan S
// Creation date:Aug 2017
// Update By :Ragurathan S , Satheeshkumar C
// Update date:August 2017, 7-Dec-17
// Update desc:Modified the script to switch case for drugtype (Satheesh- Updated the feature to handle resolve allergies warning for medication as well)
//******************************************************************************************//
//******************************************************************************************//

function MvAllergies(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start Allergies for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

// Enter the Allergy Details
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Allergies/ADR");


var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
    
  if (allergies.Enabled == true)
  {
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"MvcmdRemoveAllergy\")",exestatus);
  Log.message("Delete the exisiting allergies");
  }
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdAddAllergy\")",exestatus);
    Log.Message("Enter Allergy details");

//Enter the Drug Type and other details
//var objData = Data.getData(TestName,"Medications"); 

 
var type = Data.getData(TestName,"Medications","type");
Log.message("Drug type value is ",type);
var seldrfam = Data.getData(TestName,"Medications","seldrfam");
Log.message("Selected Drug family is ",seldrfam);
var seldrfam1 = Data.getData(TestName,"Medications","seldrfam1");
Log.message("Selected Drug family is ",seldrfam1);
var med = Data.getData(TestName,"Medications","med");
Log.message("Medication ",med);
var ingr = Data.getData(TestName,"Medications","ingr");
Log.message("Ingredient ",ingr);
var msc = Data.getData(TestName,"Medications","msc");
Log.message("Miscellaneous ",msc);
var Rea = Data.getData(TestName,"Medications","Rea");
Log.message("Reactions ",Rea);
var Comment = Data.getData(TestName,"Medications","Comment");
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var FreeText=Data.getData(TestName,"Medications","FreeText");
var Dose = Data.getData(TestName,"Medications","Dose");
var Route = Data.getData(TestName,"Medications","Route");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var additivesdrug = Data.getData(TestName,"Medications","additives_drug");
var quantity = Data.getData(TestName,"Medications","quantity");
var additivesquantity = Data.getData(TestName,"Medications","additives_quantity");
var volume = Data.getData(TestName,"Medications","volume");
var allcomment = Data.getData(TestName,"Medications","allcomment");
var Bodysite = Data.getData(TestName,"Medications","Bodysite");
var Infused = Data.getData(TestName,"Medications","Infused");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");


exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);


switch(type){
case ("Drug Family"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
break;

case ("Drug subfamily"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
break;

case ("Ingredient"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
break;

case ("Miscellaneous"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
break;

default:
Log.Message("Did not enter drug type");

}
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Check for Popup message (Allergen was previouly documented for this patient

var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
if (Msgwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    Log.Message("Allergen details was previously documented for this patient");
    }
    else
{
Log.Message("Allergen details have not been documented for this patient");
}

//Click on Save button in drug details window

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);

//Verify Action issues popup is displayed

var Allmsgwindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergiesActionIssues\")", 1000);


if (Allmsgwindow.Exists)
   {
      exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stlIssues\")",98,55,exestatus);
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"ImdButton\" ,\"View and Acknowledge\")",exestatus);
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);         
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdProceed\")",exestatus);
         

    Log.Checkpoint("Allergy Popup message is displayed");
    }
    else
{
Log.Message("Allergy Popup message is NOT displayed");
}


//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Dose Form
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Dose,exestatus);

//Route
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Route,exestatus);

//Bodysite
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Bodysite,exestatus);



//Infused Over
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"LayoutGroup\", \"\",1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"ComboBoxEdit\", \"\"\, 1).WPFObject(\"ButtonContainer\", \"\"\, 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Infused,exestatus)

//Check for Allergies window

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WPFObject(\"TabItem\", \"Allergies/ADR\", 1))",27,9,exestatus);
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WPFObject(\"TabItem\", \"Allergies/ADR\", 1))",27,17,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

//Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",quantity,exestatus);

//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Check for Missed Dose dialog

var med = vProcess.Find("Name", "WinFormsObject(\"frmMissedDoseDialog\")", 1000);


if (med.Exists)
{
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmlOk\")",exestatus);         
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);        

    Log.Checkpoint("Missed Dose dialog");
    }
    else
{
Log.Message("Missed Dose dialog is NOT displayed");
}


//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Check for Warning Message

var war = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);

if (war.Exists)
{
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"OK\")",exestatus);
Log.Checkpoint("Warning Message is displayed");
}
else
{
Log.Checkpoint("No Warning Message displayed");
}

//Resolve the Allergies warning

switch(type){
case ("Drug Family"):
Log.Message("No Action required");
break;

case ("Drug subfamily"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
//Log.Message("No Action required");

case ("Ingredient"):
Log.Message("No Action required");
break;

case ("Miscellaneous"):
Log.Message("No Action required");
break;

default:
Log.Message("No Allergies Warning");
}     
//Check for Allergies Warning

//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");
   
var allergywindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergyAlert\")", 1000);

if (allergywindow.Exists)
   {
 
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
    Log.Checkpoint("Allergies warning is displayed");
    }
    else
{
Log.Checkpoint("No warning message is displayed");
}

 return exestatus;
}
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvAllergiesOR
// Desc :Feature to add allergies and prescribe medications for Op reports.
// Owner :Mohammad Zeeshan
// Creation date:13 June 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvAllergiesOR(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start Allergies for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

// Enter the Allergy Details
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Allergies/ADR");


var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
    
  if (allergies.Enabled == true)
  {
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"MvcmdRemoveAllergy\")",exestatus);
  Log.message("Delete the exisiting allergies");
  }
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdAddAllergy\")",exestatus);
    Log.Message("Enter Allergy details");

//Enter the Drug Type and other details
//var objData = Data.getData(TestName,"Medications"); 

 
var type = Data.getData(TestName,"Medications","type");
Log.message("Drug type value is ",type);
var seldrfam = Data.getData(TestName,"Medications","seldrfam");
Log.message("Selected Drug family is ",seldrfam);
var seldrfam1 = Data.getData(TestName,"Medications","seldrfam1");
Log.message("Selected Drug family is ",seldrfam1);
var med = Data.getData(TestName,"Medications","med");
Log.message("Medication ",med);
var ingr = Data.getData(TestName,"Medications","ingr");
Log.message("Ingredient ",ingr);
var msc = Data.getData(TestName,"Medications","msc");
Log.message("Miscellaneous ",msc);
var Rea = Data.getData(TestName,"Medications","Rea");
Log.message("Reactions ",Rea);
var Comment = Data.getData(TestName,"Medications","Comment");
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var FreeText=Data.getData(TestName,"Medications","FreeText");
var Dose = Data.getData(TestName,"Medications","Dose");
var Route = Data.getData(TestName,"Medications","Route");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var additivesdrug = Data.getData(TestName,"Medications","additives_drug");
var quantity = Data.getData(TestName,"Medications","quantity");
var additivesquantity = Data.getData(TestName,"Medications","additives_quantity");
var volume = Data.getData(TestName,"Medications","volume");
var allcomment = Data.getData(TestName,"Medications","allcomment");
var Bodysite = Data.getData(TestName,"Medications","Bodysite");
var Infused = Data.getData(TestName,"Medications","Infused");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");


exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);


switch(type){
case ("Drug Family"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
break;

case ("Drug subfamily"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
break;

case ("Ingredient"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
break;

case ("Miscellaneous"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
break;

default:
Log.Message("Did not enter drug type");

}
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Check for Popup message (Allergen was previouly documented for this patient

var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
if (Msgwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    Log.Message("Allergen details was previously documented for this patient");
    }
    else
{
Log.Message("Allergen details have not been documented for this patient");
}

//Click on Save button in drug details window

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);

//Verify Action issues popup is displayed

var Allmsgwindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergiesActionIssues\")", 1000);


if (Allmsgwindow.Exists)
   {
      exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stlIssues\")",98,55,exestatus);
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"ImdButton\" ,\"View and Acknowledge\")",exestatus);
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);         
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdProceed\")",exestatus);
         

    Log.Checkpoint("Allergy Popup message is displayed");
    }
    else
{
Log.Message("Allergy Popup message is NOT displayed");
}


//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Dose Form

exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"ComboBoxEdit\", \"\"\, 1).WPFObject(\"ButtonContainer\", \"\"\, 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Dose,exestatus)

//Route
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"ComboBoxEdit\", \"\"\, 1).WPFObject(\"ButtonContainer\", \"\"\, 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Route,exestatus)

//Bodysite

exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\"\, 3).WPFObject(\"ComboBoxEdit\", \"\"\, 1).WPFObject(\"ButtonContainer\", \"\"\, 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Bodysite,exestatus)


//Infused Over
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"LayoutGroup\", \"\",1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"ComboBoxEdit\", \"\"\, 1).WPFObject(\"ButtonContainer\", \"\"\, 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Infused,exestatus)

//Check for Allergies window

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WPFObject(\"TabItem\", \"Allergies/ADR\", 1))",27,9,exestatus);
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WPFObject(\"TabItem\", \"Allergies/ADR\", 1))",27,17,exestatus);

//Enter drug details
  var imdGenericWindow;
  imdGenericWindow = Aliases.iMDSoft_Metavision.HwndSource_ImdGenericWindow.ImdGenericWindow;
  imdGenericWindow.GridCellContentPresenter.Click(313, 20);
  //imdGenericWindow.DVGridMedications.ClickCell(0, "Quantity/Volume");
  //commented - exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 4)",exestatus);

//Enter Medication Quantity
  imdGenericWindow.GridCellContentPresenter.TextEdit.Keys(quantity);

//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",quantity,exestatus);
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"TextEdit\", \"\", 1)", quantity,exestatus);

//Enter Diluent Volume
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Check for Missed Dose dialog

var med = vProcess.Find("Name", "WinFormsObject(\"frmMissedDoseDialog\")", 1000);


if (med.Exists)
{
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmlOk\")",exestatus);         
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);        

    Log.Checkpoint("Missed Dose dialog");
    }
    else
{
Log.Message("Missed Dose dialog is NOT displayed");
}


//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Check for Warning Message

var war = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);

if (war.Exists)
{
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"OK\")",exestatus);
Log.Checkpoint("Warning Message is displayed");
}
else
{
Log.Checkpoint("No Warning Message displayed");
}

//Resolve the Allergies warning

switch(type){
case ("Drug Family"):
Log.Message("No Action required");
break;

case ("Drug subfamily"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
//Log.Message("No Action required");

case ("Ingredient"):
Log.Message("No Action required");
break;

case ("Miscellaneous"):
Log.Message("No Action required");
break;

default:
Log.Message("No Allergies Warning");
}     
//Check for Allergies Warning

//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");
   
var allergywindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergyAlert\")", 1000);

if (allergywindow.Exists)
   {
 
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
    Log.Checkpoint("Allergies warning is displayed");
    }
    else
{
Log.Checkpoint("No warning message is displayed");
}

 return exestatus;
}
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MVRadiology
// Desc :Feature to check the Radiology flow
// Owner :Ragurathan S
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MVRadiology(TestName,exestatus)
{
	// Click on Radiology
exestatus = mvObjects.selectMenuOption(exestatus,"","Radiology");

var radwindow = vProcess.Find("Name", "WPFObject(\"frmMain\" , \"\"\,1)", 1000);

    
  if (radwindow.Exists == true)
  {
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  Log.message("Radiology message is displayed");
  }
    Log.Message("Radiology message is NOT displayed");


 return exestatus;

  }
//******************************************************************************************//
//******************************************************************************************//  

//******************************************************************************************//
//******************************************************************************************//
// Name :MVPolicies
// Desc :Feature to check the policies and guidelines
// Owner :Ragurathan S
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  
  
function MVPolicies(TestName,exestatus)
{
// Click on Policies and Guidelines
exestatus = mvObjects.selectMenuOption(exestatus,"","Policies & Guidelines");

vProcess = Sys.Process("iMDSoft.Metavision");

//Terminate IE Process
	if (Sys.WaitProcess("iexplore").Exists)
  {
  Sys.Process("iexplore").Terminate();
  
  Log.Message("Terminating Internet Explorer");
   }

//NSW Health Policy
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_2\")",exestatus);

aqUtils.Delay(10000);
          
//Close the Newly opened IE Browser
var Browser=Sys.Browser("iexplore");

Browser.BrowserWindow(0).Close();

//Close the Policies and Guidelines
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
//Access Policies from Prescribe Medications
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\" , \"\", 11)",exestatus);

//Click on Antimicrobial Stewardship/Policies and Guidelines

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\" , \"\", 8)",exestatus);
aqUtils.Delay(10000);

//Close the Newly opened IE Browser
var Browser=Sys.Browser("iexplore");

Browser.BrowserWindow(0).Close();
     
    


 return exestatus;
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVWounds
// Desc :Feature to add parameters (Patientype and Sex) and navigate to burns management
// Owner :Ragurathan S
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MVWounds(TestName,exestatus)
{

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

//var objData = Data.getData(TestName,"Medications"); 

 
var value1 = Data.getData(TestName,"Medications","value1");
var value2 = Data.getData(TestName,"Medications","value2");

//Click on Wounds Tab

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,18",exestatus);

//Right click and Choose Add parameter

exestatus = mvObjects.rightclick(vProcess,"FullName", "*WPFObject(\"PicContainer\").WPFObject(\"tChartConcrol\")",110,42,exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"MvMenuControl\").WPFObject(\"ImdMenuItem\", \"Add parameter\", 1)",exestatus); 
//Add Patient type parameter

exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdFind\")",exestatus);

var textbox = vProcess.Find("Name", "WinFormsObject(\"textBox\")", 1000);
textbox.clear();
//var objData = Data.getData(TestName,"Medications"); 
var value1 = Data.getData(TestName,"Medications","value1");
exestatus = mvObjects.enterEditText(vProcess,"WinFormsObject(\"textBox\")",value1,exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdFindNow\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdLocate\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"CmdAdd\")",exestatus);

//Add Sex parameter

exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdFind\")",exestatus);
var textbox = vProcess.Find("Name", "WinFormsObject(\"textBox\")", 1000);
textbox.clear();
//var objData = Data.getData(TestName,"Medications"); 
var value2 = Data.getData(TestName,"Medications","value2");
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"textBox\")",value2,exestatus);

//tick mark - Match whole word only
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"chkWholeWord\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdFindNow\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdLocate\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"CmdAdd\")",exestatus);

//close the window
exestatus  = mvObjects.buttonClick(vProcess,"Name", "WinFormsObject(\"cmdClose\")",exestatus);

//Click on button to show only empty rows
exestatus  = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"MainCanvas\").WPFObject(\"CmdEdit\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"MvMenuControl\").WPFObject(\"ImdMenuItem\", \"Show empty rows\", 3)",exestatus); 

//Choose the value for Sex
//var objData = Data.getData(TestName,"Medications"); 
var sex = Data.getData(TestName,"Medications","sex");
exestatus = mvObjects.ClickCoordinates(vProcess,"FullName", "*WPFObject(\"PicContainer\").WPFObject(\"tChartConcrol\")",1752,25,exestatus);
exestatus = mvObjects.ClickCoordinates(vProcess,"FullName", "*WPFObject(\"PicContainer\").WPFObject(\"tChartConcrol\")",1752,25,exestatus);
exestatus = mvObjects.selectComboListItem(sex,exestatus);

//Choose the value for Patient Type
//var objData = Data.getData(TestName,"Medications"); 
var type = Data.getData(TestName,"Medications","pattype");
exestatus = mvObjects.ClickCoordinates(vProcess,"FullName", "*WPFObject(\"PicContainer\").WPFObject(\"tChartConcrol\")",1754,45,exestatus);
exestatus = mvObjects.ClickCoordinates(vProcess,"FullName", "*WPFObject(\"PicContainer\").WPFObject(\"tChartConcrol\")",1754,45,exestatus);

exestatus = mvObjects.selectComboListItem(type,exestatus);


//Click on Body Chart
set  = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"ImdButton\", \"\"\,1)",exestatus);
aqUtils.Delay(1000);

exestatus = mvObjects.scrollUntilVisible("WPFObject(\"cmdAction_29\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"cmdCancel\")",exestatus); 

return exestatus;
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVeNIMC
// Desc :Feature to add medications and verify it in eNIMC
// Owner :Ragurathan S
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MVeNIMC(TestName,exestatus)
{

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

//Navigate to the eNIMC Option

exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "eNIMC");

//Check for the terms and conditions
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_1\")",exestatus);

//Generate eNIMC
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_1\")",exestatus);


//Click on Save and Close

//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

return exestatus;

}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVMedicationReview
// Desc :Function to Add medication review for a patient
// Owner :Ragurathan S
// Creation date:August 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MVMedicationReview(TestName,exestatus)
{

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

//Navigate to the Medication Review 

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,14",exestatus);

//Click on New Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\"),\"\"\,1",exestatus);

//Enter details in Medication Review


//var objData = Data.getData(TestName,"Medications");
var Comment1 = Data.getData(TestName,"Medications","Comment1");
var Combo1 = Data.getData(TestName,"Medications","Combo1");
var Combo2 = Data.getData(TestName,"Medications","Combo2");
var Comment2 = Data.getData(TestName,"Medications","Comment2");
var Radio1 = Data.getData(TestName,"Medications","Radio1");
var Radio2 = Data.getData(TestName,"Medications","Radio2");
var Comment3 = Data.getData(TestName,"Medications","Comment3");
var Comment4 = Data.getData(TestName,"Medications","Comment4");

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")", Comment1,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")", Combo1,exestatus);
exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")", Combo2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Comment2,exestatus);

//Enter the date and time for issue identified
//var objData = Data.getData(TestName,"Medications");
var issueday = Data.getData(TestName,"Medications","IssueDate");
//day = aqString.substring(issueday, 0, 2);
day =  aqDateTime.GetDay(issueday);
//month = aqString.substring(issueday, 3, 2);
  month =  aqDateTime.GetMonth(issueday);
//year = aqString.substring(issueday, 6, 4);
  year = aqDateTime.GetYear(issueday);
//hr = aqString.substring(issueday, 11, 4);
//min = aqString.substring(issueday, 13, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", day,month,year,"4","45",exestatus);

//Get current date and time for date resolved
var currentDateAndTime = aqDateTime.Now();
drday = aqDateTime.GetDay(currentDateAndTime);
drmonth = aqDateTime.GetMonth(currentDateAndTime);
dryear = aqDateTime.GetYear(currentDateAndTime);
drhr = aqDateTime.GetHours(currentDateAndTime);
drmin = aqDateTime.GetMinutes(currentDateAndTime);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")",drday,drmonth,dryear,drhr,drmin,exestatus);

exestatus = mvObjects.selectradiobutton(vProcess,"WPFObject(\"shpTextRadioBorder_1\")",Radio1,exestatus);

switch(Radio1){
case ("Alternative Plan"):
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_3\")",Comment4,exestatus);
break;

default:
Log.Message("Alternative plan was not selected");
}

exestatus = mvObjects.selectradiobutton(vProcess,"WPFObject(\"shpTextRadioBorder_2\")",Radio2,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_4\")",Comment3,exestatus);

//Add Pharmacy Note
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\,\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_1\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_2\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_3\")",exestatus);
//Click on Save and Close in the pharmacy note page
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
//Click on Save and Close in the first page
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus);
//Click on save
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);


return(exestatus);

}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVResolveMedication
// Desc :Feature to stop a medication review by choosing the current time
// Owner :Ragurathan S
// Creation date:August 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MVResolveMedication(TestName,exestatus){


//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

//Right Click on Medication Review Tab and select Stop option

 
Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.TChartControl.ClickR(44, 22);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"txt\")",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"12\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"txt\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: PopupRoot\", \"\", 1).WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"ImdMenuItem\", \"Stop\", 6)",exestatus);

//Click on OK in Stop Initiation Process
//Enter Current date and time
aqUtils.Delay(10000);
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvtcReportTime\")",13,22,exestatus);
//exestatus = mvObjects.ImdListBoxSelection(vProcess,"WinFormsObject(\"ListBox\"))","Current time",exestatus);
Aliases.iMDSoft_Metavision.WinFormsObject("ImdComboDropDown", "").WinFormsObject("Panel", "").WinFormsObject("ListBox").Click(33, 49);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);

return(exestatus);
}
/////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////

function MvprescribeMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");;
Log.Checkpoint("Start prescribeMedication Home for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity=Data.getData(TestName,"Medications","quantity");
var volume=Data.getData(TestName,"Medications","volume");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",quantity,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully prescribeMedication");
      Log.Checkpoint("End prescribeMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped prescribeMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvBurnsOnAdmission
// Desc :Flow to Burns On Admission
// Owner :Sangiliraja J
// Creation date:Aug,2017
// Update By :Sangiliraja J
// Update date:Dec 11,2017
// Update desc:Updated fields PainScore RASS CAM Airway
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV BurnsOnAdmission
function MvBurnsOnAdmission(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start BurnsOnAdmission for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add BurnsOnAdmission.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns","Burns Admission Management");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** BurnsOnAdmission ***");
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

	
  var DoesPatient = Data.getData(TestName,"MedicalCare","DoesPatient");
	var MechanismofInjury = Data.getData(TestName,"MedicalCare","MechanismofInjury");
  let BurnAdmission = new Object();
  
              BurnAdmission.TimeofBurn = Data.getData(TestName,"MedicalCare","TimeofBurn")
              DTDay = aqString.substring(BurnAdmission.TimeofBurn, 0, 2);
	            DTMonth = aqString.substring(BurnAdmission.TimeofBurn, 3, 2);
	            DTYear= aqString.substring(BurnAdmission.TimeofBurn, 6, 4);
	      var DescriptionofInjury = Data.getData(TestName,"MedicalCare","DescriptionofInjury");
        var TBSADermal = Data.getData(TestName,"MedicalCare","TBSADermal");
        var TBSAFullThickness = Data.getData(TestName,"MedicalCare","TBSAFullThickness");
        var TBSATotal = Data.getData(TestName,"MedicalCare","TBSATotal");
        var Tetanus = Data.getData(TestName,"MedicalCare","Tetanus");
	      var FirstAid = Data.getData(TestName,"MedicalCare","FirstAid");	
	      var Current = Data.getData(TestName,"MedicalCare","Current"); 
        var Component = Data.getData(TestName,"MedicalCare","Component");
        var Evidence = Data.getData(TestName,"MedicalCare","Evidence");
        var ICU = Data.getData(TestName,"MedicalCare","ICU");
        var Opthalmology = Data.getData(TestName,"MedicalCare","Opthalmology");
        var PainScore = Data.getData(TestName,"MedicalCare","PainScore");
        var RASS = Data.getData(TestName,"MedicalCare","RASS");
        var CAM = Data.getData(TestName,"MedicalCare","CAM");
        var Airway = Data.getData(TestName,"MedicalCare","Airway");
        var Isthere = Data.getData(TestName,"MedicalCare","Isthere");
        var AirwayInhalation = Data.getData(TestName,"MedicalCare","AirwayInhalation");
        var Interventions = Data.getData(TestName,"MedicalCare","Interventions");
        var Plan = Data.getData(TestName,"MedicalCare","Plan");
        var Crystalloids = Data.getData(TestName,"MedicalCare","Crystalloids");
        var TotalFluids = Data.getData(TestName,"MedicalCare","TotalFluids");
        var Colloids = Data.getData(TestName,"MedicalCare","Colloids");
        var Bloods = Data.getData(TestName,"MedicalCare","Bloods");
        var Parkland = Data.getData(TestName,"MedicalCare","Parkland");
        var ParklandFormula = Data.getData(TestName,"MedicalCare","ParklandFormula");
        var BalanceFirstEight = Data.getData(TestName,"MedicalCare","BalanceFirstEight");
        var RateFirstEight = Data.getData(TestName,"MedicalCare","RateFirstEight");
        var BalanceNextSixteen = Data.getData(TestName,"MedicalCare","BalanceNextSixteen");
        var RateNextSixteen = Data.getData(TestName,"MedicalCare","RateNextSixteen");
        var TargetMinimum = Data.getData(TestName,"MedicalCare","TargetMinimum");
        var TargetMaximum = Data.getData(TestName,"MedicalCare","TargetMaximum");
        var WeightonAdmission = Data.getData(TestName,"MedicalCare","WeightonAdmission");
        


	       exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",DoesPatient,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",MechanismofInjury,exestatus);
         exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus); 
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",DescriptionofInjury,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",TBSADermal,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",TBSAFullThickness,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Tetanus,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",FirstAid,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_2\")",Current,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Component,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",Evidence,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",ICU,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",Opthalmology,exestatus);
         exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_6\")",exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",PainScore,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",RASS,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",CAM,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",Airway,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_3\")",Isthere,exestatus);
           
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",AirwayInhalation,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Interventions,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Plan,exestatus);
         exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtNumeric_6\")",exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",Crystalloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",Colloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",Bloods,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightonAdmission,exestatus);
        exestatus =  mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",ParklandFormula,exestatus);
         //Calculate Fluid Reuscitation
          exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFormula_15\")",exestatus);         
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_3\")",exestatus);
         var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
               
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
		// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
	
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns","Burns Admission Management");
	// Wait for screen to appear
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",DoesPatient, "DoesPatient",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_1\")","DisplayText",MechanismofInjury, "MechanismofInjury",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")","Value",TimeofBurn, "TimeofBurn",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")","Text",DescriptionofInjury, "DescriptionofInjury",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",TBSADermal, "TBSADermal",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",TBSAFullThickness, "TBSAFullThickness",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_2\")","Text",TBSATotal, "TBSATotal",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")","Text",Tetanus, "Tetanus",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",FirstAid, "FirstAid",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_2\")","DisplayText",Current, "Current",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_2\")","Text",Component, "Component",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_3\")","Text",Evidence, "Evidence",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")","Text",ICU, "ICU",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_4\")","Text",Opthalmology, "Opthalmology",exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_6\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")","Text",PainScore, "PainScore",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",RASS, "RASS",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")","Text",CAM, "CAM",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")","Text",Airway, "Airway",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_3\")","DisplayText",Isthere, "Isthere",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")","Text",AirwayInhalation, "AirwayInhalation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")","Text",Interventions, "Interventions",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")","Text",Plan, "Plan",exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtNumeric_6\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",Crystalloids, "Crystalloids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_3\")","Text",TotalFluids, "TotalFluids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")","Value",Colloids, "Colloids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")","Value",Bloods, "Bloods",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_4\")","Text",Parkland, "Parkland",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")","Text",ParklandFormula, "ParklandFormula",exestatus);
    exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFormula_15\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_6\")","Text",BalanceFirstEight, "BalanceFirstEight",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_8\")","Text",RateFirstEight, "RateFirstEight",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_10\")","Text",BalanceNextSixteen, "BalanceNextSixteen",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_13\")","Text",RateNextSixteen, "RateNextSixteen",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_14\")","Text",TargetMinimum, "TargetMinimum",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_15\")","Text",TargetMaximum, "TargetMaximum",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value",WeightonAdmission, "WeightonAdmission",exestatus);
  
  
	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
    if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" BurnsOnAdmission is successful");
      Log.Checkpoint("BurnsOnAdmission","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped BurnsOnAdmission","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

function MvAutomaticallyMatch(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start AutomaticallyMatch for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//AutomaticallyMatch
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);


//exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",1,1,drug,2,exestatus);
//exestatus = mvObjects.selectToggleItem(vProcess,"*WPFObject(\"MedicationTemplate\").WPFObject(\"ImdToggleList\", \"\"\,1)","Aztreonam X g IV Infusion every X hours [Adult]",exestatus);
//exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully AutomaticallyMatch");
      Log.Checkpoint("End AutomaticallyMatch","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped AutomaticallyMatch","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////
function MvPrescribeMedicationGreater(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeMedicationGreater for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//PrescribeMedicationsGreater
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//WPFObject("TextBlock", "Interferon gamma-1b X microg Subcut Daily on Monday, Wednesday, Friday (08:00) [Adult]", 1)
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)





//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedMedicationsGreater");
      Log.Checkpoint("End PrescribeMedicationsGreater","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeMedicationsGreater","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////
function MvPrescribeIntravenousBolus(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");;
Log.Checkpoint("Start PrescribeIntravenousBolus for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//PrescribeIntravenousBolus
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


 //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedIntravenousBolus");
      Log.Checkpoint("End PrescribeIntravenousBolus","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeIntravenousBolus","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//*************************************************************//
//*************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvWeightsPopulates
// Desc :Feature to check WeightsPopulates
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// Feature created for MV Weights Populates
function MvWeightsPopulates(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start WeightsPopulates for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add WeightsPopulates.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Weights and Dimensions");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Weights and Dimensions data ***");
	var Height = Data.getData(TestName,"MedicalCare","Height");
	var WeightLatest = Data.getData(TestName,"MedicalCare","WeightLatest");
	var WeightAdmission = Data.getData(TestName,"MedicalCare","WeightAdmission");
	var WeightDrug = Data.getData(TestName,"MedicalCare","WeightDrug");
	var WeightIdeal = Data.getData(TestName,"MedicalCare","WeightIdeal");
  var WeightAdjusted = Data.getData(TestName,"MedicalCare","WeightAdjusted");
  var bmi = Data.getData(TestName,"MedicalCare","bmi");
  var bsa = Data.getData(TestName,"MedicalCare","bsa");
		
	 
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Height,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",WeightLatest,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",WeightAdmission,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightDrug,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  
	Log.Checkpoint("Weights and Dimensions Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing","Weights and Dimensions");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  //exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
  //exestatus = mvObjects.waitForObject(vprocess,"WPFObject(\"sessionscontrol\")",120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",Height, "Height",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value",WeightLatest, "WeightLatest",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",WeightAdmission, "WeightAdmission",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value",WeightDrug, "WeightDrug",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")", "BindableValue",WeightIdeal, "WeightIdeal",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")", "BindableValue",WeightAdjusted, "WeightAdjusted",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",bmi, "bmi",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",bsa, "bsa",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
  
// Click on Prescribe medication tab (so can get Dosingweight details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 11)",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "text", "Prescribe",exestatus);
  
  //select a medicine so that the dosing weight is displayed for verification
  var drug = Data.getData(TestName,"Medications","drug");
  var template=Data.getData(TestName,"Medications","template");
  //Enter details in Order form
  exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
  exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"TextBlock\", \"80\", 2)", "Text","80", "dosingweight",exestatus);
  
	// close the form 
  
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Cancel\", 1)",exestatus);
  //click Yes to close the medication form
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*WinFormsObject(\"ImdFormBase\").WinFormsObject(\"Buttons\").WinFormsObject(\"Yes\")",exestatus);
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" WeightsPopulates flow is successful ");
      Log.Checkpoint("End WeightsPopulates","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped WeightsPopulates","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvMedicationAdministrationRecord
// Desc :Feature to MedicationAdministrationRecord
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV MedicationAdministrationRecord
function MvMedicationAdministrationRecord(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start MedicationAdministrationRecord for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To  view MedicationAdministrationRecord.";
      aqUtils.Delay (ms, HelpStr);
  
	
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 12)",exestatus);
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
       exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);


	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** review the Timerange data ***");
	
   
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnPageLeft\")",exestatus);

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" MedicationAdministrationRecord is successful");
      Log.Checkpoint("End MedicationAdministrationRecord","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MedicationAdministrationRecord","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

function MvEnterFreeTextMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");;
Log.Checkpoint("Start EnterFreeTextMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var Dose = Data.getData(TestName,"Medications","Dose");
var Route = Data.getData(TestName,"Medications","Route");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var FreeText = Data.getData(TestName,"Medications","FreeText");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//Prescribe EnterFreeTextMedication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Row1_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderableView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Order_Details_Group\").WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1)","ComboBoxEdit",DoseForm,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Row1_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderableView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Order_Details_Group\").WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1)","ComboBoxEdit",Route,exestatus);

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Dose Form
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Dose,exestatus)

//Route
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Route,exestatus)


//Enter Diluent Volume
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);

//Freetext
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"CaptionView\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Information\").WPFObject(\"Grid\", \"\", 2).WPFObject(\"WrapPanel\", \"\", 3).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",FreeText,exestatus);

//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"TextEdit\", \"\", 1)",FreeText,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Sign-now
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Sign-now in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully EnterFreeTextMedication");
      Log.Checkpoint("End EnterFreeTextMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped EnterFreeTextMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////
//MvAutomaticallyCalculateDose
    
function MvAutomaticallyCalculateDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start AutomaticallyCalculateDose for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");






//AutomaticallyCalculateDose
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter drug details
//exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);

//Dose rate
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"DoseRange\")",DoseRate,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully AutomaticallyCalculateDose");
      Log.Checkpoint("End AutomaticallyCalculateDose","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped AutomaticallyCalculateDose","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////
function MvprescribeIntravenous(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start prescribeIntravenous for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);




//Prescribe Intravenous Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribeIntravenous");
      Log.Checkpoint("End PrescribeIntravenous","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeIntravenous","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////
function MvprescribeIntramuscular(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start prescribeIntramuscular for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"Medications"); 

 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
//var quantity = objData("quantity");
//var volume = objData("volume");
//var objData = Data.getData(TestName,"Navigation");

var Password = Data.getData(TestName,"Navigation","Password");


//Prescribe Intramuscular Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("Main_Group").WPFObject("ScrollViewer", "", 1).WPFObject("Grid", "", 1).WPFObject("Row1_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrderableView", "", 1).WPFObject("Grid", "", 1).WPFObject("Order_Details_Group").WPFObject("Order_Form_Group").WPFObject("HomeMedication").WPFObject("ToggleButton", "", 1).WPFObject("Image", "", 1).click();

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Sign-now
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Sign-now in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribeIntramuscular");
      Log.Checkpoint("End PrescribeIntramuscular","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeIntramuscular","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewFluidBalance
// Desc :Feature to Review Fluid Balance
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvReviewFluidBalance(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start ReviewFluidBalance for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

     // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
     if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully ReviewFluidBalance");
      Log.Checkpoint("End ReviewFluidBalance","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewFluidBalance","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOrderMultipleMedications
// Desc :Feature to Order Multiple Medications
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvOrderMultipleMedications(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start OrderMultipleMedications for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


var drug = Data.getData(TestName,"Medications","drug");
var additives_drug = Data.getData(TestName,"Medications","additives_drug");
var drug_quantity = Data.getData(TestName,"Medications","drug_quantity");
var additives_quantity = Data.getData(TestName,"Medications","additives_quantity");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var Dose=Data.getData(TestName,"Medications","Dose");
var Route=Data.getData(TestName,"Medications","Route");
var FreeText=Data.getData(TestName,"Medications","FreeText");
var Password = Data.getData(TestName,"Navigation","Password");

//OrderMultipleMedications
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Dose Form
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Dose,exestatus)

//Route
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Order_Form_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", Route,exestatus)

//Quantity/Volume
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 1)",exestatus);
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"CustomTextEdit\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"FindComboBoxEdit\")",5,2,additives_drug,2,exestatus);

exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",additives_quantity,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"CaptionView\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Information\").WPFObject(\"Grid\", \"\", 2).WPFObject(\"WrapPanel\", \"\", 3).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",FreeText,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully OrderMultipleMedications");
      Log.Checkpoint("End OrderMultipleMedications","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped OrderMultipleMedications","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewBurnDepthDescription
// Desc :Flow to ReviewBurnDepthDescription
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvReviewBurnDepthDescription(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Review Burn Depth Description documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns", "Burns Admission Management");
// Wait for screen to appear
//Rule of nine
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_1\")",exestatus); 
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_1\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

     
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully ReviewedBurnDepthDescription");
      Log.Checkpoint("End BurnDepthDescription","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewedBurnDepthDescription initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvWeightsandDimensions
// Desc :Flow to check Weights and Dimensions
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


// Feature created for MV Weights and Dimensions
function MvWeightsandDimensions(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Weights and Dimensions for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Weights and Dimensions.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Weights and Dimensions");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Weights and Dimensions data ***");
	var Height = Data.getData(TestName,"MedicalCare","Height");
	var WeightLatest = Data.getData(TestName,"MedicalCare","WeightLatest");
	var WeightAdmission = Data.getData(TestName,"MedicalCare","WeightAdmission");
	var WeightDrug = Data.getData(TestName,"MedicalCare","WeightDrug");
	var WeightIdeal = Data.getData(TestName,"MedicalCare","WeightIdeal");
  var WeightAdjusted = Data.getData(TestName,"MedicalCare","WeightAdjusted");
  var bmi = Data.getData(TestName,"MedicalCare","bmi");
  var bsa = Data.getData(TestName,"MedicalCare","bsa");
		
	 
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Height,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",WeightLatest,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",WeightAdmission,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightDrug,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  
	Log.Checkpoint("Weights and Dimensions Saved Time: "+ timeSavedValue);
	
		// save the form data
	  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing","Weights and Dimensions");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  //Commented as not required it can be deleted once 6.11 is stable 
  //exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",Height, "Height",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value",WeightLatest, "WeightLatest",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",WeightAdmission, "WeightAdmission",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value",WeightDrug, "WeightDrug",exestatus);
  //Commented as not required it can be deleted once 6.11 is stable
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")", "BindableValue",WeightIdeal, "WeightIdeal",exestatus);
  //Commented as not required it can be deleted once 6.11 is stable
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")", "BindableValue",WeightAdjusted, "WeightAdjusted",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",bmi, "bmi",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",bsa, "bsa",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
    
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Weights and Dimensions is successful");
      Log.Checkpoint("End Weights and Dimensions","The flow is completed");
       
    }
  }
  else {
  Log.Message("Skipped Weights and Dimensions","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
    
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewPatientBGL
// Desc :Flow to Review Patient BGL
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV ReviewPatientBGL
function MvReviewPatientBGL(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc =  Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start ReviewPatientBGL for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To  view ReviewPatientBGL.";
      aqUtils.Delay (ms, HelpStr);
  
// To enter the Patient Blood Glucose level on the ClinicalOverview tab
	
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);


// To Review the Patient Blood Glucose level on the GraphOverview tab.Metabolic tab not visible

       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 2)",exestatus);
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);

	  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" ReviewPatientBGL is successful");
      Log.Checkpoint("End ReviewPatientBGL","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewPatientBGL","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewPatientSepsis
// Desc :Flow to Review Patient Sepsis
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvReviewPatientSepsis(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start ReviewPatientSepsis for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");


var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var Password = Data.getData(TestName,"Navigation","Password");


//ReviewPatientSepsis
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
//ReviewPatientSepsis
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,19",exestatus);  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully ReviewPatientSepsis");
      Log.Checkpoint("End ReviewPatientSepsis","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewPatientSepsis","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewPatientWounds
// Desc :Flow to ReviewPatientWounds
// Owner :Sangiliraja J
// Creation date:Aug 2017
// Update By :Sangiliraja J
// Update date:Dec 19,2017
// Update desc:Included to check the message by Save without details
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV ReviewPatientWounds
function MvReviewPatientWounds(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start ReviewPatientWounds for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
    var HelpStr = "Delaying test run for " + ms + " milliseconds, To add ReviewPatientWounds.";
    aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 18)",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ImdButton\", \"\"\, 2)",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_2\")",exestatus);

	// Wait for screen to appear
	
		// ** Fill in the Patient details
	      Log.Message("*** ReviewPatientWounds ***");
        //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
        exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdApply\")",exestatus);
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
  aqUtils.Delay(6000);
  var MandForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
  if (MandForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
	
        var Site = Data.getData(TestName,"MedicalCare","Site");
        var Status = Data.getData(TestName,"MedicalCare","Status");
        var SiteDescription = Data.getData(TestName,"MedicalCare","SiteDescription");
        var Debridement = Data.getData(TestName,"MedicalCare","Debridement");
        var CleansingSolution = Data.getData(TestName,"MedicalCare","CleansingSolution");
        var Ointment = Data.getData(TestName,"MedicalCare","Ointment");
        var Depth = Data.getData(TestName,"MedicalCare","Depth");
        var SecondaryDressing = Data.getData(TestName,"MedicalCare","SecondaryDressing");
        var PrimaryDressing = Data.getData(TestName,"MedicalCare","PrimaryDressing");
        var Fixation = Data.getData(TestName,"MedicalCare","Fixation");
        var Compression = Data.getData(TestName,"MedicalCare","Compression");
        var Exudate = Data.getData(TestName,"MedicalCare","Exudate");
        var Dressing = Data.getData(TestName,"MedicalCare","Dressing");
        var Grafts = Data.getData(TestName,"MedicalCare","Grafts");
        var DonorSite = Data.getData(TestName,"MedicalCare","DonorSite");
        var SkinSubstitutes = Data.getData(TestName,"MedicalCare","SkinSubstitutes");
        var TreatmentPlan = Data.getData(TestName,"MedicalCare","TreatmentPlan");
        var ProceduralPain = Data.getData(TestName,"MedicalCare","ProceduralPain");
        var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
        
        var Analgesic = Data.getData(TestName,"NursingCare","Analgesic");
        var Signs = Data.getData(TestName,"NursingCare","Signs");
        var Dressing = Data.getData(TestName,"NursingCare","Dressing");
        var Reviewed = Data.getData(TestName,"NursingCare","Reviewed");
        var Splints = Data.getData(TestName,"NursingCare","Splints");
        var Name = Data.getData(TestName,"NursingCare","Name");
        var Staff = Data.getData(TestName,"NursingCare","Staff");
        var Next = Data.getData(TestName,"NursingCare","Next");
        var Time = Data.getData(TestName,"NursingCare","Time");
        
        let DressingDetails = new Object();
        DressingDetails.Next = Data.getData(TestName,"NursingCare","Next");
        
       
        exestatus = mvObjects.selectCheckComboItem(vProcess,"WPFObject(\"cboTextComboMulti_1\")",Site,exestatus);
        //exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")","ImdComboBoxItem",Site,exestatus, 1);           
        exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBoxItem",Status,exestatus);           
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",SiteDescription,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Debridement,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_2\")",CleansingSolution,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_3\")",Ointment,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_4\")",Depth,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_5\")",SecondaryDressing,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_6\")",PrimaryDressing,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_7\")",Fixation,exestatus);
        exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_8\")",Compression,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Exudate,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Dressing,exestatus);
        exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_7\")",exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_2\")",Grafts,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",DonorSite,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",SkinSubstitutes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",TreatmentPlan,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",ProceduralPain,exestatus);
        exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_2\").WPFObject(\"txtNumeric_2\")",exestatus);
                   
        
        exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_3\").WPFObject(\"cboTextCombo_3\")","ImdComboBoxItem",Analgesic,exestatus, 1);
        exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_10\").WPFObject(\"cboTextComboMulti_10\")","ImdCheckedComboBox",Signs,exestatus, 1);
        exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_4\").WPFObject(\"cboTextCombo_4\")","ImdComboBoxItem",Dressing,exestatus, 1);
        exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_11\").WPFObject(\"cboTextComboMulti_11\")","ImdCheckedComboBox",Reviewed,exestatus, 1);
        exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_9\").WPFObject(\"txtFreeText_9\")",Splints,exestatus);
        exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_10\").WPFObject(\"txtFreeText_10\")",Name,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Staff,exestatus);
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TextBlock\", \"Dressing Details\", 1)",exestatus);
        NextDay = aqDateTime.GetDay(DressingDetails.Next);
	      Nextmonth = aqDateTime.GetMonth(DressingDetails.Next);
	      Nextyear = aqDateTime.GetYear(DressingDetails.Next);
        exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_4\")", NextDay, Nextmonth, Nextyear, "04", "17",exestatus);
	
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Time,exestatus);
        
        //Saving and closing the Dressing details in New session
        exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus);
   
       //To proceed with windowspopup   
       var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
       if (MsgForm.Exists)
       {
       exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
      }
     //Saving and closing Burn Area
     exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus);
      if (equal(exestatus,true)) 
      {
	 	  Log.Checkpoint(" ReviewPatientWounds is successful");
      Log.Checkpoint("ReviewPatientWounds","The flow is completed");
   }
  }
  else {
  Log.Message("Skipped ReviewPatientWounds","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
 }
  return exestatus;
  }
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPericardialDrain
// Desc :Feature to validate the PericardialDrain
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:24-Nov-17
// Update desc:Updated the function for list check box selection
//******************************************************************************************//
//******************************************************************************************//

function MvPericardialDrain(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Pericardial drain documentation for "+tcDesc ,"The flow is started");
	
  //Start of the feature 

	 vProcess = Sys.Process("iMDSoft.Metavision");

	 
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Drains","Thoracic","Pericardial Drain #1");
	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Buttom_Group\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);
  
    
    
// ** Fill in the details for pericardial drain **
Log.Message("*** enter details for pericardial drain ***");
	
var Size = Data.getData(TestName,"MedicalCare","Size");
var DrainageVolume  = Data.getData(TestName,"MedicalCare","DrainageVolume");
var DrainSutured = Data.getData(TestName,"MedicalCare","DrainSutured");
var TotalVolumeInDrain = Data.getData(TestName,"MedicalCare","TotalVolumeInDrain");
var DrinageDescription = Data.getData(TestName,"MedicalCare","DrinageDescription"); 
  
  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",10,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",20,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",40,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",DrinageDescription,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",DrainSutured,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 4)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 6)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

  
     // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
  
   // Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
   exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdSave\")", 120,exestatus);
    
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
   // var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" successfully initiated Pericardial Drain");
      Log.Checkpoint("End Pericardial Drain","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Pericardial Drain initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvNasoduodenalTube
// Desc :Feature to validate the Nasoduodenal Tube
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 
function MvNasoduodenalTube(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Nasoduodenal tube documentation for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	  
  
   // Slection of menu value 
 	 exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Tubes","Gastrointestinal","Nasoduodenal Tube");
	// Wait for screen to appear
   exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
   exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblNumeric_1\")", 120,exestatus);
    
    
// ** Fill in the details for Nasoduodenal Tube **
Log.Message("*** enter details for Nasoduodenal Tube ***");
	
var Size = Data.getData(TestName,"MedicalCare","Size");
var PositionAtNare  = Data.getData(TestName,"MedicalCare","PositionAtNare");
 
  

exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_1\")",Size,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_2\")",PositionAtNare,exestatus);



  
  // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Nasoduodenal Tube: "+ timeSavedValue);
  
   // Save and close the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
   exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdSave\")", 120,exestatus);
   
   // selection input/output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Nasoduodenal Tube");
      Log.Checkpoint("End of Nasoduodenal Tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Nasoduodenal Tube documentation ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvRenalReplacementTherapies
// Desc :Feature to validate the Renal Replacement Therapies
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:24-Nov-17
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRenalReplacementTherapies(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start CRRT form documentation for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 

	 vProcess = Sys.Process("iMDSoft.Metavision");

  
    
 // Select the RRT tab   
  exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
 	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
 
	
  // Wait for screen to appear and selection of button
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"ImdButton\", \"\", 1)", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\", \"\", 1)",exestatus);
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  
    
    
// ** Fill in the details for CRRT Orders **
Log.Message("*** enter details for CRRT Orders ***");
	
var RRT_Other = Data.getData(TestName,"MedicalCare","RRT_Other");
var CRRT_BloodFlow  = Data.getData(TestName,"MedicalCare","CRRT_BloodFlow");
var CRRT_Filter = Data.getData(TestName,"MedicalCare","CRRT_Filter");
var CRRT_Dialysate = Data.getData(TestName,"MedicalCare","CRRT_Dialysate");
var CRRT_OtherDialysate = Data.getData(TestName,"MedicalCare","CRRT_OtherDialysate");
var CRRT_Dial_Additive = Data.getData(TestName,"MedicalCare","CRRT_Dial_Additive");
var CRRT_Dial_Add_DD = Data.getData(TestName,"MedicalCare","CRRT_Dial_Add_DD");
var CRRT_Dial_Final = Data.getData(TestName,"MedicalCare","CRRT_Dial_Final");
var CRRT_Dial_FluidRate = Data.getData(TestName,"MedicalCare","CRRT_Dial_FluidRate");
var CRRT_PBP = Data.getData(TestName,"MedicalCare","CRRT_PBP");
var CRRT_PBP_OtherPBP = Data.getData(TestName,"MedicalCare","CRRT_PBP_OtherPBP");
var CRRT_PBP_Additive = Data.getData(TestName,"MedicalCare","CRRT_PBP_Additive");
var CRRT_PBP_Add_DD = Data.getData(TestName,"MedicalCare","CRRT_PBP_Add_DD");
var CRRT_PBP_Final = Data.getData(TestName,"MedicalCare","CRRT_PBP_Final");
//var CRRT_PBP_Pre-Filter = objData ("CRRT_PBP_Pre-Filter").Value
var CRRT_FluidRemoval_ML = Data.getData(TestName,"MedicalCare","CRRT_FluidRemoval_ML");
var CRRT_FluidRemovalDD = Data.getData(TestName,"MedicalCare","CRRT_FluidRemovalDD");
var CRRT_FluidRemoval_BalanceIncl = Data.getData(TestName,"MedicalCare","CRRT_FluidRemoval_BalanceIncl");
var CRRT_PostBalanceFluid = Data.getData(TestName,"MedicalCare","CRRT_PostBalanceFluid");
var CRRT_PostBalanceFluidOther = Data.getData(TestName,"MedicalCare","CRRT_PostBalanceFluidOther");
var CRRT_PostBalance_Add = Data.getData(TestName,"MedicalCare","CRRT_PostBalance_Add");
var CRRT_PostBalance_Add_DD = Data.getData(TestName,"MedicalCare","CRRT_PostBalance_Add_DD");
var CRRT_PostBalance_FinalPotta = Data.getData(TestName,"MedicalCare","CRRT_PostBalance_FinalPotta");
var CRRT_PostBalance_FilterRate = Data.getData(TestName,"MedicalCare","CRRT_PostBalance_FilterRate");
var CRRT_Comments = Data.getData(TestName,"MedicalCare","CRRT_Comments");
var CRRT_Mode = Data.getData(TestName,"MedicalCare","CRRT_Mode");
var CRRT_Dose = Data.getData(TestName,"MedicalCare","CRRT_Dose");
var CRRT_DoseWeight = Data.getData(TestName,"MedicalCare","CRRT_DoseWeight");
var CRRT_DoseRate = Data.getData(TestName,"MedicalCare","CRRT_DoseRate");

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",CRRT_Mode,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_2\")",CRRT_DoseWeight,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Acid-base",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Fluid balance",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Hyperkalaemia",exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_1\")",RRT_Other,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_6\")",CRRT_BloodFlow,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_2\")",CRRT_Filter,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",CRRT_Dialysate,exestatus);
  //Handle Pop-up for low Dialysate fluid
  //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
   if (MsgForm.Exists)
   {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
   }  
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_3\")",CRRT_OtherDialysate,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_7\")",CRRT_Dial_Additive,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",CRRT_Dial_Add_DD,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_8\")",CRRT_Dial_Final,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",CRRT_PBP,exestatus);
  //Handle Pop-up for low Dialysate fluid
  //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
   if (MsgForm.Exists)
   {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
   }
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_4\")",CRRT_PBP_OtherPBP,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_10\")",CRRT_PBP_Additive,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",CRRT_PBP_Add_DD,exestatus);
  //Handle Pop-up for low Dialysate fluid
  //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
   if (MsgForm.Exists)
   {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
   }
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_11\")",CRRT_PBP_Final,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_5\")",CRRT_FluidRemoval_ML,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",CRRT_FluidRemovalDD,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_6\")",CRRT_FluidRemoval_BalanceIncl,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",CRRT_PostBalanceFluid,exestatus);
  //Handle Pop-up for low Dialysate fluid
  //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
   if (MsgForm.Exists)
   {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
   }
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_7\")",CRRT_PostBalanceFluidOther,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_13\")",CRRT_PostBalance_Add,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",CRRT_PostBalance_Add_DD,exestatus);
  //Handle Pop-up for low Dialysate fluid
  //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
   if (MsgForm.Exists)
   {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
   }
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtNumeric_14\")",CRRT_PostBalance_FinalPotta,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_8\")",CRRT_Comments,exestatus);
 
  
  // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
  
  
  
   // Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
   
   //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
   
   // Save and close the form data
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ucFormBuilder_FBForm\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
   
 //Validation part open form again
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"ImdButton\", \"\", 1)", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\", \"\", 1)",exestatus);
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }   
   //Validation of documented values
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",CRRT_Mode,"CRRT_Mode",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")", "Value",CRRT_Dose,"CRRT_Dose",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")", "Value",CRRT_DoseWeight,"CRRT_DoseWeight",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")", "Value",CRRT_DoseRate,"CRRT_DoseRate",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",RRT_Other,"RRT_Other",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",CRRT_Filter,"CRRT_Filter",exestatus);
   
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",CRRT_OtherDialysate,"CRRT_OtherDialysate",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",CRRT_Dial_Add_DD,"CRRT_Dial_Add_DD",exestatus);    
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_9\")", "Value",CRRT_Dial_FluidRate,"CRRT_Dial_FluidRate",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",CRRT_PBP,"CRRT_PBP",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",CRRT_PBP_OtherPBP,"CRRT_PBP_OtherPBP",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",CRRT_PBP_Add_DD,"CRRT_PBP_Add_DD",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",CRRT_FluidRemoval_ML,"CRRT_FluidRemoval_ML",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",CRRT_FluidRemovalDD,"CRRT_FluidRemovalDD",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",CRRT_FluidRemoval_BalanceIncl,"CRRT_FluidRemoval_BalanceIncl",exestatus);    
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",CRRT_PostBalanceFluid,"CRRT_PostBalanceFluid",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",CRRT_PostBalanceFluidOther,"CRRT_PostBalanceFluidOther",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",CRRT_PostBalance_Add_DD,"CRRT_PostBalance_Add_DD",exestatus);
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_14\")", "Value",CRRT_PostBalance_FinalPotta,"CRRT_PostBalance_FinalPotta",exestatus); 
   exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",CRRT_Comments,"CRRT_Comments",exestatus);
   
   // close the form data
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
      
      
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented CRRT form");
      Log.Checkpoint("End of CRRT form","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped CRRT documentation ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOtherDrain
// Desc :Feature to validate the Other Drain
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:24-Nov-17
// Update desc:Updated function name for list checkbox selection
//******************************************************************************************//
//******************************************************************************************// 

function MvOtherDrain(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Other Drain documentation for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");


  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Drains","Other Drains","Drain #1");
	// Wait for screen to appear
  aqUtils.Delay(1000);
  
exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)","IsEnabled",true, 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);
  
    
    
// ** Fill in the details for other drain **
Log.Message("*** enter details for pericardial drain ***");
	

var Other_DrainageVolume  = Data.getData(TestName,"MedicalCare","Other_DrainageVolume");
var Other_TotalVolumeInDrain = Data.getData(TestName,"MedicalCare","Other_TotalVolumeInDrain");
var Other_Vacuumed = Data.getData(TestName,"MedicalCare","Other_Vacuumed"); 
var Other_DrainageDes = Data.getData(TestName,"MedicalCare","Other_DrainageDes");  
  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",Other_DrainageVolume,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Other_TotalVolumeInDrain ,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Other_Vacuumed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Other_DrainageDes,exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lstTextList_1\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);




  
     // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Other Drain Saved Time: "+ timeSavedValue);
  
   // Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
   exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdSave\")", 120,exestatus);
    
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" successfully initiated other Drain");
      Log.Checkpoint("End of other Drain","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Other Drain initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvAdmissionSummary
// Desc :Feature to fill and validate the Admission Summary form
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:05-Dec-17
// Update desc: Updated object property  for the changed objects and handled the new pop up.

//******************************************************************************************//
//******************************************************************************************// 

function MvAdmissionSummary(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start admission summary documentation for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	 
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);  
        
// ** Fill in the details for Admission Summary **
Log.Message("*** enter details for Admission Summary ***");
	

var PatientType  = Data.getData(TestName,"MedicalCare","PatientType");
var ReasonForAdmission = Data.getData(TestName,"MedicalCare","ReasonForAdmission");
var PastMedicalHis = Data.getData(TestName,"MedicalCare","PastMedicalHis"); 
var SocialandFamily = Data.getData(TestName,"MedicalCare","SocialandFamily");
var SmokingStatus = Data.getData(TestName,"MedicalCare","SmokingStatus"); 
var FindingsOnExami = Data.getData(TestName,"MedicalCare","FindingsOnExami");
var AdmissionPlan = Data.getData(TestName,"MedicalCare","AdmissionPlan");
var Alerts = Data.getData(TestName,"MedicalCare","Alerts");
var AlertseMR = Data.getData(TestName,"MedicalCare","AlertseMR");

//ANZICS Tab data entry starts
var HospAdmiSour = Data.getData(TestName,"MedicalCare","HospAdmiSour");
var ModOfTrans = Data.getData(TestName,"MedicalCare","ModOfTrans");
var HospiTransFrm = Data.getData(TestName,"MedicalCare","HospiTransFrm");
var MedicalEscort = Data.getData(TestName,"MedicalCare","MedicalEscort");
var UnitAdmiSourc = Data.getData(TestName,"MedicalCare","UnitAdmiSourc");
var CareType = Data.getData(TestName,"MedicalCare","CareType");
var ElectAdmis = Data.getData(TestName,"MedicalCare","ElectAdmis");
var EmergResAdmis = Data.getData(TestName,"MedicalCare","ElectAdmis");
var TreatGoalAdmi = Data.getData(TestName,"MedicalCare","TreatGoalAdmi");
var PregnanStatus = Data.getData(TestName,"MedicalCare","PregnanStatus");
var RespArstPreadmi = Data.getData(TestName,"MedicalCare","RespArstPreadmi");
var CardArstPreadmi = Data.getData(TestName,"MedicalCare","CardArstPreadmi");
var ThrombPropy = Data.getData(TestName,"MedicalCare","ThrombPropy");
var Diabetes = Data.getData(TestName,"MedicalCare","Diabetes");
var HospitalAdmDate = Data.getData(TestName,"MedicalCare","HospitalAdmDate");
day = aqDateTime.GetDay(HospitalAdmDate);
month = aqDateTime.GetMonth(HospitalAdmDate);
year = aqDateTime.GetYear(HospitalAdmDate);
hr = aqDateTime.GetHours(HospitalAdmDate);
min = aqDateTime.GetMinutes(HospitalAdmDate);




exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",PatientType,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ReasonForAdmission,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 2))",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_2\")", 120,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",PastMedicalHis,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",SocialandFamily,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",SmokingStatus,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 3))",exestatus);
//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_4\")", 120,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",FindingsOnExami,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",AdmissionPlan,exestatus);

//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_2\")",exestatus);

exestatus = mvObjects.selectCheckComboItem(vProcess,"WPFObject(\"cboTextComboMulti_1\")",Alerts,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"WPFControlText",Alerts,exestatus);

//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_1\")",exestatus);
exestatus = mvObjects.selectCheckComboItem(vProcess,"WPFObject(\"cboTextComboMulti_2\")",AlertseMR,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"WPFControlText",AlertseMR,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);

//Date of Hospital Admission
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", day,month,year,hr,min,exestatus);

//ICU Admission date - It comes prepopulated from the patient file. so no need to enter data here.

//Elective admission
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",ElectAdmis,exestatus);

//Treatment Goals for admission
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",TreatGoalAdmi,exestatus);

//Cardiac arrest in previous 24 hours
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",CardArstPreadmi,exestatus);

//Respiratory arrest pre-admission
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",RespArstPreadmi,exestatus);

//Source of admission to hospital
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_7\")", 120,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",HospAdmiSour,exestatus);

//Mode of transfer to hospital
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",ModOfTrans,exestatus);

//ICU admission source
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",UnitAdmiSourc,exestatus);

//Admission due to emergency response
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")","No",exestatus);

if (aqString.Compare(TestName, "OR_AdmssnDueToRRT", false) == 0) 
{
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")","MET/RRT/CERS/Code blue call",exestatus);
}

//Type of care on admission
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",CareType,exestatus);

//Thromboembolism Prophylaxis
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",ThrombPropy,exestatus);

//Form changed to non mandatory to commenting it 
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",HospiTransFrm,exestatus);

//Removed medical escort - hence commenting it
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",MedicalEscort,exestatus);

//Pregnancy status
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_24\")",PregnanStatus,exestatus);

//Diabetes
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_28\")",Diabetes,exestatus);

// Chronic conditions Apache II
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 4)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);


// Chronic conditions Apache III
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_8\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);




     // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Admission Summary Saved Time: "+ timeSavedValue);
  
   // Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"cmdApply\")",exestatus);
   
   //To proceed with windowspopup 
   var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }  
   
  // Handling the allergies system error pop up
   aqUtils.Delay(10000);
   var MsgForm = vProcess.Find("Name", "Window(\"#32770\",\"Error\", 1)", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\",1)",exestatus);
    }  
   
         
  

    
   //Get the form saved time and date
   aqUtils.Delay(10000);
  //exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"sessionscontrol\")", 120,exestatus); 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  
   // To handle allergy pop  













   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 1))",exestatus);
   var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
     if (AllergyButton.VisibleOnScreen)
     {
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }


    // close the form 

	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
// Handling the allergies system error pop up
   aqUtils.Delay(10000);
   var MsgForm = vProcess.Find("Name", "Window(\"#32770\",\"Error\", 1)", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\",1)",exestatus);
    } 

  
  
	//Validation part open form again
  Log.Message(exestatus);
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  //Validation of documented values 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",PatientType,"PatientType",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ReasonForAdmission,"ReasonForAdmission",exestatus); 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 2))",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",PastMedicalHis,"PastMedicalHis",exestatus); 
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",SocialandFamily,"SocialandFamily",exestatus); 
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",SmokingStatus,"SmokingStatus",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 3))",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",FindingsOnExami,"FindingsOnExami",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",AdmissionPlan,"AdmissionPlan",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",HospAdmiSour,"HospAdmiSour",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",ModOfTrans,"ModOfTrans",exestatus);
  //exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",HospiTransFrm,"HospiTransFrm",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")", "Text",UnitAdmiSourc,"UnitAdmiSourc",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",CareType,"CareType",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",ElectAdmis,"ElectAdmis",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",TreatGoalAdmi,"TreatGoalAdmi",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_24\")", "Text",PregnanStatus,"PregnanStatus",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",CardArstPreadmi,"CardArstPreadmi",exestatus);
  exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_12\")", "Text",ThrombPropy,"ThrombPropy",exestatus); 
  
  
 // To handle allergy pop  
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 1))",exestatus);
   var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
   if (AllergyButton.VisibleOnScreen)
     {
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }
   
   // close the form   
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
   // Handling the allergies system error pop up
   aqUtils.Delay(10000);
   var MsgForm = vProcess.Find("Name", "Window(\"#32770\",\"Error\", 1)", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\",1)",exestatus);
    } 
   

    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented admission summary");
      Log.Checkpoint("End of admission summary","The flow is completed");
    }
  }
  
  else {
  Log.Message("Skipped admission summary documentation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    

}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDefaultCurrentTime
// Desc :Feature to validate Default Current Time of mecation order
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDefaultCurrentTime(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Default Current Time when ordering for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	

    //** Fill in the details for prescribe medication tab**

Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var volume = Data.getData(TestName,"MedicalCare","volume");
var Password = Data.getData(TestName,"Navigation","Password");
 
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",quantity,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
//  

//    
//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated default current time");
      Log.Checkpoint("End of current date and time when ordering","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped default current time ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


 
//******************************************************************************************//
//******************************************************************************************//
// Name :MvCeaseMedications
// Desc :Feature to validate Cease Medications
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:08-Dec-17
// Update desc: Updated the frequency to set interval instead of once only
//******************************************************************************************//
//******************************************************************************************//

function MvCeaseMedications(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Medications");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start Cease Medications for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
 

    //** Fill in the details for prescribe medication tab**
    
 Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity = Data.getData(TestName,"Medications","quantity");
var SetInterval = Data.getData(TestName,"Medications","SetInterval");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   



//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



///Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

 
  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
 

//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
      Log.Checkpoint(" Successfully validated Cease Medications");
      Log.Checkpoint("End of Cease Medications ordering","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Cease Medications ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvOrderMedicationsNutrition
// Desc :Feature to prescribe and validate the Medications, Nutrition for a patient
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  

function MvOrderMedicationsNutrition(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of ordering medications "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");


    //** Fill in the details for prescribe medication tab**
   
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var volume = Data.getData(TestName,"MedicalCare","volume");
var DoseRate = Data.getData(TestName,"MedicalCare","DoseRate");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for Prescribe medication");

//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",quantity,exestatus);

//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Click on Prescribe Fresh Blood Products and Albumin button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",3)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"ImdButton\", \"\",1)",exestatus);


//Entering values in orderable window 
//exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"FindComboBoxEdit\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"DoseRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"Button\", \"\", 3)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

 
  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
 

//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Successfully ordered medication and nutrition");
      Log.Checkpoint("End of ordering medication and nutrition ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ordering medication and nutrition ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//



//******************************************************************************************//
//******************************************************************************************//
// Name :MvDiscontinueMedication
// Desc :Feature to validate Discontinue Medication
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 

function MvDiscontinueMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Discontinue Medication for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");


    
 Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for Prescribe medication");

//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"FrequencyView\", \"\", 1).WPFObject(\"Frequency_Group\").WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



///Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

 
  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
 

//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Successfully validated Discontinue Medication");
      Log.Checkpoint("End of Discontinue Medication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Discontinue Medication ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


 
//******************************************************************************************//
//******************************************************************************************//
// Name :MvOverrideNonAdministration
// Desc :Feature to validate Override Non Administration
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvOverrideNonAdministration(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");;
Log.Checkpoint("Start of Override Non-Administration for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	    

    //** Fill in the details for prescribe medication tab**
    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var volume = Data.getData(TestName,"MedicalCare","volume");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for Prescribe medication");

//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);

///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",quantity,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",volume,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

 
  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
 

//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated Override Non-Administration days");
      Log.Checkpoint("End of Override Non-Administration","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Override Non-Administration ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
}      

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewMetabolicTab
// Desc :Feature to validate prescribed medications are displayed in metabolic tab
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvReviewMetabolicTab(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Review Metabolic Tab "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");



    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var Rate = Data.getData(TestName,"MedicalCare","Rate");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for Prescribe medication");

//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",2)",exestatus);

// Click on TPN-BLT

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_1\")",exestatus);


//Entering values in orderable window

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"RateRange\")",Rate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Click on metabolic tab
//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 19)",exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\")",exestatus);

//Prescribe Medication- To order Glyceamic Management 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);



//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)



// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

  
//     // Get the save time value
//	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
//	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
//	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
//	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
 

//   // Validation of data in input and output tab
//   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Successfully reviewed  Metabolic Tab ");
      Log.Checkpoint("End of Review Metabolic Tab via nursing care ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Review Metabolic Tab  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
 

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewMedicationTimeline
// Desc :Feature to validate different medication's in prescribe medication tab
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvReviewMedicationTimeline(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Review Medication Timeline "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	      

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var DoseRate = Data.getData(TestName,"MedicalCare","DoseRate");
var Rate = Data.getData(TestName,"MedicalCare","Rate");
var PRNdrug = Data.getData(TestName,"MedicalCare","PRNdrug");
var PRNtemplate = Data.getData(TestName,"MedicalCare","PRNtemplate");
var PRNmedicaltype = Data.getData(TestName,"MedicalCare","PRNmedicaltype");
var PRNquantity = Data.getData(TestName,"MedicalCare","PRNquantity");
var PRNText = Data.getData(TestName,"MedicalCare","PRNText");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for PRN Medication");
//Prescribe Medication- To order PRN medication 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,PRNdrug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",PRNtemplate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",PRNText,exestatus);
//PRNmedicaltype
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", PRNmedicaltype,exestatus);
//Specify Interval
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity
//PRNquantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",PRNquantity,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 


Log.Message("*** Enter details for Nutrition");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",1)",exestatus);

// Click on TPN-BLT

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_2\")",exestatus);


//Entering values in orderable window 

//Rate at the range
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"RateRange\")",Rate,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

Log.Message("*** Enter details for Blood/ Fluid Products");

//Click on Prescribe Fresh Blood Products and Albumin button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",3)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"ImdButton\", \"\",2)",exestatus);

//Entering values in orderable window 

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"DoseRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"Button\", \"\", 3)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);



   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully reviewed  Medication Timeline");
      Log.Checkpoint("End of Review Medication Timeline ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Review Medication Timeline  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvOverRideAlleryReason
// Desc :Feature to validate the Override Allery Reason
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvOverRideAlleryReason(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Allergies for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

// Enter the Allergy Details
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Allergies/ADR");


var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
    
  if (allergies.Enabled == true)
  {
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"MvcmdRemoveAllergy\")",exestatus);
  Log.message("Delete the exisiting allergies");
  }
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdAddAllergy\")",exestatus);
    Log.Message("Enter Allergy details");

//Enter the Drug Type and other details
	//var objData = Data.getData(TestName,"MedicalCare"); 
  
var type = Data.getData(TestName,"MedicalCare","type");
Log.message("Drug type value is ",type);
var seldrfam = Data.getData(TestName,"MedicalCare","seldrfam");
Log.message("Selected Drug family is ",seldrfam);
var seldrfam1 = Data.getData(TestName,"MedicalCare","seldrfam1");
Log.message("Selected Drug family is ",seldrfam1);
var med = Data.getData(TestName,"MedicalCare","med");
Log.message("Medication ",med);
var ingr = Data.getData(TestName,"MedicalCare","ingr");
Log.message("Ingredient ",ingr);
var msc = Data.getData(TestName,"MedicalCare","msc");
Log.message("Miscellaneous ",msc);
var Rea = Data.getData(TestName,"MedicalCare","Rea");
Log.message("Reactions ",Rea);
var Comment = Data.getData(TestName,"MedicalCare","Comment");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var volume = Data.getData(TestName,"MedicalCare","volume");
var allcomment = Data.getData(TestName,"MedicalCare","allcomment");
//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");

exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);


switch(type){
case ("Drug Family"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
break;

case ("Drug subfamily"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
break;

case ("Ingredient"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
break;

case ("Miscellaneous"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
break;

default:
Log.Message("Did not enter drug type");

}

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Check for Popup message (Allergen was previouly documented for this patient

var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
if (Msgwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    Log.Message("Allergen details was previously documented for this patient");
    }
    else
{
Log.Message("Allergen details have not been documented for this patient");
}

//Click on Save button in drug details window

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);

//Verify Action issues popup is displayed

var Allmsgwindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergiesActionIssues\")", 1000);


if (Allmsgwindow.Exists)
   {
      exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stlIssues\")",98,55,exestatus);
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"ImdButton\" ,\"View and Acknowledge\")",exestatus);
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);         
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdProceed\")",exestatus);
         

    Log.Checkpoint("Allergy Popup message is displayed");
    }
    else
{
Log.Message("Allergy Popup message is NOT displayed");
}


//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);


//Enter drug details
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"Button\", \"\",1)",exestatus);


///Enter Medication Quantity

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
//Enter Diluent Volume
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"LayoutGroup\", \"\"\, 2).WPFObject(\"LayoutItem\", \"\"\, 2).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"LayoutItem\", \"\"\, 1).WPFObject(\"LayoutGroup\", \"\"\, 1).WPFObject(\"SpinEdit\", \"\"\, 1)",1,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Check for the Warning Message
var warwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);


if (warwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
     
    Log.Message("Warning message for dose administration is displayed");
    }
    else
{
Log.Message("No warning message is displayed");
}

//Resolve the Allergies warning

switch(type){
case ("Drug Family"):
Log.Message("No Action required");
break;

case ("Drug subfamily"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);

case ("Ingredient"):
Log.Message("No Action required");
break;

case ("Miscellaneous"):
Log.Message("No Action required");
break;

default:
Log.Message("No Allergies Warning");
}     
//Check for Allergies Warning
   
var allergywindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergyAlert\")", 1000);


if (allergywindow.Exists)
   {
 
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
    
    Log.Checkpoint("Allergies warning is displayed");
    }
    else
   {
   Log.Checkpoint("No warning message is displayed");
  }
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" successfully documented override allergy reason");
      Log.Checkpoint("End of override allergy reason","The flow is completed");
    }
  }
  
  else {
  Log.Message("Skipped override allergy reason","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    

}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVPhysicalRestraints
// Desc :Feature to validate the Physical Restraints for a patient
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MVPhysicalRestraints(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
 var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Physical Restraints for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	   
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Physical Restraint(s) Order");
	// Wait for screen to appear

	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
        // ** Fill in the Physical Restraints details

	Log.Message("*** Enter details for  Physical Restraints ***");

	      
	      var InitialPatient = Data.getData(TestName,"MedicalCare", "InitialPatient");
        var IndicationRestraint = Data.getData(TestName,"MedicalCare","IndicationRestraint");
        var IndicationRestrRemoval = Data.getData(TestName,"MedicalCare","IndicationRestrRemoval");
        var AlternativeInterven = Data.getData(TestName,"MedicalCare","AlternativeInterven");
        var JustifiJoi= Data.getData(TestName,"MedicalCare","JustifiJoi");
        var PersResp = Data.getData(TestName,"MedicalCare","PersResp");
        var PersRespBy = Data.getData(TestName,"MedicalCare","PersRespBy");
        var ClinicianOrdering = Data.getData(TestName,"MedicalCare","ClinicianOrdering");
  
	       exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ClinicianOrdering,exestatus);
	       exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",InitialPatient,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",IndicationRestraint,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",IndicationRestrRemoval,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",AlternativeInterven,exestatus);
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",JustifiJoi,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",PersResp,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",PersRespBy,exestatus);
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_1\")",exestatus);
         exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"OK\", 1)", 120,exestatus);
         exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus); 
          

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
 

  
	
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
 
// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
//Validation part open form again

  exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Physical Restraint(s) Order");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", ClinicianOrdering, "ClinicianOrdering",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", InitialPatient, "InitialPatient",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", IndicationRestraint, "IndicationRestraint",exestatus); 
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", IndicationRestrRemoval, "IndicationRestrRemoval",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", AlternativeInterven, "AlternativeInterven",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", JustifiJoi, "JustifiJoi",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text", PersRespBy, "PersRespBy",exestatus);
 
  // close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
   
   

    
//   var objData = Data.getData(TestName,"Patient");
//  	var newPatientMRN = Navigation("MRN").Value;
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Physical Restraints");
      Log.Checkpoint("End of Document Physical Restraints","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Physical Restraints","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvBolusToolTip
// Desc :Feature to validate Bolus ToolTip being displayed for a medication
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvBolusToolTip(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Medications");
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Bolus tooltip validation "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	     

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity = Data.getData(TestName,"Medications","quantity");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var SetInterval = Data.getData(TestName,"Medications","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");   


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);
//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

Log.Message("*** Enter details for Blood/ Fluid Products");

//Click on Prescribe Fresh Blood Products and Albumin button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",3)",exestatus);



// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"ImdButton\", \"\",2)",exestatus);


//Entering values in orderable window 

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"DoseRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"Button\", \"\", 3)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

// Validation of dose in Administer medication tab-Pending
//Click on Administer Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

// Adding bolus to medication in Titrate medicatin tab- pending
//Click on Titrate Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,12",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Added bolus to the medication");
      Log.Checkpoint("End of Bolus tooltip validation ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Bolus tooltip validation  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//



//******************************************************************************************//
//******************************************************************************************//
// Name :MvMedicationChart
// Desc :Feature to validate the Medication Chart
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :Satheeshkumar C
// Update date:10-Jan-2018
// Update desc:Commented the lines related to allergy
//******************************************************************************************//
//******************************************************************************************//

// Feature created for medication chart time line
function MvMedicationChart(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of medication chart "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	   
    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var DoseRate = Data.getData(TestName,"MedicalCare","DoseRate");
var Rate = Data.getData(TestName,"MedicalCare","Rate");
var PRNdrug = Data.getData(TestName,"MedicalCare","PRNdrug");
var PRNtemplate = Data.getData(TestName,"MedicalCare","PRNtemplate");
var PRNmedicaltype = Data.getData(TestName,"MedicalCare","PRNmedicaltype");
var PRNquantity = Data.getData(TestName,"MedicalCare","PRNquantity");
var PRNText = Data.getData(TestName,"MedicalCare","PRNText");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
//var type = Data.getData(TestName,"MedicalCare","type");
//Log.message("Drug type value is ",type);
//var seldrfam = Data.getData(TestName,"MedicalCare","seldrfam");
//Log.message("Selected Drug family is ",seldrfam);
//var seldrfam1 = Data.getData(TestName,"MedicalCare","seldrfam1");
//Log.message("Selected Drug family is ",seldrfam1);
//var med = Data.getData(TestName,"MedicalCare","med");
//Log.message("Medication ",med);
//var ingr = Data.getData(TestName,"MedicalCare","ingr");
//Log.message("Ingredient ",ingr);
//var msc = Data.getData(TestName,"MedicalCare","msc");
//Log.message("Miscellaneous ",msc);
//var Rea = Data.getData(TestName,"MedicalCare","Rea");
//Log.message("Reactions ",Rea);
//var Comment = Data.getData(TestName,"MedicalCare","Comment");

//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for PRN Medication");
//Prescribe Medication- To order PRN medication 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,PRNdrug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",PRNtemplate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",PRNText,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem",PRNmedicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",PRNquantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 


Log.Message("*** Enter details for Nutrition");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",2)",exestatus);

// Click on TPN-BLT

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_3\")",exestatus);


//Entering values in orderable window 


exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"RateRange\")",Rate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",Rate,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

Log.Message("*** Enter details for Blood/ Fluid Products");

//Click on Prescribe Fresh Blood Products and Albumin button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",3)",exestatus);



// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"ImdButton\", \"\",3)",exestatus);


//Entering values in orderable window 

exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"DoseRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\")*.WPFObject(\"Button\", \"\", 3)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Log.Message("*** Enter allergy details for a patient");

//// Selecting Allergies/ADR from menu
//exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Allergies/ADR");
//
//// Validation of allergies
//var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
//var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
//    
//  if (allergies.Enabled == true)
//  {
//  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"MvcmdRemoveAllergy\")",exestatus);
//  Log.message("Delete the exisiting allergies");
//  }
//  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdAddAllergy\")",exestatus);
//    Log.Message("Enter Allergy details");
//
//
//// Entering details for allergies
//
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);
//
//
//switch(type){
//case ("Drug Family"):
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
//break;
//
//case ("Drug subfamily"):
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
//break;
//
//case ("Medication"):
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
//break;
//
//case ("Ingredient"):
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
//break;
//
//case ("Miscellaneous"):
//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
//break;
//
//default:
//Log.Message("Did not enter drug type");
//
//}
////exestatus = mvObjects.selectComboItem(vProcess, "WinFormsObject(\"cboSelectedObjectFamily\")",selecteddrugfam,exestatus);
////exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldfm,exestatus);
////exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"mvstlReactions\")",rea,exestatus);
//exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
//exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
//exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
//exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
//
//
////Check for Popup message (Allergen was previouly documented for this patient
//
//var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
//if (Msgwindow.Exists)
//   {
//     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
//    Log.Message("Allergen details was previously documented for this patient");
//    }
//    else
//{
//Log.Message("Allergen details have not been documented for this patient");
//}
//
////Click on Save button in drug details window
//
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);
//
////Verify Action issues popup is displayed
//
//var Allmsgwindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergiesActionIssues\")", 1000);
//
//
//if (Allmsgwindow.Exists)
//   {
//      exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stlIssues\")",98,55,exestatus);
//      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"ImdButton\" ,\"View and Acknowledge\")",exestatus);
//     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);         
//     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdProceed\")",exestatus);
//         
//
//    Log.Checkpoint("Allergy Popup message is displayed");
//    }
//    else
//{
//Log.Message("Allergy Popup message is NOT displayed");
//}

// Medication chart validation will be done as a part of eNMIC validation
   
   
    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated medication chart ");
      Log.Checkpoint("End of medication chart ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped medication chart  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvNoteOnMedicationOrder
// Desc :Feature to validate recorded notes are being displayed in order entry window
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvNoteOnMedicationOrder(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Note On Medication Order "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	    

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

    //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Successfully validated Note On Medication Order");
      Log.Checkpoint("End of Note On Medication Order ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Note On Medication Order  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvAdministerMedication
// Desc :Feature to validate Administer Medication tab and doses that has been  validated
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvAdministerMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Administer Medication tab validation for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	      

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

//click on Administer medication tab

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"btnMoveToCurrentTime\")",exestatus);

// Final flow sheet validation is pending

//var objData = Data.getData(TestName,"Patient");
//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated Administer Medication tab");
      Log.Checkpoint("End of Administer Medication tab validation ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  Administer Medication tab validation  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvTrackChangesMedicationOrder
// Desc :Feature to validate Track the changes in MedicationOrder and dose
// Owner :Satheeshkumar C
// Creation date:Aug 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvTrackChangesMedicationOrder(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Track a changes in Medication Order "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	     

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"MedicalCare","drug");
var template=Data.getData(TestName,"MedicalCare","template");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var quantity = Data.getData(TestName,"MedicalCare","quantity");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);
//
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",Rate,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Modify the order & dose then validate the log



//var objData = Data.getData(TestName,"Patient");
//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated Changes in medication order");
      Log.Checkpoint("End of Track a changes in Medication Order ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  Track a changes in Medication Order  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


// Feature created for Motor Vehicle Accident Note
function MvMotorVehicleAccidentNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start Motor Vehicle Accident Note for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Motor Vehicle Accident Note.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes", "Social Work Notes", "Motor Vehicle Accident Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Motor Vehicle Accident Note form data ***");
	var ANFCompleted = Data.getData(TestName,"MedicalCare","ANFCompleted");
	var PoliceStation = Data.getData(TestName,"MedicalCare","PoliceStation");
	var InvestigatingOfficer = Data.getData(TestName,"MedicalCare","InvestigatingOfficer");
	var EventNumber = Data.getData(TestName,"MedicalCare","EventNumber");
	var CPTInsurerName = Data.getData(TestName,"MedicalCare","CPTInsurerName");
	var PersonalInjury = Data.getData(TestName,"MedicalCare","PersonalInjury");
	
	 
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",ANFCompleted,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",PoliceStation,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",InvestigatingOfficer,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",EventNumber,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",CPTInsurerName,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",PersonalInjury,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	//timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	//timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Motor Vehicle Accident Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes", "Social Work Notes", "Motor Vehicle Accident Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text", ANFCompleted, "ANFCompleted",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", PoliceStation, "PoliceStation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", InvestigatingOfficer, "InvestigatingOfficer",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", EventNumber, "EventNumber",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", CPTInsurerName, "CPTInsurerName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_2\")", "Text", PersonalInjury, "PersonalInjury",exestatus);
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Motor Vehicle Accident Note",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text", ANFCompleted, "ANFCompleted",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", PoliceStation, "PoliceStation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", InvestigatingOfficer, "InvestigatingOfficer",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", EventNumber, "EventNumber",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", CPTInsurerName, "CPTInsurerName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_2\")", "Text", PersonalInjury, "PersonalInjury",exestatus);
	// close the form 
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  
  
  //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Motor Vehicle Accident Note to is successful");
      Log.Checkpoint("End Motor Vehicle Accident Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Motor Vehicle Accident Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeWarfarin
// Desc :Feature to prescribe and validate warfarin medication
// Owner :Satheeshkumar C
// Creation date:22 Sep 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPrescribeWarfarin(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Prescribe Warfarin Medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var Warfarin_Indication=Data.getData(TestName,"Medications","Warfarin_Indication");
var WarfarinRange_From=Data.getData(TestName,"Medications","WarfarinRange_From");
var WarfarinRange_To=Data.getData(TestName,"Medications","WarfarinRange_To");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

// Enter medication quantity
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")",Warfarin_Indication,exestatus);
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_1\").WPFObject(\"txtNumeric_1\")","WarfarinRange_From",exestatus);
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_2\").WPFObject(\"txtNumeric_2\")","WarfarinRange_To",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_1\").WPFObject(\"txtNumeric_1\")",WarfarinRange_From,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_2\").WPFObject(\"txtNumeric_2\")",WarfarinRange_To,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet




  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Prescribed Warfarin Medication ");
      Log.Checkpoint("End of Prescribe Warfarin Medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  Prescribe Warfarin Medication  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}



//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribePharmaVTE
// Desc :Feature to prescribe and validate warfarin medication
// Owner :Jyoti
// Creation date:08 Jan 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPrescribePharmaVTE(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Prescribe Pharmaceutical VTE Medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity=Data.getData(TestName,"Medications","drug_quantity");
var VTE_Purpose=Data.getData(TestName,"Medications","VTE_Purpose");
var Start = Data.getData(TestName,"Medications","Start");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",VTE_Purpose,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);

//for a already present dose
//exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmlOk\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet
 
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Prescribed VTE Medication ");
      Log.Checkpoint("End of Prescribe VTE Medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  Prescribe VTE Medication  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeTPN
// Desc :Feature to prescribe Total Parenteral Nutrition
// Owner :Satheeshkumar C
// Creation date:22 Sep 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPrescribeTPN(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Prescribe Total Parenteral Nutrition "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Selecting different tab

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"TabGrid\").WPFObject(\"MvTab\").WPFObject(\"TabItem\", \"\", 2)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",1)",exestatus);

// Click on TPN-BLT

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_1\")",exestatus);


//Entering values in orderable window 


exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

// final validation is pending- Flowsheet


  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Prescribed Total Parenteral Nutrition");
      Log.Checkpoint("End of Total Parenteral Nutrition","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Prescribe Total Parenteral Nutrition","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeTopicalPatch
// Desc :Flow to PrescribeTopicalPatch
// Owner :Sangiliraja J
// Creation date:Sep 22, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeTopicalPatch - Flowsheet validation to be checked
function MvPrescribeTopicalPatch(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeTopicalPatch for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Topical Patch
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity and the set the interval
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);

//Fill the mandatory form attached
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdAction_1\")",exestatus);

//Order the used - Patch removal and disposal
//Set interval
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\", 1).*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
//Enter quantity and save the form
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"HwndSource: ImdGenericWindow\", \"\", 1).*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
//Click OK
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\", 1).*WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 4).WPFObject(\"Button\", \"OK\", 1)",exestatus);
//Save and close the attached form
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);

//Saving and closing the form
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedTopicalPatch");
      Log.Checkpoint("End PrescribeTopicalPatch","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeTopicalPatch","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeOralMedication
// Desc :Flow to Prescribe Oral Medication
// Owner :Jyoti S
// Creation date:Feb 19, 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeOralMedication - Flowsheet validation to be checked
function MvPrescribeOralMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start MvPrescribeOralMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Oral Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity and the set the interval
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully MvPrescribeOralMedication");
      Log.Checkpoint("End MvPrescribeOralMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MvPrescribeOralMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeSetInterval
// Desc :Flow to Prescribe Oral Medication
// Owner :Jyoti S
// Creation date:Feb 19, 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// MvPrescribeSetInterval - Flowsheet validation to be checked
function MvPrescribeSetInterval(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start MvPrescribeSetInterval for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Oral Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","SpinEdit", SetInterval,exestatus)
//exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Row1_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"FrequencyView\", \"\", 1).WPFObject(\"Frequency_Group\").WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)", SetInterval, exestatus);

//Enter Medication Quantity and the set the interval
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully MvPrescribeSetInterval");
      Log.Checkpoint("End MvPrescribeSetInterval","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MvPrescribeSetInterval","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeMedsSelectedtime
// Desc :Flow to Prescribe Oral Medication at selected times.
// Owner : Jyoti Sonar
// Creation date:Feb 14, 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeOralMedication - Flowsheet validation to be checked
function MvPrescribeMedsSelectedtime(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeOralMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");


//Prescribe Oral Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Button\", \"\", 1)", exestatus);
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"stopTimeControl\")",schedtime, exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Apply\", 1)", exestatus);


//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the past dose warning
//exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmlOk\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully MvPrescribeMedsSelectedtime");
      Log.Checkpoint("End MvPrescribeMedsSelectedtime","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MvPrescribeMedsSelectedtime","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}




//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeMeds_Resolve
// Desc :Flow to Prescribe Medication and resolve past dose warning
// Owner :Jyoti Sonar
// Creation date:13/02/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeOralMedication - Flowsheet validation to be checked
function MvPrescribeMeds_Resolve(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeOralMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Oral Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the past dose warning
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmlOk\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedOralMedication");
      Log.Checkpoint("End MvPrescribeMeds_Resolve","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MvPrescribeMeds_Resolve","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeIntravenousInfusionMedication
// Desc :Flow to Prescribe Intravenous Infusion Medication
// Owner :Sangiliraja J
// Creation date:Oct 05, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeIntravenousInfusionMedication - Flowsheet validation to be checked
function MvPrescribeIntravenousInfusion(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeIntravenousInfusionMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Intravenous Infusion Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedIntravenousInfusionMedication");
      Log.Checkpoint("End PrescribeIntravenousInfusionMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeIntravenousInfusionMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeModifiedReleaseMedication
// Desc :Flow to Prescribe Modified Release Medication
// Owner :Sangiliraja J
// Creation date:Oct 05, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// PrescribeModifiedReleaseMedication - Flowsheet validation to be checked
function MvPrescribeModifiedRelease(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start PrescribeModifiedReleaseMedication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe Modified Release Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully PrescribedModifiedReleaseMedication");
      Log.Checkpoint("End PrescribeModifiedReleaseMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped PrescribeModifiedReleaseMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeProductOpposed
// Desc :Feature to Prescribe and Validate Product Opposed medication
// Owner :Sangiliraja J
// Creation date:05 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPrescribeProductOpposed(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Prescribe Product Opposed Medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var Warfarin_Indication=Data.getData(TestName,"Medications","Warfarin_Indication");
var WarfarinRange_From=Data.getData(TestName,"Medications","WarfarinRange_From");
var WarfarinRange_To=Data.getData(TestName,"Medications","WarfarinRange_To");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

// Enter medication quantity
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")",Warfarin_Indication,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_1\").WPFObject(\"txtNumeric_1\")",WarfarinRange_From,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_2\").WPFObject(\"txtNumeric_2\")",WarfarinRange_To,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet




  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Prescribed Product Opposed Medication ");
      Log.Checkpoint("End of Prescribe Product Opposed Medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped  Prescribe Product Opposed Medication  ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOrderingPRNDisplay
// Desc :Flow to Ordering PRN Display
// Owner :Sangiliraja J
// Creation date:Oct 06, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// OrderingPRNDisplay - Flowsheet validation to be checked
function MvOrderingPRNDisplay(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start OrderingPRNDisplay for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var PRNIndication = Data.getData(TestName,"Medications","PRNIndication");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Ordering PRN Display
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*.WPFObject(\"Row1_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"FrequencyView\", \"\", 1).WPFObject(\"Frequency_Group\").WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"TextEdit\", \"\", 1)",PRNIndication,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully OrderedPRNDisplay");
      Log.Checkpoint("End OrderingPRNDisplay","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped OrderingPRNDisplay","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOrderingPRNIndication
// Desc :Flow to OrderingPRNIndication
// Owner :Sangiliraja J
// Creation date:Oct 06, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// OrderingPRNIndication - Flowsheet validation to be checked
function MvOrderingPRNIndication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start OrderingPRNIndication for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var PRNIndication = Data.getData(TestName,"Medications","PRNIndication");
var Password = Data.getData(TestName,"Navigation","Password");

//OrderingPRNIndication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*.WPFObject(\"Row1_Group\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"FrequencyView\", \"\", 1).WPFObject(\"Frequency_Group\").WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"TextEdit\", \"\", 1)",PRNIndication,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully OrderingPRNIndication");
      Log.Checkpoint("End OrderingPRNIndication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped OrderingPRNIndication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDetectGenericDrugName
// Desc :Flow to DetectGenericDrugName
// Owner :Sangiliraja J
// Creation date:Oct 06, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// DetectGenericDrugName - Flowsheet validation to be checked
function MvDetectGenericDrugName(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start DetectGenericDrugName for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//DetectGenericDrugName
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully DetectGenericDrugName");
      Log.Checkpoint("End DetectGenericDrugName","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DetectGenericDrugName","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDisplayGenericDrugName
// Desc :Flow to DisplayGenericDrugName
// Owner :Sangiliraja J
// Creation date:Oct 09, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// DisplayGenericDrugName - Flowsheet validation to be checked
function MvDisplayGenericDrugName(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start DisplayGenericDrugName for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//DisplayGenericDrugName
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully DisplayGenericDrugName");
      Log.Checkpoint("End DisplayGenericDrugName","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DisplayGenericDrugName","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvBSAAutomaticallyCalculated
// Desc :Flow to BSAAutomaticallyCalculated
// Owner :Sangiliraja J
// Creation date:Oct 09, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV BSA Automatically Calculated
function MvBSAAutomaticallyCalculated(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start BSAAutomaticallyCalculated for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add BSAAutomaticallyCalculated.";
      aqUtils.Delay (ms, HelpStr);
  
	//Select the Prescribe Medication tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Weights and Dimensions button 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",7)",exestatus);
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Weights and Heights data ***");
	var Height = Data.getData(TestName,"MedicalCare","Height");
	var WeightLatest = Data.getData(TestName,"MedicalCare","WeightLatest");
	var WeightAdmission = Data.getData(TestName,"MedicalCare","WeightAdmission");
	var WeightDrug = Data.getData(TestName,"MedicalCare","WeightDrug");
	var WeightIdeal = Data.getData(TestName,"MedicalCare","WeightIdeal");
  var WeightAdjusted = Data.getData(TestName,"MedicalCare","WeightAdjusted");
  var bmi = Data.getData(TestName,"MedicalCare","bmi");
  var bsa = Data.getData(TestName,"MedicalCare","bsa");
		
	 
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Height,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",WeightLatest,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",WeightAdmission,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightDrug,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  //timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("BSAAutomaticallyCalculated Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   // iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  //Select the Prescribe Medication tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Weights and Dimensions button 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",7)",exestatus);
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
  //exestatus = mvObjects.waitForObject(vprocess,"WPFObject(\"sessionscontrol\")",120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value","160", "Height",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value","80", "WeightLatest",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value","80", "WeightAdmission",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value","80", "WeightDrug",exestatus);
  //Below values are moved from here
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")", "BindableValue","57.2", "WeightIdeal",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")", "BindableValue","66.3", "WeightAdjusted",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text","31.2", "bmi",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text","1.833", "bsa",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
    
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" BSAAutomaticallyCalculated is successful");
      Log.Checkpoint("End BSAAutomaticallyCalculated","The flow is completed");
       
    }
  }
  else {
  Log.Message("Skipped BSAAutomaticallyCalculated","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
    
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//



//******************************************************************************************//
//******************************************************************************************//


// Name :MvModifyVariableDose
// Desc :Feature to prescribe and modify the variable dose medication
// Owner :Satheeshkumar C
// Creation date:04 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvModifyVariableDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of modify variable dose medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)


exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet




  
  if (equal(exestatus,true)) {

	 	  Log.Checkpoint("Successfully modified dose of varibale medication");
      Log.Checkpoint("End of modify variable dose medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped modify variable dose medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//


// Name :MvEnterPatientPreference
// Desc :Feature to enter Patient Preference in order entry window
// Owner :Satheeshkumar C
// Creation date:04 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvEnterPatientPreference(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of entering Patient Preference in order entry window"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var allcomment=Data.getData(TestName,"Medications","allcomment");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);



// Enter patient preference
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"CaptionView\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Information\").WPFObject(\"Grid\", \"\", 2).WPFObject(\"WrapPanel\", \"\", 3).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",allcomment,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);
//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet




  
  if (equal(exestatus,true)) {

	 	  Log.Checkpoint("Successfully entered patient preference in order entry window");
      Log.Checkpoint("End of providing patient preference in order entry window ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped entering patient preference in order entry window ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//


// Name :MvEnterTotalDose
// Desc :Feature to enter only dose value in quqntity /voulme field
// Owner :Satheeshkumar C
// Creation date:05 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvEnterTotalDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of entering only dose value in quantity /voulme field"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var quant_Spchar = Data.getData(TestName,"Medications","quant_Spchar");
var quant_expvalue = Data.getData(TestName,"Medications","quant_expvalue");

var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)




// Enter medication quantity as dose
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// Enter medication quantity value as character and special character
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quant_Spchar,exestatus);
Log.Message("*** Unable to enter special characters in quantity field");

// Enter medication frequency
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);


// Validation of quantity value
exestatus = mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)", "Text",quant_expvalue,"Quantity",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue







exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet




  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully entered only dose value in quantity /voulme field");
      Log.Checkpoint("End of entering only dose value in quantity /voulme field ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped entering only dose value in quantity /voulme field","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//




//******************************************************************************************//
//******************************************************************************************//


// Name :MvChangeRate
// Desc :Feature to increase /decrease the rate of infused medication
// Owner :Satheeshkumar C
// Creation date:05 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvChangeRate(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of increase /decrease the rate of infused medication"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var Diluent_Drug = Data.getData(TestName,"Medications","Diluent_Drug")
var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant")

var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);



exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)


// Enter medication frequency
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

//Select the Diluent button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 7).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

// Enter the diluent and quantity
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"TextEdit\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"FindComboBoxEdit\")",5,2,Diluent_Drug,2,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,12",exestatus);


  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully increase /decrease the rate of infused medication");
      Log.Checkpoint("End of increase /decrease the rate of infused medication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped increase /decrease the rate of infused medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//




//******************************************************************************************//
//******************************************************************************************//


// Name :MvPrescribeAdministerVariableDose
// Desc :Feature to prescribe and administer the variable dose medication
// Owner :Satheeshkumar C
// Creation date:05 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvPrescribeAdministerVariableDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of prescribe and administer variable dose medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var Diluent_Drug = Data.getData(TestName,"Medications","Diluent_Drug")
var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant")
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);


exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



//Select the Diluent button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 7).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

// Enter the diluent and quantity
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"TextEdit\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"FindComboBoxEdit\")",5,2,Diluent_Drug,2,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

// Enter medication quantity 
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully prescribed and administered variable dose medication");
      Log.Checkpoint("End of prescribe and administer variable dose medication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped prescribe and administer variable dose medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//


// Name :MvModifyOrder
// Desc :Feature to prescribe and modify the medication order
// Owner :Satheeshkumar C
// Creation date:06 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvModifyOrder(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of prescribe and modify the medication order"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);


  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully prescribed and modified the medication order");
      Log.Checkpoint("End of prescribe and modify the medication order","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped prescribe and modify the medication order","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//


// Name :MvModifyInsulinOrNutritionDose
// Desc :Feature to prescribe and modify the Insulin Or Nutrition Dose
// Owner :Satheeshkumar C
// Creation date:06 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvModifyInsulinOrNutritionDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of prescribe and modify the Insulin Or Nutrition Dose"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity=Data.getData(TestName,"Medications","quantity");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Selecting different tab
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"TabGrid\").WPFObject(\"MvTab\").WPFObject(\"TabItem\", \"\", 2)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",1)",exestatus);

// Click on TPN-BLT
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_2\")",exestatus);


//Entering values in orderable window 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

// Selecting Medication plan tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
// Validatio of insulin and Nutrition doses are pending- Flow sheet

// Selecting motabolic tab and modify the insulin and Nutrition doses
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,20",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully prescribed and modified the Insulin Or Nutrition Dose");
      Log.Checkpoint("End of prescribe and modify the Insulin Or Nutrition Dose","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped prescribe and modify the Insulin Or Nutrition Dose","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//


// Name :MvNoZeroAfterdecimal
// Desc :Feature to validate No Zero after a Decimal Point in any medication 
// Owner :Satheeshkumar C
// Creation date:06 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvNoZeroAfterdecimal(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {























var tcDesc = Data.getData(TestName,"Medications","TC_DESC");



















Log.Checkpoint("Start of no zero after a Decimal Point in any medication"+tcDesc ,"The flow is started");
	




















  


//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");







//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var quant_expvalue = Data.getData(TestName,"Medications","quant_expvalue");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);









//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)


// Enter medication quantity with zero after a decimal point
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);


// Enter medication frequency
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Validation of quantity value
exestatus = mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)", "Text",quant_expvalue,"Quantity",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet


  


  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated no zero after a Decimal Point");





      Log.Checkpoint("End of no zero after a Decimal Point in any medication ","The flow is completed");
    }
  }









  else {
  Log.Message("Skipped no zero after a decimal point in any medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  


  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvPRNMaximumdailyDose
// Desc :Feature to validate Maximum daily Dose for PRN & comments field
// Owner :Satheeshkumar C
// Creation date:09 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPRNMaximumdailyDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of validate Maximum daily Dose for PRN and comments field"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var allcomment = Data.getData(TestName,"Medications","allcomment");
//var quant_expvalue = Data.getData(TestName,"Medications","quant_expvalue");
var PRNText=Data.getData(TestName,"MedicalCare","PRNText");
var Password = Data.getData(TestName,"Navigation","Password");
 

Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"TextEdit\", \"\", 1)",PRNText,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

// Enter medication frequency
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// Enter comments in textbox
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"StartStopMethodsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Times\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"TextEdit\", \"\", 1)",allcomment,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue
//exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"slIssues\")",210,60,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Resolve\")",exestatus);

//To proceed with windowspopup
//var MsgForm = vProcess.Find("Name", "WinFormsObject(\"OK\")", 1000);
//     
//    if (MsgForm.Exists)
//    {
//    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
//    }

// To enter the expected quantity value
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quant_expvalue,exestatus);
//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 


// final validation is pending- Flowsheet
// To vadalite the maximum daily dose and other details are displayed in tooltip

  
  if (equal(exestatus,true)) {

	 	  Log.Checkpoint("Successfully validated Maximum daily Dose for PRN & comments field");
      Log.Checkpoint("End of validate Maximum daily Dose for PRN & comments field ","The flow is completed");

    }
  }
  else {
  Log.Message("Skipped validate Maximum daily Dose for PRN & comments field","The feature is skipped since the execution status is set as '"+exestatus+"'"); 

  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvPRNAdministerDose
// Desc :Feature to administer PRN medication and validate instruction to the nurse 
// Owner :Satheeshkumar C
// Creation date:09 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPRNAdministerDose(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of administer PRN medication and validate instruction to the nurse "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//Administer Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);


// final validation is pending- Flowsheet
//  administer PRN medication and validate instruction to the nurse in flow sheet

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully administer PRN medication and validated instruction to the nurse");
      Log.Checkpoint("End of administer PRN medication and validate instruction to the nurse","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped administer PRN medication and validate instruction to the nurse","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentMedicationManagementPlan
// Desc :Function to Add New Medication review for a patient
// Owner :Sangiliraja J
// Creation date:October 20, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDocumentMedicationManagementPlan(TestName,exestatus)
{

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

//Navigate to the Medication Review 

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,14",exestatus);

//Click on New Medication Review
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\"),\"\"\,1",exestatus);

//Enter details in Medication Review


//var objData = Data.getData(TestName,"Medications");
var Comment1 = Data.getData(TestName,"Medications","Comment1");
var Combo1 = Data.getData(TestName,"Medications","Combo1");
var Combo2 = Data.getData(TestName,"Medications","Combo2");
var Comment2 = Data.getData(TestName,"Medications","Comment2");
var Radio1 = Data.getData(TestName,"Medications","Radio1");
var Radio2 = Data.getData(TestName,"Medications","Radio2");
var Comment3 = Data.getData(TestName,"Medications","Comment3");
var Comment4 = Data.getData(TestName,"Medications","Comment4");

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")", Comment1,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")", Combo1,exestatus);
exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")", Combo2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Comment2,exestatus);

//Enter the date and time for issue identified
//var objData = Data.getData(TestName,"Medications");
var issueday = Data.getData(TestName,"Medications","IssueDate");
day = aqDateTime.GetDay(issueday);
month = aqDateTime.GetMonth(issueday);
year = aqDateTime.GetYear(issueday);
//hr = aqString.substring(issueday, 11, 4);
//min = aqString.substring(issueday, 13, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", day,month,year,"4","45",exestatus);

//Get current date and time for date resolved
var currentDateAndTime = aqDateTime.Now();
drday = aqDateTime.GetDay(currentDateAndTime);
drmonth = aqDateTime.GetMonth(currentDateAndTime);
dryear = aqDateTime.GetYear(currentDateAndTime);
drhr = aqDateTime.GetHours(currentDateAndTime);
drmin = aqDateTime.GetMinutes(currentDateAndTime);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")",drday,drmonth,dryear,drhr,drmin,exestatus);

exestatus = mvObjects.selectradiobutton(vProcess,"WPFObject(\"shpTextRadioBorder_1\")",Radio1,exestatus);

switch(Radio1){
case ("Alternative Plan"):
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_3\")",Comment4,exestatus);
break;

default:
Log.Message("Alternative plan was not selected");
}

exestatus = mvObjects.selectradiobutton(vProcess,"WPFObject(\"shpTextRadioBorder_2\")",Radio2,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_4\")",Comment3,exestatus);

//Add Pharmacy Note
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\,\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_1\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_2\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*.WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\"\, 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_3\")",exestatus);
//Click on Save and Close in the pharmacy note page
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\"\, 1).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"StackPanel\", \"\"\, 1).WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
//Click on Save and Close in the first page
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\"\).WPFObject(\"frmMain\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"StackPanel\", \"\"\, 1).WPFObject(\"cmdSave\")",exestatus);
//Click on save
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);


return(exestatus);

}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvMarkDoseNotAdministered
// Desc :Flow to Mark Dose Not Administered
// Owner :Sangiliraja J
// Creation date:Oct 20, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// MarkDoseNotAdministered - Flowsheet validation to be checked
function MvMarkDoseNotAdministered(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start MarkDoseNotAdministered for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe MarkDoseNotAdministered Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully MarkedDoseNotAdministered");
      Log.Checkpoint("End MarkDoseNotAdministered","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MarkDoseNotAdministered","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentVIPScore
// Desc :Flow to DocumentVIPScore
// Owner :Sangiliraja J
// Creation date:Oct 23, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// Feature created for Document VIP Score
function MvDocumentVIPScore(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start DocumentVIPScore for "+tcDesc ,"The flow is started");
	//Start of the feature 
		
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Documentation of VIPScore.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations", "V.I.P.");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** DocumentVIPScore form data ***");
	var CannulaLocation = Data.getData(TestName,"NursingCare","CannulaLocation");
	
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",CannulaLocation,exestatus);
         
   //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_6\")",exestatus);
   
   exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")","1",exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("DocumentVIPScore Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations", "V.I.P.");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", CannulaLocation, "CannulaLocation",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
   if (equal(exestatus,true)) {
	 	  Log.Checkpoint("DocumentVIPScore is successful");
      Log.Checkpoint("End DocumentVIPScore","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DocumentVIPScore","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//


// Name :MvAssessMetabolicStatus
// Desc :Feature to AssessMetabolicStatus
// Owner :Sangiliraja J
// Creation date:23 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvAssessMetabolicStatus(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Assess Metabolic Status"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity=Data.getData(TestName,"Medications","quantity");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);


// Enter medication quantity 
//Quantity/Volume
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

//Infuse Over time
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 4).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"HybridRangeEdit\", \"\", 1)",quantity,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Selecting different tab
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"TabGrid\").WPFObject(\"MvTab\").WPFObject(\"TabItem\", \"\", 2)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",1)",exestatus);

// Click on TPN-BLT
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_2\")",exestatus);


//Entering values in orderable window 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

// Selecting Medication plan tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
// Validation of AssessMetabolicStatus- Flow sheet

// Selecting Metabolic tab for assessing Status
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,20",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Assessed Metabolic Status");
      Log.Checkpoint("End of Assess Metabolic Status","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Assess Metabolic Status","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//



//******************************************************************************************//
//******************************************************************************************//


// Name :MvRecordVentilation
// Desc :Feature to Record Ventilation
// Owner :Sangiliraja J
// Creation date:24 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRecordVentilation(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start Record Ventilation documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations","Non-Invasive Ventilation");
// Wait for screen to appear

exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
// ** Fill in the details to Record Ventilation **
Log.Message("*** enter details for Recording Ventilation for patient ***");
var FiO2  = Data.getData(TestName,"NursingCare","FiO2");
var Vt = Data.getData(TestName,"NursingCare","Vt");
var PEEP = Data.getData(TestName,"NursingCare","PEEP");
var MV = Data.getData(TestName,"NursingCare","MV");
var IPAP = Data.getData(TestName,"NursingCare","IPAP");
var RR = Data.getData(TestName,"NursingCare","RR");
var EPAP = Data.getData(TestName,"NursingCare","EPAP");
var Humidification = Data.getData(TestName,"NursingCare","Humidification");
var RRSet = Data.getData(TestName,"NursingCare","RRSet");
var HumidifierTemp = Data.getData(TestName,"NursingCare","HumidifierTemp");
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",FiO2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",Vt,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",PEEP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_7\")",MV,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",IPAP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_8\")",RR,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",EPAP,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Humidification,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",RRSet,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_9\")",HumidifierTemp,exestatus);
// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Timed Interventions","Ventilation (Invasive)");
aqUtils.Delay(10000);

var Specify = Data.getData(TestName,"NursingCare","Specify");
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"SpinEdit\", \"\", 1\")",Specify,exestatus);

//wait for Validate button to get enabled
exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\",\"Validate\", 1)","IsEnabled",true, 120,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"Validate\",1)",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Timed Interventions","Ventilation (Non-Invasive)");
aqUtils.Delay(10000);
var Specify = Data.getData(TestName,"NursingCare","SpecifyDuration");
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"SpinEdit\", \"\", 1\")",Specify,exestatus);

//wait for Validate button to get enabled
exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\",\"Validate\", 1)","IsEnabled",true, 120,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"Validate\",1)",exestatus);
       
   // Validation of data in Ventilation tab
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 4)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
   if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully Recorded Ventilation Details");
      Log.Checkpoint("End Record Ventilation","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Record Ventilation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvRecordInvasiveVentilation
// Desc :Feature to Record Invasive Ventilation
// Owner :Mohammad Zeeshan
// Creation date:18/06/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRecordInvasiveVentilation(TestName,exestatus)
{ 
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) 
    {
        var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
        Log.Checkpoint("Start Record Ventilation documentation for "+tcDesc ,"The flow is started");
    
        //Start of the feature 
        vProcess = Sys.Process("iMDSoft.Metavision");

        exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Timed Interventions","Ventilation (Invasive)");
        aqUtils.Delay(10000);

        var Specify = Data.getData(TestName,"NursingCare","Specify");
        exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"SpinEdit\", \"\", 1\")",Specify,exestatus);

        //wait for Validate button to get enabled
        exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\",\"Validate\", 1)","IsEnabled",true, 120,exestatus);

        // Save the form data
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"Validate\",1)",exestatus);

        // Validation of data in Ventilation tab
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 4)",exestatus);
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
        if (equal(exestatus,true)) 
        {
          Log.Checkpoint(" successfully Recorded Invasive Ventilation Details");
          Log.Checkpoint("End Record Invasive Ventilation","The flow is completed");
        }
    }
    else 
    {
      Log.Message("Skipped Record Invasive Ventilation","The feature is skipped since the execution status is set as '"+exestatus+"'");   
    }
    return exestatus;    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvHighFlowVentilation
// Desc :Feature to Record Invasive Ventilation
// Owner :Mohammad Zeeshan
// Creation date:19/06/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvHighFlowVentilation(TestName,exestatus)
{ 
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) 
    {
        var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
        Log.Checkpoint("Start Record Ventilation documentation for "+tcDesc ,"The flow is started");
    
        //Start of the feature 
        vProcess = Sys.Process("iMDSoft.Metavision");

        exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Timed Interventions","High flow");
        aqUtils.Delay(10000);

        var Specify = Data.getData(TestName,"NursingCare","Specify");
        exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"SpinEdit\", \"\", 1\")",Specify,exestatus);

        //wait for Validate button to get enabled
        exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\",\"Validate\", 1)","IsEnabled",true, 120,exestatus);

        // Save the form data
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"Validate\",1)",exestatus);

        // Validation of data in Ventilation tab
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 4)",exestatus);
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
        if (equal(exestatus,true)) 
        {
          Log.Checkpoint(" successfully Recorded Invasive Ventilation Details");
          Log.Checkpoint("End Record Invasive Ventilation","The flow is completed");
        }
    }
    else 
    {
      Log.Message("Skipped Record Invasive Ventilation","The feature is skipped since the execution status is set as '"+exestatus+"'");   
    }
    return exestatus;    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvRecordNonInvasiveVentilation
// Desc :Feature to Record Non Invasive Ventilation
// Owner :Mohammad Zeeshan
// Creation date:18/06/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRecordNonInvasiveVentilation(TestName,exestatus)
{ 
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) {
    var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
    Log.Checkpoint("Start Record NonInvasive Ventilation documentation for "+tcDesc ,"The flow is started");
    
    //Start of the feature 
    vProcess = Sys.Process("iMDSoft.Metavision");
    
    exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Timed Interventions","Ventilation (Non-Invasive)");
    aqUtils.Delay(10000);
    var Specify = Data.getData(TestName,"NursingCare","SpecifyDuration");
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"SpinEdit\", \"\", 1\")",Specify,exestatus);

    //wait for Validate button to get enabled
    exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\",\"Validate\", 1)","IsEnabled",true, 120,exestatus);

    // Save the form data
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"Validate\",1)",exestatus);
    
    //Enter the non-invasive details
    exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations","Non-Invasive Ventilation");
    
    // Wait for screen to appear
    exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
    
    // ** Fill in the details to Record Ventilation **
    Log.Message("*** enter details for Recording Ventilation for patient ***");
    var FiO2  = Data.getData(TestName,"NursingCare","FiO2");
    var Vt = Data.getData(TestName,"NursingCare","Vt");
    var PEEP = Data.getData(TestName,"NursingCare","PEEP");
    var MV = Data.getData(TestName,"NursingCare","MV");
    var IPAP = Data.getData(TestName,"NursingCare","IPAP");
    var RR = Data.getData(TestName,"NursingCare","RR");
    var EPAP = Data.getData(TestName,"NursingCare","EPAP");
    var Humidification = Data.getData(TestName,"NursingCare","Humidification");
    var RRSet = Data.getData(TestName,"NursingCare","RRSet");
    var HumidifierTemp = Data.getData(TestName,"NursingCare","HumidifierTemp");
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",FiO2,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",Vt,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",PEEP,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_7\")",MV,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",IPAP,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_8\")",RR,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",EPAP,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Humidification,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",RRSet,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_9\")",HumidifierTemp,exestatus);
    // Save the form data
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

    // Validation of data in Ventilation tab
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 4)",exestatus);
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
    if (equal(exestatus,true)) 
    {
        Log.Checkpoint(" successfully Recorded NonInvasive Ventilation Details");
        Log.Checkpoint("End Record NonInvasive Ventilation","The flow is completed");
    }
  }
  else 
  {
      Log.Message("Skipped Record NonInvasive Ventilation","The feature is skipped since the execution status is set as '"+exestatus+"'");   
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//


// Name :MvReviewNeurological
// Desc :Feature to Review Neurological
// Owner :Sangiliraja J
// Creation date:24 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvReviewNeurological(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"NursingCare");
var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start Review Neurological documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Glasgow Coma Scale");
// Wait for screen to appear

exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
// ** Fill in the details to Review Neurological Observations **
Log.Message("*** enter details for Review Neurological Observations for patient ***");
var Total = Data.getData(TestName,"NursingCare","Total"); 
var Eye = Data.getData(TestName,"NursingCare","Eye");
var Verbal  = Data.getData(TestName,"NursingCare","Verbal");
var Motor = Data.getData(TestName,"NursingCare","Motor");

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Eye,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Verbal,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Motor,exestatus);

// Save the form data
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

        
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	
        // close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores","Glasgow Coma Scale");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  
  //exestatus = mvObjects.waitForObject(vprocess,"WPFObject(\"sessionscontrol\")",120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")","Text",Total, "Total",exestatus);
// Close the form 
        
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	

  exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Behavioural Pain Scale");
// Wait for screen to appear

exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
// ** Fill in the details to Review Neurological Observations **
Log.Message("*** enter details for Review Neurological Observations for patient ***");
 
var Facial = Data.getData(TestName,"NursingCare","Facial");
var Upper  = Data.getData(TestName,"NursingCare","Upper");
var Ventilator = Data.getData(TestName,"NursingCare","Ventilator");

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Facial,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Upper,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Ventilator,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

   // Validation of data in Neuro/Pain tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 5)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
   if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully Reviewed Neurological Details");
      Log.Checkpoint("End Review Neurological","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Review Neurological","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvRecordKnownAllergies
// Desc :Feature to RecordKnownAllergies
// Owner :Sangiliraja J
// Creation date:Nov 06 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRecordKnownAllergies(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");
var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start Allergies for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

// Enter the Allergy Details
exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Allergies/ADR");


var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
    
  if (allergies.Enabled == true)
  {
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"MvcmdRemoveAllergy\")",exestatus);
  Log.message("Delete the exisiting allergies");
  }
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdAddAllergy\")",exestatus);
    Log.Message("Enter Allergy details");

//Enter the Drug Type and other details
//var objData = Data.getData(TestName,"Medications"); 

 
var type = Data.getData(TestName,"Medications","type");
Log.message("Drug type value is ",type);
var seldrfam = Data.getData(TestName,"Medications","seldrfam");
Log.message("Selected Drug family is ",seldrfam);
var seldrfam1 = Data.getData(TestName,"Medications","seldrfam1");
Log.message("Selected Drug family is ",seldrfam1);
var med = Data.getData(TestName,"Medications","med");
Log.message("Medication ",med);
var ingr = Data.getData(TestName,"Medications","ingr");
Log.message("Ingredient ",ingr);
var msc = Data.getData(TestName,"Medications","msc");
Log.message("Miscellaneous ",msc);
var Rea = Data.getData(TestName,"Medications","Rea");
Log.message("Reactions ",Rea);
var Comment = Data.getData(TestName,"Medications","Comment");

//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");


exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboObjectType\")",type,exestatus);


switch(type){
case ("Drug Family"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
break;

case ("Drug subfamily"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
break;

case ("Ingredient"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
break;

case ("Miscellaneous"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
break;

default:
Log.Message("Did not enter drug type");

}
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Check for Popup message (Allergen was previously documented for this patient

var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
if (Msgwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    Log.Message("Allergen details was previously documented for this patient");
    }
    else
{
Log.Message("Allergen details have not been documented for this patient");
}

//Click on Save button in drug details window

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);

//Check for Allergies Warning

//var objData = Data.getData(TestName,"Navigation");
var Password = Data.getData(TestName,"Navigation","Password");
   
var allergywindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergyAlert\")", 1000);

if (allergywindow.Exists)
   {
 
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
    Log.Checkpoint("Allergies warning is displayed");
    }
    else
{
Log.Checkpoint("No warning message is displayed");
}

 return exestatus;
}
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentDoseAdministration
// Desc :Flow to DocumentDoseAdministration
// Owner :Sangiliraja J
// Creation date:Nov 06, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// DocumentDoseAdministration - Flowsheet validation to be checked
function MvDocumentDoseAdministration(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start DocumentDoseAdministration for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var Password = Data.getData(TestName,"Navigation","Password");

//Prescribe DocumentDoseAdministration Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Administer DocumentDoseAdministration Medication in the Medication Plan tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully DocumentDoseAdministration");
      Log.Checkpoint("End DocumentDoseAdministration","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DocumentDoseAdministration","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewBurnsAdmission
// Desc :Flow to ReviewBurnsAdmission
// Owner :Sangiliraja J
// Creation date:Nov 06, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// Feature created for MV ReviewBurnsAdmission

function MvReviewBurnsAdmission(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start ReviewBurnsAdmission for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add ReviewBurnsAdmission.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns", "Burns Admission Management");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** ReviewBurnsAdmission ***");
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

	
  var DoesPatient = Data.getData(TestName,"MedicalCare","DoesPatient");
	var MechanismofInjury = Data.getData(TestName,"MedicalCare","MechanismofInjury");
  let BurnAdmission = new Object();
  
              BurnAdmission.TimeofBurn = Data.getData(TestName,"MedicalCare","TimeofBurn")
              DTDay = aqString.substring(BurnAdmission.TimeofBurn, 0, 2);
	            DTMonth = aqString.substring(BurnAdmission.TimeofBurn, 3, 2);
	            DTYear= aqString.substring(BurnAdmission.TimeofBurn, 6, 4);
	      var DescriptionofInjury = Data.getData(TestName,"MedicalCare","DescriptionofInjury");
        var TBSADermal = Data.getData(TestName,"MedicalCare","TBSADermal");
        var TBSAFullThickness = Data.getData(TestName,"MedicalCare","TBSAFullThickness");
        var TBSATotal = Data.getData(TestName,"MedicalCare","TBSATotal");
        var Tetanus = Data.getData(TestName,"MedicalCare","Tetanus");
	      var FirstAid = Data.getData(TestName,"MedicalCare","FirstAid");	
	      var Current = Data.getData(TestName,"MedicalCare","Current"); 
        var Component = Data.getData(TestName,"MedicalCare","Component");
        var Evidence = Data.getData(TestName,"MedicalCare","Evidence");
        var ICU = Data.getData(TestName,"MedicalCare","ICU");
        var Opthalmology = Data.getData(TestName,"MedicalCare","Opthalmology");
        var PainScore = Data.getData(TestName,"MedicalCare","PainScore");
        var RASS = Data.getData(TestName,"MedicalCare","RASS");
        var CAM = Data.getData(TestName,"MedicalCare","CAM");
        var Airway = Data.getData(TestName,"MedicalCare","Airway");
        var Isthere = Data.getData(TestName,"MedicalCare","Isthere");
        var AirwayInhalation = Data.getData(TestName,"MedicalCare","AirwayInhalation");
        var Interventions = Data.getData(TestName,"MedicalCare","Interventions");
        var Plan = Data.getData(TestName,"MedicalCare","Plan");
        var Crystalloids = Data.getData(TestName,"MedicalCare","Crystalloids");
        var TotalFluids = Data.getData(TestName,"MedicalCare","TotalFluids");
        var Colloids = Data.getData(TestName,"MedicalCare","Colloids");
        var Bloods = Data.getData(TestName,"MedicalCare","Bloods");
        var Parkland = Data.getData(TestName,"MedicalCare","Parkland");
        var ParklandFormula = Data.getData(TestName,"MedicalCare","ParklandFormula");
        var BalanceFirstEight = Data.getData(TestName,"MedicalCare","BalanceFirstEight");
        var RateFirstEight = Data.getData(TestName,"MedicalCare","RateFirstEight");
        var BalanceNextSixteen = Data.getData(TestName,"MedicalCare","BalanceNextSixteen");
        var RateNextSixteen = Data.getData(TestName,"MedicalCare","RateNextSixteen");
        var TargetMinimum = Data.getData(TestName,"MedicalCare","TargetMinimum");
        var TargetMaximum = Data.getData(TestName,"MedicalCare","TargetMaximum");
        var WeightonAdmission = Data.getData(TestName,"MedicalCare","WeightonAdmission");
        


	       exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",DoesPatient,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",MechanismofInjury,exestatus);
         exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus); 
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",DescriptionofInjury,exestatus);
        
         
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",TBSADermal,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",TBSAFullThickness,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Tetanus,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",FirstAid,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_2\")",Current,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Component,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",Evidence,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",ICU,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",Opthalmology,exestatus);
         exestatus = mvObjects.scrollUntilVisible("WPFObject(\"cmdAction_3\")",exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",PainScore,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",RASS,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",CAM,exestatus);
         exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",Airway,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_3\")",Isthere,exestatus);
           
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",AirwayInhalation,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Interventions,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Plan,exestatus);
         exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtNumeric_6\")",exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",Crystalloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",Colloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",Bloods,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightonAdmission,exestatus);

         //Calculate Fluid Reuscitation
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_3\")",exestatus);
         var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
               
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
    
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
		// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
	
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns", "Burns Admission Management");
	// Wait for screen to appear
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
	//exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",DoesPatient, "DoesPatient",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_1\")","DisplayText",MechanismofInjury, "MechanismofInjury",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")","Value",TimeofBurn, "TimeofBurn",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")","Text",DescriptionofInjury, "DescriptionofInjury",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",TBSADermal, "TBSADermal",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",TBSAFullThickness, "TBSAFullThickness",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_2\")","Text",TBSATotal, "TBSATotal",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")","Text",Tetanus, "Tetanus",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",FirstAid, "FirstAid",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_2\")","DisplayText",Current, "Current",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_2\")","Text",Component, "Component",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_3\")","Text",Evidence, "Evidence",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")","Text",ICU, "ICU",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_4\")","Text",Opthalmology, "Opthalmology",exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_6\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")","Text",PainScore, "PainScore",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",RASS, "RASS",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")","Text",CAM, "CAM",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")","Text",Airway, "Airway",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_3\")","DisplayText",Isthere, "Isthere",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")","Text",AirwayInhalation, "AirwayInhalation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")","Text",Interventions, "Interventions",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")","Text",Plan, "Plan",exestatus);
  exestatus = mvObjects.scrollUntilVisible("WPFObject(\"cmdAction_3\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",Crystalloids, "Crystalloids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_3\")","Text",TotalFluids, "TotalFluids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")","Value",Colloids, "Colloids",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")","Value",Bloods, "Bloods",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_4\")","Text",Parkland, "Parkland",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")","Text",ParklandFormula, "ParklandFormula",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_6\")","Text",BalanceFirstEight, "BalanceFirstEight",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_8\")","Text",RateFirstEight, "RateFirstEight",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_10\")","Text",BalanceNextSixteen, "BalanceNextSixteen",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_13\")","Text",RateNextSixteen, "RateNextSixteen",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_14\")","Text",TargetMinimum, "TargetMinimum",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_15\")","Text",TargetMaximum, "TargetMaximum",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value",WeightonAdmission, "WeightonAdmission",exestatus);
  
  
	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
    if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" ReviewBurnsAdmission is successful");
      Log.Checkpoint("ReviewBurnsAdmission","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewBurnsAdmission","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentInsertionCVC
// Desc :Flow to DocumentInsertionCVC
// Owner :Sangiliraja J
// Creation date:Nov 07, 2017
// Update By :Sangiliraja J
// Update date:Dec19,2017
// Update desc:Added the Removal tab details.Added same site forms also on 26/12/2017
// Update By :Mohammad Zeeshan
// Update date:17/June/2019
// Update desc:Removed Patient type and weight - added comments.
//******************************************************************************************//
//******************************************************************************************//
// Flowsheet Validation to be checked

function MvDocumentInsertionCVC(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start documentation InsertionCVC for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

 
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Lines","Central Venous Catheter","CVC 1 Lumen","CVC 1 Lumen - IJ (Left)");
// Wait for screen to appear
// Same Site ICU documentation of Insertion and Removal of the Central Venous Catheter

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
var durel = Data.getData(TestName,"NursingCare","durel");
var duret = Data.getData(TestName,"NursingCare","duret");
var tient = Data.getData(TestName,"NursingCare","tient");
var ight = Data.getData(TestName,"NursingCare","ight");
var hat = Data.getData(TestName,"NursingCare","hat");
var washed = Data.getData(TestName,"NursingCare","washed");
var gown = Data.getData(TestName,"NursingCare","gown");
var drap = Data.getData(TestName,"NursingCare","drap");
var alcohol = Data.getData(TestName,"NursingCare","alcohol");
var ained = Data.getData(TestName,"NursingCare","ained");
var cathe1 = Data.getData(TestName,"NursingCare","cathe1");
var cathe2 = Data.getData(TestName,"NursingCare","cathe2");
var cathe3 = Data.getData(TestName,"NursingCare","cathe3");
var cathe4 = Data.getData(TestName,"NursingCare","cathe4");
var cathe5 = Data.getData(TestName,"NursingCare","cathe5");
var cathe6 = Data.getData(TestName,"NursingCare","cathe6");
var cathe7 = Data.getData(TestName,"NursingCare","cathe7");
var cathe8 = Data.getData(TestName,"NursingCare","cathe8");
var cathe9 = Data.getData(TestName,"NursingCare","cathe9");
var cathe10 = Data.getData(TestName,"NursingCare","cathe10");
var cathe11 = Data.getData(TestName,"NursingCare","cathe11");
var cathe12 = Data.getData(TestName,"NursingCare","cathe12");
var dilation = Data.getData(TestName,"NursingCare","dilation");
var intact = Data.getData(TestName,"NursingCare","intact");
var wire = Data.getData(TestName,"NursingCare","wire");
var che = Data.getData(TestName,"NursingCare","che");
var detai = Data.getData(TestName,"NursingCare","detai");
var tip = Data.getData(TestName,"NursingCare","tip");
var ame = Data.getData(TestName,"NursingCare","ame");
var nation = Data.getData(TestName,"NursingCare","nation");
var age = Data.getData(TestName,"NursingCare","age");
var pager = Data.getData(TestName,"NursingCare","pager");
let CVInsertionSame = new Object();
  
              CVInsertionSame.ProcDate = Data.getData(TestName,"NursingCare","ProcDate")
              DTDay = aqString.substring(CVInsertionSame.ProcDate, 0, 2);
	            DTMonth = aqString.substring(CVInsertionSame.ProcDate, 3, 2);
	            DTYear= aqString.substring(CVInsertionSame.ProcDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",durel,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",duret,exestatus);

//Patient type now coming from admission summary hence commented here.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",tient, "tient",exestatus);  
//Weight is coming from weight and dimensions hence this is commented.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")", "Text",ight, "ight",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",hat,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",washed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",gown,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",drap,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",alcohol,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",ained,exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",cathe1,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",cathe2,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",cathe3,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",cathe4,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",cathe5,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_8\")",cathe6,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",cathe7,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",cathe8,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",cathe9,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_7\")",cathe10,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_8\")",cathe11,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",cathe12,exestatus);

exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_12\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_5\").WPFObject(\"lstTextList_5\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_9\")",dilation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_10\")",intact,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_11\")",wire,exestatus);

exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",che,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",detai,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",tip,exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_7\").WPFObject(\"picFrameIn_7\").WPFObject(\"picTextList_7\").WPFObject(\"lstTextList_6\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",ame,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_10\")",nation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_11\")",age,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_12\")",pager,exestatus);


// The Same Site Removal mechanism process below

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var author = Data.getData(TestName,"NursingCare","author");
var remo = Data.getData(TestName,"NursingCare","remo");
var signa = Data.getData(TestName,"NursingCare","signa");
var Sep = Data.getData(TestName,"NursingCare","Sep");
var culture = Data.getData(TestName,"NursingCare","culture");
var detec = Data.getData(TestName,"NursingCare","detec");
let CVRemoveSame = new Object();
  
                    CVRemoveSame.RemDate = Data.getData(TestName,"NursingCare","RemDate")
                    DTDay = aqString.substring(CVRemoveSame.RemDate, 0, 2);
	                  DTMonth = aqString.substring(CVRemoveSame.RemDate, 3, 2);
	                  DTYear= aqString.substring(CVRemoveSame.RemDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_13\")",author,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_14\")",remo,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_14\")",Sep,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_15\")",culture,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_15\")",signa,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_16\")",detec,exestatus);
// Saving and closing the complete form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 2).WPFObject(\"Button\", \"\", 1)",exestatus);

  
 // ** Fill in the details for Insertion of CVC **
Log.Message("*** enter details for Insertion of CVC ***");
 
var ProcedureLoc  = Data.getData(TestName,"NursingCare","ProcedureLoc");
var Type = Data.getData(TestName,"NursingCare","Type");
var Others = Data.getData(TestName,"NursingCare","Others");
var InsertionSite = Data.getData(TestName,"NursingCare","InsertionSite");
var InsertionSide = Data.getData(TestName,"NursingCare","InsertionSide");
var SiteCheck = Data.getData(TestName,"NursingCare","SiteCheck");
let CentralVenousInsertion = new Object();
  
              CentralVenousInsertion.ProcedureDate = Data.getData(TestName,"NursingCare","ProcedureDate")
              DTDay = aqString.substring(CentralVenousInsertion.ProcedureDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousInsertion.ProcedureDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousInsertion.ProcedureDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ProcedureLoc,exestatus);  
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Type,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")",Others,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",InsertionSite,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",InsertionSide,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")",
"ImdCheckedComboBox",SiteCheck,true,exestatus);

//Details for the CVC record removal
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var Authorised = Data.getData(TestName,"NursingCare","Authorised");
var Reason = Data.getData(TestName,"NursingCare","Reason");
var Local = Data.getData(TestName,"NursingCare","Local");
var Tip = Data.getData(TestName,"NursingCare","Tip");
var Removed = Data.getData(TestName,"NursingCare","Removed");
var Clab = Data.getData(TestName,"NursingCare","Clab");

let CentralVenousRemoval = new Object();
  
              CentralVenousRemoval.RemovalDate = Data.getData(TestName,"NursingCare","RemovalDate")
              DTDay = aqString.substring(CentralVenousRemoval.RemovalDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousRemoval.RemovalDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousRemoval.RemovalDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Authorised,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Reason,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Local,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Tip,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Removed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",Clab,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

// Validation of data in input and output tab
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
 if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Central Venous Catheter");
      Log.Checkpoint("End Central Venous Catheter","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Central Venous Catheter initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentInsertionPICC
// Desc :Flow to DocumentInsertionPICC
// Owner :Mohammad Zeeshan
// Creation date:17/June/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Flowsheet Validation to be checked

function MvDocumentInsertionPICC(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start documentation InsertionCVC for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

 
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Lines","PICC","PICC 1 Lumen - Basilic (Left)");
// Wait for screen to appear
// Same Site ICU documentation of Insertion and Removal of the Central Venous Catheter

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
var durel = Data.getData(TestName,"NursingCare","durel");
var duret = Data.getData(TestName,"NursingCare","duret");
var tient = Data.getData(TestName,"NursingCare","tient");
var ight = Data.getData(TestName,"NursingCare","ight");
var hat = Data.getData(TestName,"NursingCare","hat");
var washed = Data.getData(TestName,"NursingCare","washed");
var gown = Data.getData(TestName,"NursingCare","gown");
var drap = Data.getData(TestName,"NursingCare","drap");
var alcohol = Data.getData(TestName,"NursingCare","alcohol");
var ained = Data.getData(TestName,"NursingCare","ained");
var cathe1 = Data.getData(TestName,"NursingCare","cathe1");
var cathe2 = Data.getData(TestName,"NursingCare","cathe2");
var cathe3 = Data.getData(TestName,"NursingCare","cathe3");
var cathe4 = Data.getData(TestName,"NursingCare","cathe4");
var cathe5 = Data.getData(TestName,"NursingCare","cathe5");
var cathe6 = Data.getData(TestName,"NursingCare","cathe6");
var cathe7 = Data.getData(TestName,"NursingCare","cathe7");
var cathe8 = Data.getData(TestName,"NursingCare","cathe8");
var cathe9 = Data.getData(TestName,"NursingCare","cathe9");
var cathe10 = Data.getData(TestName,"NursingCare","cathe10");
var cathe11 = Data.getData(TestName,"NursingCare","cathe11");
var cathe12 = Data.getData(TestName,"NursingCare","cathe12");
var dilation = Data.getData(TestName,"NursingCare","dilation");
var intact = Data.getData(TestName,"NursingCare","intact");
var wire = Data.getData(TestName,"NursingCare","wire");
var che = Data.getData(TestName,"NursingCare","che");
var detai = Data.getData(TestName,"NursingCare","detai");
var tip = Data.getData(TestName,"NursingCare","tip");
var ame = Data.getData(TestName,"NursingCare","ame");
var nation = Data.getData(TestName,"NursingCare","nation");
var age = Data.getData(TestName,"NursingCare","age");
var pager = Data.getData(TestName,"NursingCare","pager");
let CVInsertionSame = new Object();
  
              CVInsertionSame.ProcDate = Data.getData(TestName,"NursingCare","ProcDate")
              DTDay = aqString.substring(CVInsertionSame.ProcDate, 0, 2);
	            DTMonth = aqString.substring(CVInsertionSame.ProcDate, 3, 2);
	            DTYear= aqString.substring(CVInsertionSame.ProcDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",durel,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",duret,exestatus);

//Patient type now coming from admission summary hence commented here.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",tient, "tient",exestatus);  
//Weight is coming from weight and dimensions hence this is commented.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")", "Text",ight, "ight",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",hat,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",washed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",gown,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",drap,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",alcohol,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",ained,exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",cathe1,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",cathe2,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",cathe3,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",cathe4,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",cathe5,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_8\")",cathe6,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",cathe7,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",cathe8,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",cathe9,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_7\")",cathe10,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_8\")",cathe11,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",cathe12,exestatus);

exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_12\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_5\").WPFObject(\"lstTextList_5\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_9\")",dilation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_10\")",intact,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_11\")",wire,exestatus);

exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",che,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",detai,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",tip,exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_7\").WPFObject(\"picFrameIn_7\").WPFObject(\"picTextList_7\").WPFObject(\"lstTextList_6\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",ame,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_10\")",nation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_11\")",age,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_12\")",pager,exestatus);


// The Same Site Removal mechanism process below

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var author = Data.getData(TestName,"NursingCare","author");
var remo = Data.getData(TestName,"NursingCare","remo");
var signa = Data.getData(TestName,"NursingCare","signa");
var Sep = Data.getData(TestName,"NursingCare","Sep");
var culture = Data.getData(TestName,"NursingCare","culture");
var detec = Data.getData(TestName,"NursingCare","detec");
let CVRemoveSame = new Object();
  
                    CVRemoveSame.RemDate = Data.getData(TestName,"NursingCare","RemDate")
                    DTDay = aqString.substring(CVRemoveSame.RemDate, 0, 2);
	                  DTMonth = aqString.substring(CVRemoveSame.RemDate, 3, 2);
	                  DTYear= aqString.substring(CVRemoveSame.RemDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_13\")",author,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_14\")",remo,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_14\")",Sep,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_15\")",culture,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_15\")",signa,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_16\")",detec,exestatus);
// Saving and closing the complete form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 2).WPFObject(\"Button\", \"\", 1)",exestatus);

  
 // ** Fill in the details for Insertion of CVC **
Log.Message("*** enter details for Insertion of CVC ***");
 
var ProcedureLoc  = Data.getData(TestName,"NursingCare","ProcedureLoc");
var Type = Data.getData(TestName,"NursingCare","Type");
var Others = Data.getData(TestName,"NursingCare","Others");
var InsertionSite = Data.getData(TestName,"NursingCare","InsertionSite");
var InsertionSide = Data.getData(TestName,"NursingCare","InsertionSide");
var SiteCheck = Data.getData(TestName,"NursingCare","SiteCheck");
let CentralVenousInsertion = new Object();
  
              CentralVenousInsertion.ProcedureDate = Data.getData(TestName,"NursingCare","ProcedureDate")
              DTDay = aqString.substring(CentralVenousInsertion.ProcedureDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousInsertion.ProcedureDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousInsertion.ProcedureDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ProcedureLoc,exestatus);  
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Type,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")",Others,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",InsertionSite,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",InsertionSide,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")",
"ImdCheckedComboBox",SiteCheck,exestatus);

//Details for the CVC record removal
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var Authorised = Data.getData(TestName,"NursingCare","Authorised");
var Reason = Data.getData(TestName,"NursingCare","Reason");
var Local = Data.getData(TestName,"NursingCare","Local");
var Tip = Data.getData(TestName,"NursingCare","Tip");
var Removed = Data.getData(TestName,"NursingCare","Removed");
var Clab = Data.getData(TestName,"NursingCare","Clab");

let CentralVenousRemoval = new Object();
  
              CentralVenousRemoval.RemovalDate = Data.getData(TestName,"NursingCare","RemovalDate")
              DTDay = aqString.substring(CentralVenousRemoval.RemovalDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousRemoval.RemovalDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousRemoval.RemovalDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Authorised,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Reason,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Local,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Tip,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Removed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",Clab,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

// Validation of data in input and output tab
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
 if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Central Venous Catheter");
      Log.Checkpoint("End Central Venous Catheter","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Central Venous Catheter initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentDialysisCatherer
// Desc :Flow to MvDocumentDialysisCatherer
// Owner :Mohammad Zeeshan
// Creation date:17/June/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Flowsheet Validation to be checked

function MvDocumentDialysisCatherer(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start documentation InsertionCVC for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

 
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Lines","Dialysis Catheter","Haemodialysis - IJ (Left)");
// Wait for screen to appear
// Same Site ICU documentation of Insertion and Removal of the Central Venous Catheter

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
var durel = Data.getData(TestName,"NursingCare","durel");
var duret = Data.getData(TestName,"NursingCare","duret");
var tient = Data.getData(TestName,"NursingCare","tient");
var ight = Data.getData(TestName,"NursingCare","ight");
var hat = Data.getData(TestName,"NursingCare","hat");
var washed = Data.getData(TestName,"NursingCare","washed");
var gown = Data.getData(TestName,"NursingCare","gown");
var drap = Data.getData(TestName,"NursingCare","drap");
var alcohol = Data.getData(TestName,"NursingCare","alcohol");
var ained = Data.getData(TestName,"NursingCare","ained");
var cathe1 = Data.getData(TestName,"NursingCare","cathe1");
var cathe2 = Data.getData(TestName,"NursingCare","cathe2");
var cathe3 = Data.getData(TestName,"NursingCare","cathe3");
var cathe4 = Data.getData(TestName,"NursingCare","cathe4");
var cathe5 = Data.getData(TestName,"NursingCare","cathe5");
var cathe6 = Data.getData(TestName,"NursingCare","cathe6");
var cathe7 = Data.getData(TestName,"NursingCare","cathe7");
var cathe8 = Data.getData(TestName,"NursingCare","cathe8");
var cathe9 = Data.getData(TestName,"NursingCare","cathe9");
var cathe10 = Data.getData(TestName,"NursingCare","cathe10");
var cathe11 = Data.getData(TestName,"NursingCare","cathe11");
var cathe12 = Data.getData(TestName,"NursingCare","cathe12");
var dilation = Data.getData(TestName,"NursingCare","dilation");
var intact = Data.getData(TestName,"NursingCare","intact");
var wire = Data.getData(TestName,"NursingCare","wire");
var che = Data.getData(TestName,"NursingCare","che");
var detai = Data.getData(TestName,"NursingCare","detai");
var tip = Data.getData(TestName,"NursingCare","tip");
var ame = Data.getData(TestName,"NursingCare","ame");
var nation = Data.getData(TestName,"NursingCare","nation");
var age = Data.getData(TestName,"NursingCare","age");
var pager = Data.getData(TestName,"NursingCare","pager");
let CVInsertionSame = new Object();
  
              CVInsertionSame.ProcDate = Data.getData(TestName,"NursingCare","ProcDate")
              DTDay = aqString.substring(CVInsertionSame.ProcDate, 0, 2);
	            DTMonth = aqString.substring(CVInsertionSame.ProcDate, 3, 2);
	            DTYear= aqString.substring(CVInsertionSame.ProcDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",durel,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",duret,exestatus);

//Patient type now coming from admission summary hence commented here.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",tient, "tient",exestatus);  
//Weight is coming from weight and dimensions hence this is commented.
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")", "Text",ight, "ight",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",hat,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",washed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",gown,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",drap,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",alcohol,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",ained,exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",cathe1,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",cathe2,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",cathe3,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",cathe4,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",cathe5,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_8\")",cathe6,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",cathe7,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",cathe8,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",cathe9,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_7\")",cathe10,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_8\")",cathe11,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",cathe12,exestatus);

exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_12\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_5\").WPFObject(\"lstTextList_5\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_9\")",dilation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_10\")",intact,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_11\")",wire,exestatus);

//This is not a valid case for Dialysis Catheter
//exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",che,exestatus);


exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",detai,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",tip,exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_7\").WPFObject(\"picFrameIn_7\").WPFObject(\"picTextList_6\").WPFObject(\"lstTextList_6\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",ame,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_10\")",nation,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_11\")",age,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_12\")",pager,exestatus);


// The Same Site Removal mechanism process below

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var author = Data.getData(TestName,"NursingCare","author");
var remo = Data.getData(TestName,"NursingCare","remo");
var signa = Data.getData(TestName,"NursingCare","signa");
var Sep = Data.getData(TestName,"NursingCare","Sep");
var culture = Data.getData(TestName,"NursingCare","culture");
var detec = Data.getData(TestName,"NursingCare","detec");
let CVRemoveSame = new Object();
  
                    CVRemoveSame.RemDate = Data.getData(TestName,"NursingCare","RemDate")
                    DTDay = aqString.substring(CVRemoveSame.RemDate, 0, 2);
	                  DTMonth = aqString.substring(CVRemoveSame.RemDate, 3, 2);
	                  DTYear= aqString.substring(CVRemoveSame.RemDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_13\")",author,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_14\")",remo,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_14\")",Sep,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_15\")",culture,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_15\")",signa,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_16\")",detec,exestatus);
// Saving and closing the complete form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 2).WPFObject(\"Button\", \"\", 1)",exestatus);

  
 // ** Fill in the details for Insertion of CVC **
Log.Message("*** enter details for Insertion of CVC ***");
 
var ProcedureLoc  = Data.getData(TestName,"NursingCare","ProcedureLoc");
var Type = Data.getData(TestName,"NursingCare","Type");
var Others = Data.getData(TestName,"NursingCare","Others");
var InsertionSite = Data.getData(TestName,"NursingCare","InsertionSite");
var InsertionSide = Data.getData(TestName,"NursingCare","InsertionSide");
var SiteCheck = Data.getData(TestName,"NursingCare","SiteCheck");
let CentralVenousInsertion = new Object();
  
              CentralVenousInsertion.ProcedureDate = Data.getData(TestName,"NursingCare","ProcedureDate")
              DTDay = aqString.substring(CentralVenousInsertion.ProcedureDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousInsertion.ProcedureDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousInsertion.ProcedureDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ProcedureLoc,exestatus);  
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Type,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")",Others,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",InsertionSite,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",InsertionSide,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")",
"ImdCheckedComboBox",SiteCheck,exestatus);

//Details for the CVC record removal
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

var Authorised = Data.getData(TestName,"NursingCare","Authorised");
var Reason = Data.getData(TestName,"NursingCare","Reason");
var Local = Data.getData(TestName,"NursingCare","Local");
var Tip = Data.getData(TestName,"NursingCare","Tip");
var Removed = Data.getData(TestName,"NursingCare","Removed");
var Clab = Data.getData(TestName,"NursingCare","Clab");

let CentralVenousRemoval = new Object();
  
              CentralVenousRemoval.RemovalDate = Data.getData(TestName,"NursingCare","RemovalDate")
              DTDay = aqString.substring(CentralVenousRemoval.RemovalDate, 0, 2);
	            DTMonth = aqString.substring(CentralVenousRemoval.RemovalDate, 3, 2);
	            DTYear= aqString.substring(CentralVenousRemoval.RemovalDate, 6, 4);

exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Authorised,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Reason,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Local,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Tip,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Removed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",Clab,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

// Validation of data in input and output tab
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
 if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Central Venous Catheter");
      Log.Checkpoint("End Central Venous Catheter","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Central Venous Catheter initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDoubleSignoff
// Desc :Flow to DoubleSignoff Handover
// Owner :Sangiliraja J
// Creation date:Nov 07, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvDoubleSignoff(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start Double Signoff handover for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Double Signoff handover.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Management Plan");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Double Signoff handover form data ***");
	var IDBand = Data.getData(TestName,"NursingCare","IDBand");
	var Nursing = Data.getData(TestName,"NursingCare","Nursing");
	var NurseHandOver = Data.getData(TestName,"NursingCare","NurseHandOver");
	var NurseRec = Data.getData(TestName,"NursingCare","NurseRec");
	 
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",IDBand,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Nursing,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",NurseHandOver,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",NurseRec,exestatus);
         

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Double Signoff Handover Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Management Plan");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text", IDBand, "IDBand",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", Nursing, "Nursing",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", NurseHandOver, "NurseHandOver",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", NurseRec, "NurseRec",exestatus);  
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("DoubleSignoff Handover to is successful");
      Log.Checkpoint("End DoubleSignoff Handover","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DoubleSignoff Handover","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvAccessReferenceMaterial
// Desc :Feature to check the Reference to Access Material
// Owner :Sangiliraja J
// Creation date:Nov 08 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  
  
function MvAccessReferenceMaterial(TestName,exestatus)
{
// Click on Policies and Guidelines
exestatus = mvObjects.selectMenuOption(exestatus,"","Policies & Guidelines");

vProcess = Sys.Process("iMDSoft.Metavision");

//Terminate IE Process
	if (Sys.WaitProcess("iexplore").Exists)
  {
  Sys.Process("iexplore").Terminate();
  
  Log.Message("Terminating Internet Explorer");
   }

//NSW Health Policy
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_2\")",exestatus);

aqUtils.Delay(10000);
          
//Close the Newly opened IE Browser
var Browser=Sys.Browser("iexplore");

Browser.BrowserWindow(0).Close();

//Close the Policies and Guidelines
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
//Access Policies from Prescribe Medications
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\" , \"\", 10)",exestatus);

//Click on Antimicrobial Stewardship/Policies and Guidelines

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\" , \"\", 8)",exestatus);
aqUtils.Delay(10000);

//Click on CIAP

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\" , \"\", 7)",exestatus);
aqUtils.Delay(10000);


//Close the Newly opened IE Browser
var Browser=Sys.Browser("iexplore");

Browser.BrowserWindow(0).Close();
     
 return exestatus;
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewMedicationList
// Desc :Flow to ReviewMedicationList
// Owner :Sangiliraja J
// Creation date:Nov 08, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// ReviewMedicationList 
function MvReviewMedicationList(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start ReviewMedicationList for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");
 
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var drug_quantity=Data.getData(TestName,"Medications","drug_quantity");
var OrderableName=Data.getData(TestName,"Medications","OrderableName");
var Password = Data.getData(TestName,"Navigation","Password");

//ReviewMedicationList
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Enter details in Order form
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);

//Enter Medication Quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",drug_quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

//Click on Medication List button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",6)",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"TextBlock\", \"Paracetamol\", 1)","Text",OrderableName,"OrderableName",exestatus);

aqUtils.Delay(5000);

//Close the Medication List from

iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
 
 iMDSoft_Metavision.WinFormsObject("frmPhysicianOrders").WinFormsObject("FormCaption").Click(1912, 18);

//Sys.Process("iMDSoft.Metavision").WinFormsObject("frmPhysicianOrders").WinFormsObject("FormCaption").click();
  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully ReviewMedicationList");
      Log.Checkpoint("End ReviewMedicationList","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewMedicationList","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentOccupationalTheraphy
// Desc :Feature to Document Occupational Theraphy Progress Note
// Owner :Sangiliraja J
// Creation date:Nov 14 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Document Occupational Theraphy Progress Note
function MvDocumentOccupationalTheraphy(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Occupational Theraphy Progress Note for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Occupational Theraphy Progress Note.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Occupational Therapy Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Occupational Theraphy Progress Note form data ***");
	
        var OccupationalNote = Data.getData(TestName,"OtherCare1","OccupationalNote");
	
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",OccupationalNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Occupational Theraphy Progress Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Occupational Therapy Progress Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",OccupationalNote, "OccupationalNote",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Occupational Theraphy Progress Note",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",OccupationalNote, "OccupationalNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Occupational Theraphy Progress Note to is successful");
      Log.Checkpoint("End Occupational Theraphy Progress Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Occupational Theraphy Progress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentPastoralCare
// Desc :Feature to Document Pastoral Care Progress Note
// Owner :Sangiliraja J
// Creation date:Nov 14 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Document Pastoral Care Progress Note
function MvDocumentPastoralCare(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Pastoral Care Progress Note for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Pastoral Care Progress Note.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Additional Progress Notes", "Pastoral Care Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Pastoral Care Progress Note form data ***");
	
        var PastoralNote = Data.getData(TestName,"OtherCare1","PastoralNote");
	
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",PastoralNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Pastoral Care Progress Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Additional Progress Notes", "Pastoral Care Progress Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",PastoralNote, "PastoralNote",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Occupational Theraphy Progress Note",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",PastoralNote, "PastoralNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Pastoral Care Progress Note to is successful");
      Log.Checkpoint("End Pastoral Care Progress Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Pastoral Care Progress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentVictimofCrime
// Desc :Feature to Document Patient as Victim of Crime
// Owner :Sangiliraja J
// Creation date:Nov 15 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Document Patient as Victim of Crime
function MvDocumentVictimofCrime(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Patient as Victim of Crime for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Patient as Victim of Crime.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","Victim of Crime");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Patient as Victim of Crime form data ***");
	
        var Police = Data.getData(TestName,"OtherCare1","Police");
        var Investigating = Data.getData(TestName,"OtherCare1","Investigating");
        var Comments = Data.getData(TestName,"OtherCare1","Comments");
	
	      exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Police,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Investigating,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Comments,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Document Patient as Victim of Crime Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","Victim of Crime");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Police, "Police",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Investigating, "Investigating",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Comments, "Comments",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)

  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Document Patient as Victim of Crime",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Police, "Police",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Investigating, "Investigating",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Comments, "Comments",exestatus);
  
  
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document Patient as Victim of Crime to is successful");
      Log.Checkpoint("End Document Patient as Victim of Crime","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Patient as Victim of Crime","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentPhysiotherapyProgress
// Desc :Feature to Document Physiotherapy Progress Note
// Owner :Sangiliraja J
// Creation date:Nov 15 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to Document Physiotherapy Progress Note
function MvDocumentPhysiotherapyProgress(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Physiotherapy Progress Note for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Physiotherapy Progress Note.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Physiotherapy Notes", "Physiotherapy Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Physiotherapy Progress Note form data ***");
	
        var PhysiotherapyNote = Data.getData(TestName,"OtherCare1","PhysiotherapyNote");
	
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",PhysiotherapyNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Physiotherapy Progress Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Physiotherapy Notes", "Physiotherapy Progress Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",PhysiotherapyNote, "PhysiotherapyNote",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Physiotherapy Progress Note",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",PhysiotherapyNote, "PhysiotherapyNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document Physiotherapy Progress Note to is successful");
      Log.Checkpoint("End Document Physiotherapy Progress Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Physiotherapy Progress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentPhysiotherapySOAP
// Desc :Feature to Document Physiotherapy SOAP Assessment
// Owner :Sangiliraja J
// Creation date:Nov 16 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Document Physiotherapy SOAP Assessment
function MvDocumentPhysiotherapySOAP(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Physiotherapy SOAP Assessment for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Physiotherapy SOAP Assessment.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes","Physiotherapy Notes","Physiotherapy SOAP Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Physiotherapy SOAP Assessment form data ***");
	
        var Subjective = Data.getData(TestName,"OtherCare1","Subjective");
        var Objective = Data.getData(TestName,"OtherCare1","Objective");
        var Assessment = Data.getData(TestName,"OtherCare1","Assessment");
        var Plan = Data.getData(TestName,"OtherCare1","Plan");
	
	      exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Subjective,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Objective,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Assessment,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Plan,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Document Physiotherapy SOAP Assessment Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Physiotherapy Notes","Physiotherapy SOAP Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Subjective, "Subjective",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Objective, "Objective",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Assessment, "Assessment",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Plan, "Plan",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)

  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Document Physiotherapy SOAP Assessment",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Subjective, "Subjective",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Objective, "Objective",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Assessment, "Assessment",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Plan, "Plan",exestatus);
  
  
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document Physiotherapy SOAP Assessment to is successful");
      Log.Checkpoint("End Document Physiotherapy SOAP Assessment","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Physiotherapy SOAP Assessment","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentResearchProgress
// Desc :Feature to Document Research Progress Note
// Owner :Sangiliraja J
// Creation date:Nov 16 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to Document Research Progress Note
function MvDocumentResearchProgress(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Research Progress Note for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Research Progress Note.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Nursing Notes", "ICU","Research Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Research Progress Note form data ***");
	
        var ResearchNote = Data.getData(TestName,"OtherCare1","ResearchNote");
	
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ResearchNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Research Progress Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Medical Notes", "ICU", "Research Progress Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ResearchNote, "ResearchNote",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Research Progress Note",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ResearchNote, "ResearchNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document Research Progress Note to is successful");
      Log.Checkpoint("End Document Research Progress Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Research Progress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentResuscitation
// Desc :Feature to Document Resuscitation Plan
// Owner :Sangiliraja J
// Creation date:Nov 16 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature to Document Resuscitation Plan
function MvDocumentResuscitation(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Resuscitation Plan for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Resuscitation Plan.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"End of Life","Resuscitation Plan Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Document Resuscitation Plan form data ***");
	
        var ResusPlan = Data.getData(TestName,"OtherCare1","ResusPlan");
        var Organ = Data.getData(TestName,"OtherCare1","Organ");
	      var ResusNote = Data.getData(TestName,"OtherCare1","ResusNote");

     exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",ResusPlan,exestatus);
     exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Organ,exestatus);
     exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ResusNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Document Resuscitation Plan Note Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"End of Life","Resuscitation Plan Note");
	// Wait for screen to appear
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",ResusPlan, "ResusPlan",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",Organ, "Organ",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ResusNote, "ResusNote",exestatus);
  	// close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Resuscitation Plan",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",ResusPlan, "ResusPlan",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",Organ, "Organ",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ResusNote, "ResusNote",exestatus);
  
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document Resuscitation Plan to is successful");
      Log.Checkpoint("End Document Resuscitation Plan","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Resuscitation Plan","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentClinicalEvent
// Desc :Feature to Document Clinical Event
// Owner :Sangiliraja J
// Creation date:Nov 17 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to Document Clinical Event
function MvDocumentClinicalEvent(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Clinical Event for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Clinical Event.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Angiogram");
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Document Clinical Event form data ***");
	
        //var Commen = Data.getData(TestName,"OtherCare","Commen");
        
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Angio suggested for the Cardio analysis" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Allergic/Adverse Reaction");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Allergic and Adverse reactions detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Bronchial Lavage");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Bronchial Lavage detected in lungs" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Bronchoscopy");
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Bronchoscopy details ***");
	
        var Consent = Data.getData(TestName,"OtherCare1","Consent");
        var Bloods = Data.getData(TestName,"OtherCare1","Bloods");
        var Fasting = Data.getData(TestName,"OtherCare1","Fasting");
        var Timeout = Data.getData(TestName,"OtherCare1","Timeout");
        var Indication = Data.getData(TestName,"OtherCare1","Indication");
        var BronchoscopeCleaned = Data.getData(TestName,"OtherCare1","BronchoscopeCleaned");
        var BronchoscopeSter = Data.getData(TestName,"OtherCare1","BronchoscopeSter");
        var Type = Data.getData(TestName,"OtherCare1","Type");
        var Proceduralist = Data.getData(TestName,"OtherCare1","Proceduralist");
        var Assistant = Data.getData(TestName,"OtherCare1","Assistant");
        var Supervisor = Data.getData(TestName,"OtherCare1","Supervisor");
        var Comme = Data.getData(TestName,"OtherCare1","Comme");
        var ET = Data.getData(TestName,"OtherCare1","ET");
        var Bite = Data.getData(TestName,"OtherCare1","Bite");
        var Air = Data.getData(TestName,"OtherCare1","Air");
        var Airw = Data.getData(TestName,"OtherCare1","Airw");
        var Mask = Data.getData(TestName,"OtherCare1","Mask");
        var Descrip = Data.getData(TestName,"OtherCare1","Descrip");
        var BAL = Data.getData(TestName,"OtherCare1","BAL");
        var BALInv = Data.getData(TestName,"OtherCare1","BALInv");
        var SpAmount = Data.getData(TestName,"OtherCare1","SpAmount");
        var SpColour = Data.getData(TestName,"OtherCare1","SpColour");
        var SConsistency = Data.getData(TestName,"OtherCare1","SConsistency");
        var Biopsy = Data.getData(TestName,"OtherCare1","Biopsy");
        var Sit = Data.getData(TestName,"OtherCare1","Sit");

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Bronchoscopy done for the patient" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdAttachedForm\")",exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Consent,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",Bloods,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Fasting,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Timeout,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 13)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 14)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 15)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 12)",Indication,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 2))",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",BronchoscopeCleaned,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",BronchoscopeSter,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Proceduralist,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Assistant,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Supervisor,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Comme,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",ET,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",Bite,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Air,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",Airw,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",Mask,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 3))",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Descrip,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",BAL,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",SpAmount,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_5\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox",SpColour,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_7\").WPFObject(\"cboTextCombo_7\")",SConsistency,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_7\").WPFObject(\"cboTextCombo_7\")","ImdComboBox",SConsistency,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",Biopsy,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",Sit,exestatus);

 //Saving and Closing the mandatory form 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Cardiac Arrest");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardiac Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Cardiopulmonary Arrest");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardiopulmonary Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Cardioversion");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardioversion detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);	


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Chest Reopening");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Chest Reopening detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);	

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Clinical Event (Other - Once)");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Clinical Event(Other - Once)" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Clinical Event (Other - Timed)");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Clinical Event(Other - Timed)" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "CT Scan");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "CT Scan planned in Lab" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Drain, Removal of (Unplanned)");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Drain planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Echocardiogram");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Echocardiogram planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "EEG");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "EEG planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Endoscopy");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Endoscopy planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Extubation (Unplanned)");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Extubation (Unplanned) planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Haemorrhage");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Haemorrhage detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Line, Removal of (Unplanned)");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Line detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);



exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Lumbar Puncture");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Lumbar Puncture detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "MRI");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "MRI Planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Patient Fall");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient Fall" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Pericardiocentesis");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pericardiocentesis detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Pneumothorax");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pneumothorax detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Pulmonary Embolus");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pulmonary Embolus detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Respiratory Arrest");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Respiratory Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Seizure");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Seizure detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Sepsis Confirmed");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Sepsis Confirmed and detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Clinical Events", "Surgery");
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Surgery Planned in CCU" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);




	
	//exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\",\"\")",Commen,exestatus);
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Document Clinical Event to is successful");
      Log.Checkpoint("End Document Clinical Event","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Clinical Event","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//Feature function to document Clinical event - change to a single menu item
function MvDocumentClinicalEventNew(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Clinical Event for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Clinical Event.";
      aqUtils.Delay (ms, HelpStr);
  
		// ** Fill in the Patient details
	Log.Message("*** enter Document Clinical Event form data ***");
	
        //var Commen = Data.getData(TestName,"OtherCare","Commen");
        
//Select Angiogramas the clinical event from the drop down
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Angiogram",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Angio suggested for the Cardio analysis" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Allergic/Adverse Reaction as the clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Allergic/Adverse Reaction",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Allergic and Adverse reactions detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Bronchial Lavage as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");

exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Bronchial Lavage",exestatus);	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Bronchial Lavage detected in lungs" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Bronchoscopy as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Bronchoscopy",exestatus);
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Bronchoscopy details ***");
	
        var Consent = Data.getData(TestName,"OtherCare1","Consent");
        var Bloods = Data.getData(TestName,"OtherCare1","Bloods");
        var Fasting = Data.getData(TestName,"OtherCare1","Fasting");
        var Timeout = Data.getData(TestName,"OtherCare1","Timeout");
        var Indication = Data.getData(TestName,"OtherCare1","Indication");
        var BronchoscopeCleaned = Data.getData(TestName,"OtherCare1","BronchoscopeCleaned");
        var BronchoscopeSter = Data.getData(TestName,"OtherCare1","BronchoscopeSter");
        var Type = Data.getData(TestName,"OtherCare1","Type");
        var Proceduralist = Data.getData(TestName,"OtherCare1","Proceduralist");
        var Assistant = Data.getData(TestName,"OtherCare1","Assistant");
        var Supervisor = Data.getData(TestName,"OtherCare1","Supervisor");
        var Comme = Data.getData(TestName,"OtherCare1","Comme");
        var ET = Data.getData(TestName,"OtherCare1","ET");
        var Bite = Data.getData(TestName,"OtherCare1","Bite");
        var Air = Data.getData(TestName,"OtherCare1","Air");
        var Airw = Data.getData(TestName,"OtherCare1","Airw");
        var Mask = Data.getData(TestName,"OtherCare1","Mask");
        var Descrip = Data.getData(TestName,"OtherCare1","Descrip");
        var BAL = Data.getData(TestName,"OtherCare1","BAL");
        var BALInv = Data.getData(TestName,"OtherCare1","BALInv");
        var SpAmount = Data.getData(TestName,"OtherCare1","SpAmount");
        var SpColour = Data.getData(TestName,"OtherCare1","SpColour");
        var SConsistency = Data.getData(TestName,"OtherCare1","SConsistency");
        var Biopsy = Data.getData(TestName,"OtherCare1","Biopsy");
        var Sit = Data.getData(TestName,"OtherCare1","Sit");

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Bronchoscopy done for the patient" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdAttachedForm\")",exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Consent,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",Bloods,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Fasting,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Timeout,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 13)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 14)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"ListBoxItem\", \"\", 15)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 12)",Indication,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 2))",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",BronchoscopeCleaned,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",BronchoscopeSter,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Proceduralist,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Assistant,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Supervisor,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Comme,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",ET,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",Bite,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Air,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",Airw,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",Mask,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 3))",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Descrip,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",BAL,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_4\").WPFObject(\"lstTextList_4\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",SpAmount,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_5\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox",SpColour,exestatus, true);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_7\").WPFObject(\"cboTextCombo_7\")",SConsistency,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_7\").WPFObject(\"cboTextCombo_7\")","ImdComboBox",SConsistency,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",Biopsy,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",Sit,exestatus);

 //Saving and Closing the mandatory form 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	

//Add Cardiac Arrest as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Cardiac Arrest",exestatus);

	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardiac Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Cardiopulmonary Arrest as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Cardiopulmonary Arrest",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardiopulmonary Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Cardioversion as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Cardioversion",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Cardioversion detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);	

//Add Chest Reopening as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Chest Reopening",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Chest Reopening detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);	

//Add Clinical Event (Other - Once) as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Clinical Event (Other - Once)",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Clinical Event(Other - Once)" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Clinical Event (Other - Timed) as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Clinical Event (Other - Timed)",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Clinical Event(Other - Timed)" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add CT Scan as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "CT Scan",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "CT Scan planned in Lab" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Drain, Removal of (Unplanned) as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Drain, Removal of (Unplanned)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Drain planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Echocardiogram as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Echocardiogram",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Echocardiogram planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add EEG as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "EEG",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "EEG planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Endoscopy as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Endoscopy",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Endoscopy planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Extubation (Unplanned) as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Extubation (Unplanned)",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Extubation (Unplanned) planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Haemorrhage as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Haemorrhage",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Haemorrhage detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Line, Removal of (Unplanned) as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Line, Removal of (Unplanned)",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Line detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Add Lumbar Puncture as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Lumbar Puncture",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Lumbar Puncture detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add MRI as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "MRI",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "MRI Planned" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Patient Fall as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Patient Fall",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient Fall" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Pericardiocentesis as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Pericardiocentesis",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pericardiocentesis detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Pneumothorax as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Pneumothorax",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pneumothorax detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Pulmonary Embolus as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Pulmonary Embolus",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Pulmonary Embolus detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Respiratory Arrest as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Respiratory Arrest",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Respiratory Arrest detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Seizure as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Seizure",exestatus);
	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Seizure detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Sepsis Confirmed as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Sepsis Confirmed",exestatus);

	
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Sepsis Confirmed and detected" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

//Add Surgery as clinical event
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Surgery",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Surgery Planned in CCU" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
	//exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\",\"\")",Commen,exestatus);
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Document Clinical Event to is successful");
      Log.Checkpoint("End Document Clinical Event","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Document Clinical Event","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}


//******************************************************************************************//
//******************************************************************************************// 

//******************************************************************************************//
//******************************************************************************************//
// Name :MvAddSpecificClinicalEvent
// Desc :Feature to add a specific clinical event
// Owner :Mohammad Zeeshan
// Creation date:21/06/2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  
function MvAddSpecificClinicalEvent(TestName, clinicalEventType, exestatus)
{
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) 
    {
        var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
        Log.Checkpoint("Start Document Clinical Event for "+tcDesc ,"The flow is started");
        Log.Checkpoint("Add the event " + clinicalEventType);
        
        //Start of the feature 	
      	vProcess = Sys.Process("iMDSoft.Metavision");

      	var ms = 6000;
        var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Clinical Event.";
        aqUtils.Delay (ms, HelpStr);
  
     		Log.Message("*** Click Add clinical Events ***");
	
        exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
        
        //Add desired clinical event
        exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", clinicalEventType, exestatus);
        
        //Save it 
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
        
        //Verify it on clinical overview
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
        if (equal(exestatus,true)) 
        {
          Log.Checkpoint(" successfully added clinical event");
          Log.Checkpoint("add clinical event is completed");
        }        
        else 
        {
          Log.Message("Skipped add clinical event","The feature is skipped since the execution status is set as '"+exestatus+"'");   
        }        
    }
    return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewReferral
// Desc :Feature to Review or Update Referral Request
// Owner :Sangiliraja J
// Creation date:Nov 17 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created Review or Update Referral Request
function MvReviewReferral(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Review or Update Referral Request Form for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To add Review or Update Referral Request.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Nursing Notes", "Referral/Consultation Form");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Referral/Consultation form data ***");
	var ClinicalTeam = Data.getData(TestName,"OtherCare1","ClinicalTeam");
	var ClinicalTeamContact = Data.getData(TestName,"OtherCare1","ClinicalTeamContact");
	var Ref_ClinicianName = Data.getData(TestName,"OtherCare1","Ref_ClinicianName");
	var Refd_ClinicianName = Data.getData(TestName,"OtherCare1","Refd_ClinicianName");
	var Rsn_Consul = Data.getData(TestName,"OtherCare1","Rsn_Consul");
	var Prov_Diagnosis = Data.getData(TestName,"OtherCare1","Prov_Diagnosis");
	var Summary = Data.getData(TestName,"OtherCare1","Summary");
        var Obj_Consul = Data.getData(TestName,"OtherCare1","Obj_Consul");
        var Consul_Rep = Data.getData(TestName,"OtherCare1","Consul_Rep");
        var As_Req = Data.getData(TestName,"OtherCare1","As_Req");
    
  exestatus= mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_1\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "WPFControlText", "ICU",exestatus);
  exestatus= mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cboTextComboMulti_1\")",exestatus);
  
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",ClinicalTeamContact,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Ref_ClinicianName,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Refd_ClinicianName,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Rsn_Consul,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Prov_Diagnosis,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Summary,exestatus);
         //uncomment it back
         //exestatus = mvObjects.objectFocusClick(vProcess, "Name","WPFObject(\"picTextList_2\")",exestatus);
      // exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 1)",Obj_Consul,exestatus);
      
       set = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Advise on management ",exestatus);
       exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",Consul_Rep,exestatus);
       //exestatus = mvObjects.objectFocusClick(vProcess, "Name","WPFObject(\"picTextList_3\")",exestatus);
       //exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"ListBoxItem\", \"\", 1)",As_Req,exestatus);
       
        set = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")","Advise on management ",true);
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Referral/Consultation Form Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
        
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
        

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);

  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Medical Notes", "Referral/Consultation Form");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  //uncomment below line
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", ClinicalTeam, "ClinicalTeam",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", ClinicalTeamContact, "ClinicalTeamContact",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Ref_ClinicianName, "Ref_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Refd_ClinicianName, "Refd_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Rsn_Consul, "Rsn_Consul",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", Prov_Diagnosis, "Prov_Diagnosis",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", Summary, "Summary",exestatus);
 //uncomment below line
 //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", Obj_Consul, "Obj_Consul",exestatus);
 exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"txtFreeText_8\")", "Text", Consul_Rep, "Consul_Rep",exestatus);
 //exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"ListBoxItem\", \"\", 1)", "Text", As_Req, "As_Req",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
 // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Referral/Consultation Form",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text", ClinicalTeamContact, "ClinicalTeamContact",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text", Ref_ClinicianName, "Ref_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text", Refd_ClinicianName, "Refd_ClinicianName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text", Rsn_Consul, "Rsn_Consul",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text", Prov_Diagnosis, "Prov_Diagnosis",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text", Summary, "Summary",exestatus);
 //uncomment below line
 //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"ListBoxItem\", \"\", 1)", "Text", Obj_Consul, "Obj_Consul",exestatus);
 exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"txtFreeText_8\")", "Text", Consul_Rep, "Consul_Rep",exestatus);
 //exestatus = mvObjects.verifyObjectProperty(vProcess, "Name" ,"WPFObject(\"ListBoxItem\", \"\", 1)", "Text", As_Req, "As_Req",exestatus);
  
	// close the form 
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
    
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Review or Update Referral Request Form to is successful");
      Log.Checkpoint("End Review or Update Referral Request Form","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Review or Update Referral Request Form","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewStatus
// Desc :Feature to Review Status Bar Data
// Owner :Sangiliraja J
// Creation date:Nov 17 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Review Status Bar Data
function MvReviewStatus(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Review Status Bar Data for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Review Status Bar Data.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Research Studies");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Review Status Bar Data form data ***");
	
        var ResearchCurrently = Data.getData(TestName,"OtherCare1","ResearchCurrently");
        var ResearchExcluded = Data.getData(TestName,"OtherCare1","ResearchExcluded");
        var UserName = Data.getData(TestName,"OtherCare1","UserName");
        var Location = Data.getData(TestName,"OtherCare1","Location");
        var Stat = Data.getData(TestName,"OtherCare1","Stat");
        var Research = Data.getData(TestName,"OtherCare1","Research");
        
	      exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ResearchCurrently,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",ResearchExcluded,exestatus);
         
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("Document Review Status Bar Data Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName","*WPFObject(\"ContentPresenter\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"txtParamValue\")" ,"Text", UserName, "Active user",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"ContentPresenter\", \"\", 3).WPFObject(\"Border\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"txtParamValue\")","Text",Location, "Current Patient Location",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName","*WPFObject(\"ContentPresenter\", \"\", 4).WPFObject(\"Border\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"txtParamValue\")","Text",Stat, "Status",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"ContentPresenter\", \"\", 6).WPFObject(\"Border\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"txtParamValue\")","Text",Research, "Research Studies",exestatus);

aqUtils.Delay(1000);

        

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Review Status Bar Data to is successful");
      Log.Checkpoint("End Review Status Bar Data","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Review Status Bar Data","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvPlacePatient
// Desc :Feature to Place Patient in Transport
// Owner :Sangiliraja J
// Creation date:Nov 20 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to Place Patient in Transport
function MvPlacePatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Document Place Patient in Transport for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Document Place Patient in Transport.";
      aqUtils.Delay (ms, HelpStr);

//Select Transport within the Hospital (Adult|Paediatric) the clinical event from the drop down
exestatus = mvObjects.selectMenuOption(exestatus,"Add Clinical Events");
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"lstEvents\")", "Transport within the Hospital (Adult|Paediatric)",exestatus);

	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Document Place Patient in Transport data ***");
	      var EscortingN = Data.getData(TestName,"OtherCare1","EscortingN");
        var EscortingM = Data.getData(TestName,"OtherCare1","EscortingM");
        var Transport = Data.getData(TestName,"OtherCare1","Transport");
        var MRI = Data.getData(TestName,"OtherCare1","MRI");
        
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Transporting the patient to CCU" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdAttachedForm\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",EscortingN,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",EscortingM,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Transport,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkBoolean_14\")",MRI,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_14\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
	
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Document Place Patient in Transport is successful");
      Log.Checkpoint("End Place Patient in Transport","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped DocumentPlace Patient in Transport","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************// 


//******************************************************************************************//
//******************************************************************************************//
// Name :MvValidateCorrectPatient
// Desc :Feature to Validate Correct Patient
// Owner :Sangiliraja J
// Creation date:Nov 20 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Validate Correct Patient
function MvValidateCorrectPatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Validate Correct Patient for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Validate Correct Patient.";
      aqUtils.Delay (ms, HelpStr);
       exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient Demographics");
        var GivenName = Data.getData(TestName,"Patient","FirstName");
        var FamilyName = Data.getData(TestName,"Patient","LastName");
        
  
	
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Validate Correct Patientform data ***");
	
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_2\")", "Text", GivenName, "GivenName",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_3\")", "Text", FamilyName, "FamilyName",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
        
aqUtils.Delay(1000);

        

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Validate Correct Patient to is successful");
      Log.Checkpoint("End Validate Correct Patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Validate Correct Patient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//


// Name :MvPrescriberDetails
// Desc :Feature to validate prescriber details in order log and order list view
// Owner :Satheeshkumar C
// Creation date:20 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvPrescriberDetails(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Feature to validate prescriber details in order log and order list view"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity=Data.getData(TestName,"Medications","quantity");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

// final validation is pending- Flowsheet
// Validate the details in order log and order list view


  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully validated prescriber details in order log and order list view");
      Log.Checkpoint("End of Feature to validate prescriber details in order log and order list view","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped feature to validate prescriber details in order log and order list view","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvAdministerInfusedMedication
// Desc :Feature to administer infused medication  
// Owner :Satheeshkumar C
// Creation date:20 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvAdministerInfusedMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of administer infused medication "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//var Diluent_Drug = Data.getData(TestName,"Medications","Diluent_Drug")
//var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant")

//Administer Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Select the Diluent button
//exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 7).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

// Enter the diluent and quantity
//exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"TextEdit\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"FindComboBoxEdit\")",5,2,Diluent_Drug,2,exestatus);
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);

// final validation is pending- Flowsheet
// administer infused medication in flow sheet

// Validation in titrate medication tab

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,12",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully administered infused medication for a patient");
      Log.Checkpoint("End of administer infused medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped administer infused medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvUretericDrain
// Desc :Feature to initiate and review the patient's current drains
// Owner :Satheeshkumar C
// Creation date:23-Oct-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvUretericDrain(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Ureteric Drain initiation and review for "+tcDesc ,"The flow is started");
	
//Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

// To select the Ureteric drain from medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Drains","Genitourinary","Ureteric Drain (Left)");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);
    
// Fill in the details for Ureteric drain
Log.Message("***Enter details for Ureteric Drain***");
	
var Size = Data.getData(TestName,"MedicalCare","Size");
var DrinageDescription = Data.getData(TestName,"MedicalCare","DrinageDescription"); 
  
  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",Size,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",DrinageDescription,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Dressing intact",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")","Clean",exestatus);
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lstTextList_2\")", 120,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")","Assessed",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")","Bag secure",exestatus);


  
// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Pericardial Drain Saved Time: "+ timeSavedValue);
  
// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
   exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdSave\")", 120,exestatus);
    
// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
// Flow sheet validation and entering data's into flow sheet manually pending   
   
   
   // var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully initiated and Reviewed patient Drain");
      Log.Checkpoint("End of reviewing patient drains","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped drain initiation and review for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewNutrition
// Desc :Feature to administer and review nutrition medication in Administer & titrate medication tab   
// Owner :Satheeshkumar C
// Creation date:23 Oct 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvReviewNutrition(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of administer and review nutrition medication in Administer & titrate medication tab for "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//Administer Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

// Final validation is pending- Flowsheet
// Administer nutrition medication in flow sheet

// Validation in titrate medication tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,12",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully administered and reviewed nutrition medication in Administer & titrate medication tab");
      Log.Checkpoint("End of administer and review nutrition medication in Administer & titrate medication tab ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped administer and review nutrition medication in Administer & titrate medication tab","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//



//******************************************************************************************//
//******************************************************************************************//
// Name :MvSafetyCheckList
// Desc :Feature to document safety checklist
// Owner :Satheeshkumar C
// Creation date:24-Oct-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvSafetyCheckList(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of documenting safety check list for "+tcDesc ,"The flow is started");
	
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


// To select the safety check list from nursing menu
 exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Safety Checklist");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
    
// Fill in the details for Safety check list 
Log.Message("***Enter details for Safety check list***");
	
var SelfInfla = Data.getData(TestName,"NursingCare","SelfInfla");
var PeepValve = Data.getData(TestName,"NursingCare","PeepValve"); 
var Yankaure = Data.getData(TestName,"NursingCare","Yankaure");
var OropharyngealAirway = Data.getData(TestName,"NursingCare","OropharyngealAirway");
var PortableOxygen = Data.getData(TestName,"NursingCare","PortableOxygen");
var VentilatorSetting = Data.getData(TestName,"NursingCare","VentilatorSetting");
var MonitorAlarams = Data.getData(TestName,"NursingCare","MonitorAlarams");
var Transducerlevell = Data.getData(TestName,"NursingCare","Transducerlevell");
var IvEmergency = Data.getData(TestName,"NursingCare","IvEmergency");
var SafetyCheck = Data.getData(TestName,"NursingCare","SafetyCheck");
var Tracheostomy = Data.getData(TestName,"NursingCare","Tracheostomy");
  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",SelfInfla,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",PeepValve,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",Yankaure,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",OropharyngealAirway,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",PortableOxygen,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",OropharyngealAirway,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_7\")",PortableOxygen,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_8\")",Tracheostomy,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",VentilatorSetting,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",MonitorAlarams,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",Transducerlevell,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",IvEmergency,exestatus);

  
// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
    
// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
  
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Safety Checklist");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSession\")",exestatus);
  //click No - so that the data is not saved
  exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"No\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documentted values
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",VentilatorSetting, "VentilatorSetting",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",MonitorAlarams, "MonitorAlarams",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",Transducerlevell, "Transducerlevell",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",IvEmergency, "IvEmergency",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",SafetyCheck, "SafetyCheck",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

   
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented safety checklist for a patient");
      Log.Checkpoint("End of documenting safety checklist for a patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped documenting safety checklist for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvArterialCatheter
// Desc :Feature to initate line and review of drains, tube and lines in input/output tab
// Owner :Satheeshkumar C
// Creation date:24-Oct-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvArterialCatheter(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of initiation of lines and review of drains, tube and lines in input/output tab "+tcDesc ,"The flow is started");
	
//Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

// To select the Arterial - Radial (Left) from medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Lines","Arterial Catheter","Arterial - Radial (Left)");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);
    
// Fill in the details for Arterial - Radial (Left)
Log.Message("***Enter details for Arterial - Radial (Left)***");	

//var Duration = Data.getData(TestName,"NursingCare","Duration");  
//aqUtils.Delay(10000);
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"SpinEdit\", \"\", 1)",Duration,exestatus); 

  
// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"dateTimeControl\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Saved Time: "+ timeSavedValue);
  
// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
   //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Validate\", 1)",exestatus);   
    
// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   
// Flow sheet validation and entering data's into flow sheet manually pending for lines, drain & tube   
   
   

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully initiated and Reviewed patient current lines, drain & tube");
      Log.Checkpoint("End of initiating and Reviewing patient's current lines, drain & tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped initiating and Reviewing patient's current lines, drain & tube","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentFasthug
// Desc :Feature to document FASTHUG for a patient
// Owner :Satheeshkumar C
// Creation date:06-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDocumentFasthug(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of documenting FASTHUG for "+tcDesc ,"The flow is started");
	
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

// To select the FASTHUG from nursing menu
 exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "FASTHUG");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
    
// Fill in the details for FASTHUG 
Log.Message("***Enter details for FASTHUG***");
	
var Feeding = Data.getData(TestName,"NursingCare","Feeding");
var Analgesia = Data.getData(TestName,"NursingCare","Analgesia"); 
var Sedation = Data.getData(TestName,"NursingCare","Sedation");
var ThromboPhro = Data.getData(TestName,"NursingCare","ThromboPhro");
var HeadofBed = Data.getData(TestName,"NursingCare","HeadofBed");
var UlcerPro = Data.getData(TestName,"NursingCare","UlcerPro");
var GlucoseCont = Data.getData(TestName,"NursingCare","GlucoseCont");
var Comments = Data.getData(TestName,"NursingCare","Comments");
var Assesment = Data.getData(TestName,"NursingCare","Assesment");

  
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Feeding,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Comments,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Analgesia,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",Sedation,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",ThromboPhro,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",HeadofBed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",UlcerPro,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",GlucoseCont,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Comments,exestatus);


  
// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
    
// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "FASTHUG");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
    }
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documentted values
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",Feeding, "Feeding",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",Analgesia, "Analgesia",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",Sedation, "Sedation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",ThromboPhro, "ThromboPhro",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",HeadofBed, "HeadofBed",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",UlcerPro, "UlcerPro",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",GlucoseCont,"GlucoseCont",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",Comments,"Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",Assesment,"Assesment",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

   
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented FASTHUG status for a patient");
      Log.Checkpoint("End of documenting FASTHUG for a patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped documenting FASTHUG status for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvNursingManagent
// Desc :Feature to document and update Nursing Managent plan for a patient
// Owner :Satheeshkumar C
// Creation date:06-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvNursingManagent(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of documenting and updating Nursing Managent plan for "+tcDesc ,"The flow is started");
	
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

// To select the Nursing Managent plan from nursing menu
 exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Management Plan");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"chkTrue_1\")", 120,exestatus);
    
// Fill in the details for Nursing Managent plan 
Log.Message("***Enter details for Nursing Managent plan***");
	
var IdCardPresent = Data.getData(TestName,"NursingCare","IdCardPresent");
var NurseMana = Data.getData(TestName,"NursingCare","NurseMana"); 
var NurseHand = Data.getData(TestName,"NursingCare","NurseHand");
var NurseReci = Data.getData(TestName,"NursingCare","NurseReci");
var UpdateNurseMana = Data.getData(TestName,"NursingCare","UpdateNurseMana");


  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",IdCardPresent,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",NurseMana,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",NurseHand,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",NurseReci,exestatus);


// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
    
// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Management Plan");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documentted values
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",NurseMana,"NurseMana",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",NurseHand,"NurseHand",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",NurseReci,"NurseReci",exestatus);

  // To update the nursing management plan
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",UpdateNurseMana,exestatus);
   
	// Save and close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

   
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented and updated Nursing Managent plan for a patient");
      Log.Checkpoint("End of documenting Nursing Managent plan for a patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped documenting Nursing Managent plan for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVNursingProgressNote
// Desc :Feature to document the Nursing Progress Note 
// Owner :Satheeshkumar C
// Creation date:06-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVNursingProgressNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of documenting Nursing progress note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	 // To select the nursing progress note  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Nursing Notes","ICU","Nursing Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		// ** Fill in the Nursing progress note details
	Log.Message("*** Enter Nursing progress note ***");
  
	var NursingProgressNote = Data.getData(TestName,"HandOver","NursingProgressNote");

	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",NursingProgressNote,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Guardianship order Saved Time: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Nursing progress note Saved Time: "+ MsgValue);
  
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);

  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  

  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Nursing Notes","ICU","Nursing Progress Note");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", NursingProgressNote, "NursingProgressNote",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
 
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Nursing Progress Note",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text", NursingProgressNote, "NursingProgressNote",exestatus);
  
  // close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

 
  
  

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented nursing progress note");
      Log.Checkpoint("End nursing progress note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped nursing progress note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentFoodChart
// Desc :Feature to document food chart for a patient
// Owner :Satheeshkumar C
// Creation date:07-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDocumentFoodChart(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of documenting food chart for "+tcDesc ,"The flow is started");
	
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

// To select the food chart from nursing menu
 exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations","Food Chart");
	
 // Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
    
// Fill in the details for Food Chart 
Log.Message("***Enter details for Food Chart***");
	
var DietType = Data.getData(TestName,"NursingCare","DietType");
var FreshJu = Data.getData(TestName,"NursingCare","FreshJu"); 
var Milk= Data.getData(TestName,"NursingCare","Milk");
var CookOpt= Data.getData(TestName,"NursingCare","CookOpt");
var TypCooOpt = Data.getData(TestName,"NursingCare","TypCooOpt");
var Cerea = Data.getData(TestName,"NursingCare","Cerea");
var Bread = Data.getData(TestName,"NursingCare","Bread");
var NoSlic= Data.getData(TestName,"NursingCare","NoSlic");
var Yoghu= Data.getData(TestName,"NursingCare","Yoghu");
var Fruit= Data.getData(TestName,"NursingCare","Fruit");
var TeaOrCoff= Data.getData(TestName,"NursingCare","TeaOrCoff");
var SuppleDrnk= Data.getData(TestName,"NursingCare","SuppleDrnk");
var Other= Data.getData(TestName,"NursingCare","Other");
var Assistance= Data.getData(TestName,"NursingCare","Assistance");
var LessThan30= Data.getData(TestName,"NursingCare","LessThan30");
var MidTeaCoff= Data.getData(TestName,"NursingCare","MidTeaCoff");
var MidSupldrnk= Data.getData(TestName,"NursingCare","MidSupldrnk");
var MidSnack= Data.getData(TestName,"NursingCare","MidSnack");
var MidAssistnce= Data.getData(TestName,"NursingCare","MidAssistnce");
var Vegitab= Data.getData(TestName,"NursingCare","Vegitab");
var Sandwi= Data.getData(TestName,"NursingCare","Sandwi");



exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",DietType,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",FreshJu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Milk,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",CookOpt,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",TypCooOpt,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",Cerea,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",Bread,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",NoSlic,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",Yoghu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",Fruit,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",TeaOrCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SuppleDrnk,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Other,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_1\")",Assistance,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",LessThan30,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",MidTeaCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",MidSupldrnk,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"chkFalse_3\")",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",MidSnack,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",MidAssistnce,exestatus);

// To fill the details for Lunch
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",DietType,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",FreshJu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",Milk,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",CookOpt,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",TypCooOpt,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_16\")",Cerea,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_17\")",Vegitab,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_18\")",Sandwi,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_19\")",Bread,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",NoSlic,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_20\")",Yoghu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_21\")",Fruit,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_22\")",TeaOrCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_23\")",SuppleDrnk,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Other,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",Assistance,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",LessThan30,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_24\")",MidTeaCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_25\")",MidSupldrnk,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"chkFalse_6\")",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_26\")",MidSnack,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_6\")",MidAssistnce,exestatus);

// To fill the details for Dinner
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",DietType,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_27\")",FreshJu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_28\")",Milk,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_29\")",CookOpt,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",TypCooOpt,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_30\")",Cerea,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_31\")",Vegitab,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_32\")",Sandwi,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_33\")",Bread,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",NoSlic,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_34\")",Yoghu,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_35\")",Fruit,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_36\")",TeaOrCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_37\")",SuppleDrnk,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",Other,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_7\")",Assistance,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_8\")",LessThan30,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_38\")",MidTeaCoff,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_39\")",MidSupldrnk,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"chkFalse_9\")",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_40\")",MidSnack,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_9\")",MidAssistnce,exestatus);


  
// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
    
// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Observations","Food Chart");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documentted values
  // TO validate the details for Breakfast
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",DietType, "DietType",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",FreshJu, "FreshJu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",Milk, "Milk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",CookOpt, "CookOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",TypCooOpt, "TypCooOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",Cerea, "Cerea",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",Bread, "Bread",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")", "Value",NoSlic, "NoSlic",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",Yoghu, "Yoghu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",Fruit,"Fruit",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",TeaOrCoff,"TeaOrCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")", "Text",SuppleDrnk,"SuppleDrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Other, "Other",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_10\")", "Text",MidTeaCoff,"MidTeaCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",MidSupldrnk,"MidSupldrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_12\")", "Text",MidSnack,"MidSnack",exestatus);
  
  // TO validate the details for Lunch
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",DietType, "DietType",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_13\")", "Text",FreshJu, "FreshJu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_14\")", "Text",Milk, "Milk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_15\")", "Text",CookOpt, "CookOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",TypCooOpt, "TypCooOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_16\")", "Text",Cerea, "Cerea",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_17\")", "Text",Vegitab, "Vegitab",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_18\")", "Text",Sandwi, "Sandwi",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_19\")", "Text",Bread, "Bread",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")", "Value",NoSlic, "NoSlic",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_20\")", "Text",Yoghu, "Yoghu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_21\")", "Text",Fruit,"Fruit",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_22\")", "Text",TeaOrCoff,"TeaOrCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_23\")", "Text",SuppleDrnk,"SuppleDrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",Other, "Other",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_24\")", "Text",MidTeaCoff,"MidTeaCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_25\")", "Text",MidSupldrnk,"MidSupldrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_26\")", "Text",MidSnack,"MidSnack",exestatus);
  
  // TO validate the details for Lunch
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",DietType, "DietType",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_27\")", "Text",FreshJu, "FreshJu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_28\")", "Text",Milk, "Milk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_29\")", "Text",CookOpt, "CookOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",TypCooOpt, "TypCooOpt",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_30\")", "Text",Cerea, "Cerea",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_31\")", "Text",Vegitab, "Vegitab",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_32\")", "Text",Sandwi, "Sandwi",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_33\")", "Text",Bread, "Bread",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")", "Value",NoSlic, "NoSlic",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_34\")", "Text",Yoghu, "Yoghu",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_35\")", "Text",Fruit,"Fruit",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_36\")", "Text",TeaOrCoff,"TeaOrCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_37\")", "Text",SuppleDrnk,"SuppleDrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",Other, "Other",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_38\")", "Text",MidTeaCoff,"MidTeaCoff",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_39\")", "Text",MidSupldrnk,"MidSupldrnk",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_40\")", "Text",MidSnack,"MidSnack",exestatus);

  
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

   
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Food chart for a patient");
      Log.Checkpoint("End of documenting Food chart for a patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped documenting Food chart status for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvValidateOverdueMedication
// Desc :Feature to Validate Overdue Medication for a patient
// Owner :Satheeshkumar C
// Creation date:07 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvValidateOverdueMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of administer Overdue medications "+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

//var Diluent_Drug = Data.getData(TestName,"Medications","Diluent_Drug")
//var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant")

//Administer Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Select the Diluent button
//exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 7).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

// Enter the diluent and quantity
//exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"TextEdit\", \"\"\, 1).WPFObject(\"Grid\", \"\"\, 1).WPFObject(\"FindComboBoxEdit\")",5,2,Diluent_Drug,2,exestatus);
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);

// final validation is pending- Flowsheet
// administer infused medication in flow sheet

// Validation in titrate medication tab

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,12",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully administered overdue medication for a patient");
      Log.Checkpoint("End of administer overdue medication ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped administer overdue medication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentAndScheduleWoundCare
// Desc :Feature to document Wound Care for a patient
// Owner :Satheeshkumar C
// Creation date:08-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDocumentAndScheduleWoundCare(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
Log.Checkpoint("Start of documenting  and Schdule Wound Care for "+tcDesc ,"The flow is started");
	
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");

// To select the Wounds tab
 exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,18",exestatus);
	
 // To select the body chart button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);
  
// TO select the relavent body area 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_30\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_16\").WPFObject(\"picFrameIn_16\").WPFObject(\"cmdAction_103\")",exestatus);
 
// Fill in the details for Wound care 
Log.Message("***Enter details for Wound Care***");
	
var WoundSta = Data.getData(TestName,"NursingCare","WoundSta");
var PreOnAdmi = Data.getData(TestName,"NursingCare","PreOnAdmi"); 
var WoundType = Data.getData(TestName,"NursingCare","WoundType");
var Woundloca = Data.getData(TestName,"NursingCare","Woundloca");
var Lenth = Data.getData(TestName,"NursingCare","Lenth");
var Breadth = Data.getData(TestName,"NursingCare","Breadth");
var Depth = Data.getData(TestName,"NursingCare","Depth");
var Infection = Data.getData(TestName,"NursingCare","Infection");
var WoundDescr = Data.getData(TestName,"NursingCare","WoundDescr");
var WoundDisch = Data.getData(TestName,"NursingCare","WoundDisch");
var DressingType = Data.getData(TestName,"NursingCare","DressingType");
var DressingFreq = Data.getData(TestName,"NursingCare","DressingFreq");
var CleaningSolu = Data.getData(TestName,"NursingCare","CleaningSolu");
var IrrSolu = Data.getData(TestName,"NursingCare","IrrSolu");
var IrrFreq = Data.getData(TestName,"NursingCare","IrrFreq");
var TremtPlan = Data.getData(TestName,"NursingCare","TremtPlan");
var IrrVolu = Data.getData(TestName,"NursingCare","IrrVolu");
var Password = Data.getData(TestName,"Navigation","Password");
  
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBoxItem",WoundSta,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_1\")",PreOnAdmi,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",WoundType,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picFrameIn_4\").WPFObject(\"picTextCombo_4\").WPFObject(\"cboTextCombo_4\")","ImdComboBoxItem",Woundloca,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Lenth,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Breadth,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",Depth,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_7\")",Infection,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",WoundDescr,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_8\")",WoundDisch,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_9\")",DressingType,exestatus);
exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_10\").WPFObject(\"lstTextList_10\")",exestatus);
exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_11\").WPFObject(\"lstTextList_11\")",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_10\")",DressingFreq,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_11\")",CleaningSolu,exestatus);
exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_4\").WPFObject(\"picFreeText_8\").WPFObject(\"txtFreeText_8\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",IrrVolu,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_12\")",IrrSolu,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_13\")",IrrFreq,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",TremtPlan,exestatus);
  
// Save and Close the form data
 
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus); 

//Save the body chart form 
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdApply\")",exestatus); 

aqUtils.Delay(5000);
	 //To close the form
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);


// To select the body chart button
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);
  
// TO select the relavent body area 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_30\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_16\").WPFObject(\"picFrameIn_16\").WPFObject(\"cmdAction_103\")",exestatus);  

// To schedule wound care and click on Management log button  
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_2\")",exestatus);

// To select the care button
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_3\").WPFObject(\"picFrameIn_3\").WPFObject(\"cmdAction_6\")",exestatus);

// To Enter input details for order entry window
aqUtils.Delay(5000);
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
var medicaltype=Data.getData(TestName,"MedicalCare","medicaltype");
var SetInterval = Data.getData(TestName,"MedicalCare","SetInterval");

// To select the frequency
//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"FrequencyView\", \"\", 1).WPFObject(\"Frequency_Group\").WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")",exestatus);

// To enter the frequency value
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);

 // To click ok on order entry window
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\",1)",exestatus);
 
 // To Proceed with pop up
 var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
 
 //Save and close the form data
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdSave\")",exestatus);

 //Save the body chart form 
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdApply\")",exestatus); 

aqUtils.Delay(5000);
	 //To close the form
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);


  
 //Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

    
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented and scheduled Wound care for a patient");
      Log.Checkpoint("End of documenting and scheduling wound care for a patient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped documenting and scheduling wound care for a patient ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVPrintPatientRecord
// Desc :Feature to Print the Patient medical Record 
// Owner :Satheeshkumar C
// Creation date:07-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVPrintPatientRecord(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of Print Patient Record for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
  
var FromDate = Data.getData(TestName,"HandOver","FromDate");
	 // To select the Print option  
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Print", "Print bundles");
	// To select the corresponding record
	exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"MvTab\").WPFObject(\"TabItem\", \"\", 3)",exestatus);
		// ** Fill in the details to print patient medical record
	Log.Message("*** Enter print patient medical record ***");
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 14)",exestatus);   
	 
   //To set the from date 
   exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"mvcboTimeFrom\")",FromDate,exestatus);
   // To Preview the selected medical record
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdPreview\")",exestatus);
  aqUtils.Delay(5000);
  // To close the preview form
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmRBPreview\").WinFormsObject(\"cmdClose\")",exestatus);
 // To close the print window
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdClose\")",exestatus);
 aqUtils.Delay(3000);
 //To close the main window
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"header\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"StackPanel\", \"\", 2).WPFObject(\"Button\", \"\", 3)",exestatus);


  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Printed patient medical record");
      Log.Checkpoint("End of printing patient medical record ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped print patient medical record","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVNDISNote
// Desc :Feature to document the National Disability Insurance Scheme note via add progress notes
// Owner :Satheeshkumar C
// Creation date:14 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVNDISNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting National Disability Insurance Scheme note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the National Disability Insurance Scheme notes  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","National Disability Insurance Scheme");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the National Disability Insurance Scheme notes
	Log.Message("***Enter details for National Disability Insurance Scheme note***");
  
	var ReferMangr = Data.getData(TestName,"OtherCare","ReferMangr");
	var CaseMangr  = Data.getData(TestName,"OtherCare","CaseMangr");
  var ContDetail  = Data.getData(TestName,"OtherCare","ContDetail");


   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",ReferMangr,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",CaseMangr,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",ContDetail,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("NDIS Notes Saved Time: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("NDIS Notes Saved Time: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","National Disability Insurance Scheme");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",CaseMangr,"CaseMangr",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",ContDetail,"ContDetail",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"National Disability Insurance Scheme",exestatus);
  
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",CaseMangr,"CaseMangr",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",ContDetail,"ContDetail",exestatus);
  
  // close the form 
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented National Disability Insurance Scheme");
      Log.Checkpoint("End of National Disability Insurance Scheme Notes","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped National Disability Insurance Scheme Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVMedicalNote
// Desc :Feature to document the Medical note via add progress notes
// Owner :Satheeshkumar C
// Creation date:14 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVMedicalNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting medical note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Medical progress note  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Medical Notes","ICU","ICU Medical Progress Note");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the Medical progress note
	Log.Message("***Enter details for Medical note***");
  
	var ClinTm = Data.getData(TestName,"OtherCare","ClinTm");
	var ClinTmCont  = Data.getData(TestName,"OtherCare","ClinTmCont");
  var MediProgNote  = Data.getData(TestName,"OtherCare","MediProgNote");


   
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",ClinTmCont,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",MediProgNote,exestatus);
   //exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox",ClinTm,exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Medical Notes Saved Time: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Medical Notes Saved Time: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Medical Notes","ICU","ICU Medical Progress Note");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_1\")", "DisplayText",ClinTm,"ClinTm",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ClinTmCont,"ClinTmCont",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",MediProgNote,"MediProgNote",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"National Disability Insurance Scheme",exestatus);
  
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextComboMulti_1\")", "DisplayText",ClinTm,"ClinTm",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ClinTmCont,"ClinTmCont",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",MediProgNote,"MediProgNote",exestatus);
  
  // close the form 
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  //var objData = Data.getData(TestName,"Patient");
  	//var newPatientMRN = objData("MRN").Value;
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Medical progress notes");
      Log.Checkpoint("End of Medical progress notes","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Medical progress note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVDomesticViolencAVONote
// Desc :Feature to document the Domestic Violenc AVO Note via add progress notes
// Owner :Satheeshkumar C
// Creation date:15 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVDomesticViolenceAVONote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of Domestic Violenc AVO Notes for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Domestic Violenc AVO Note  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","Domestic Violence AVO");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);
		
    // ** Fill in the Domestic Violenc AVO Note
	Log.Message("***Enter details for Domestic Violenc AVO Note***");
  
var Relation = Data.getData(TestName,"OtherCare","Relation");
var Name  = Data.getData(TestName,"OtherCare","Name");
var HomeCont1  = Data.getData(TestName,"OtherCare","HomeCont1");
var HomeCont2  = Data.getData(TestName,"OtherCare","HomeCont2");
var Business  = Data.getData(TestName,"OtherCare","Business");
var Comments  = Data.getData(TestName,"OtherCare","Comments");


   //exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"cboTextCombo_1\")",Relation,exestatus);
   exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBox",Relation,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Name,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",HomeCont1,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",HomeCont2,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Business,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Comments,exestatus);
   
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Domestic Violenc AVO Note: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Domestic Violenc AVO Note: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Social Work Notes","Domestic Violence AVO");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",Relation,"Relation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Name,"Name",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",HomeCont1,"HomeCont1",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",HomeCont2,"HomeCont2",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Business,"Business",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",Comments,"Comments",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Domestic Violence AVO Notes",exestatus);
  
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",Relation,"Relation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Name,"Name",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",HomeCont1,"HomeCont1",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",HomeCont2,"HomeCont2",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Business,"Business",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",Comments,"Comments",exestatus);
  
  // close the form 
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Domestic Violence AVO Notes");
      Log.Checkpoint("End of Domestic Violence AVO Notes","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Domestic Violence AVO Notes","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVNursingAssessmentNote
// Desc :Feature to document the Nursing Assessment Note via Nursing Notes
// Owner :Satheeshkumar C
// Creation date:15 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVNursingAssessmentNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Nursing Assessment Note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Nursing Assessment Note  
	
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Nursing Notes","ICU","Nursing Assessment Note (ABCDEFG)");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for Nursing Assessment Note
	Log.Message("***Enter details for Nursing Assessment Note***");
  
var GeneralNote = Data.getData(TestName,"OtherCare","GeneralNote");
var Airway  = Data.getData(TestName,"OtherCare","Airway");
var Breathing  = Data.getData(TestName,"OtherCare","Breathing");
var Circulation  = Data.getData(TestName,"OtherCare","Circulation");
var Disability  = Data.getData(TestName,"OtherCare","Disability");
var Exposure = Data.getData(TestName,"OtherCare","Exposure");
var Fluid = Data.getData(TestName,"OtherCare","Fluid");
var Glugose = Data.getData(TestName,"OtherCare","Glugose");
var NurseMgmPln = Data.getData(TestName,"OtherCare","NurseMgmPln");




   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",GeneralNote,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Airway,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Breathing,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Circulation,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Disability,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Exposure,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Fluid,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",Glugose,exestatus);
   exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_9\")",exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",NurseMgmPln,exestatus); 
     
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Nursing Assessment Note: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Nursing Assessment Note: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save..   
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  //exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Progress Notes","Nursing Assessment Note (ABCDEFG)");
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Nursing Notes","ICU","Nursing Assessment Note (ABCDEFG)");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",GeneralNote,"GeneralNote",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Airway,"Airway",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Breathing,"Breathing",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Circulation,"Circulation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",Disability,"Disability",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",Exposure,"Exposure",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",Fluid,"Fluid",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",Glugose,"Glugose",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",NurseMgmPln,"NurseMgmPln",exestatus);

   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Domestic Violence AVO Notes",exestatus);
  
  exestatus =  mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",GeneralNote,"GeneralNote",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Airway,"Airway",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Breathing,"Breathing",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Circulation,"Circulation",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",Disability,"Disability",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",Exposure,"Exposure",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",Fluid,"Fluid",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",Glugose,"Glugose",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",NurseMgmPln,"NurseMgmPln",exestatus);
  
  // close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Nursing Assessment Notes");
      Log.Checkpoint("End of Nursing Assessment Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Nursing Assessment Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVAdvancedCareDirective
// Desc :Feature to document the Advanced Care Directive
// Owner :Satheeshkumar C
// Creation date:16 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVAdvancedCareDirective(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Advanced Care Directive for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Advanced Care Directive  
	exestatus = mvObjects.selectMenuOption(exestatus,"End of Life", "Advance Care Directive");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"chkTrue_1\")", 120,exestatus);
		
    // ** Fill in the details for  Advanced Care Directive
	Log.Message("***Enter details for Advanced Care Directive***");
  var TypeOfNavigation = Data.getData(TestName,"OtherCare","TypeOfNavigation");
	var AdvanCareExist = Data.getData(TestName,"OtherCare","AdvanCareExist");
  var AdvanCareReview  = Data.getData(TestName,"OtherCare","AdvanCareReview");
  var Comments  = Data.getData(TestName,"OtherCare","Comments");

switch (TypeOfNavigation)
{
   case ("Yes"):
   {
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",AdvanCareExist,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",AdvanCareReview,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Comments,exestatus);
   break;
   }
   
   case ("No"):
   {
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_1\")",AdvanCareExist,exestatus);
	 exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_2\")",AdvanCareReview,exestatus);
   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Comments,exestatus);
   break;
   }
   
   
 }  
         
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"End of Life","Advance Care Directive");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  switch (TypeOfNavigation)
{
   case ("Yes"):
   {
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text",AdvanCareExist,"AdvanCareExist",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_2\")", "Text",AdvanCareReview,"AdvanCareReview",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);
  break;
  }
  case ("No"):
   {
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_1\")", "Text",AdvanCareExist,"AdvanCareExist",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_2\")", "Text",AdvanCareReview,"AdvanCareReview",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);
  break;
  }
}  
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Advanced Care Directive");
      Log.Checkpoint("End of Documenting Advanced Care Directive","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Advanced Care Directive","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVAlertsAndIsolationRequirements
// Desc :Feature to document Alerts And Isolation Requirements for patient
// Owner :Satheeshkumar C
// Creation date:16 Nov 2017
// Update By :Satheeshkumar C
// Update date:04-Dec-17
// Update desc:Updated the mandatory validation and option to handle both nursing & medical menu
//******************************************************************************************//
//******************************************************************************************//
function MVAlertsAndIsolationRequirements(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Alerts And Isolation Requirements for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
   
 var TypeOfNavigation = Data.getData(TestName,"OtherCare","TypeOfNavigation"); 
 
 switch (TypeOfNavigation){
 case("Nursing"):
 
 // To select the Alerts And Isolation Requirements via nursing menu  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Alerts and Isolation Requirements");
  break;
  
	case ("Medical"):
  // To select the Alerts And Isolation Requirements via medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Alerts and Isolation Requirements");
  break;
  
  default:
  Log.Message("Did not enter type of Navigation");
  
 }
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
  
  // To check for the mandatory validation pop up
 exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
 
 
 var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    }
  
		
    // ** Fill in the details for  Alerts And Isolation Requirements
	Log.Message("***Enter details for Alerts And Isolation Requirements***");
  
   var Alerts_MRSA = Data.getData(TestName,"OtherCare","Alerts_MRSA");
  var AlertsVRE = Data.getData(TestName,"OtherCare","AlertsVRE");
  var AlertsESBL = Data.getData(TestName,"OtherCare","AlertsESBL");
  var AlertsMRAB = Data.getData(TestName,"OtherCare","AlertsMRAB");
  var AlertsVISA = Data.getData(TestName,"OtherCare","AlertsVISA");
  var AlertsCRE = Data.getData(TestName,"OtherCare","AlertsCRE");
  var AlertsBurk = Data.getData(TestName,"OtherCare","AlertsBurk");
  var AlertsClostr = Data.getData(TestName,"OtherCare","AlertsClostr");
  var AlertsRespri = Data.getData(TestName,"OtherCare","AlertsRespri");
  var AlertsVaric = Data.getData(TestName,"OtherCare","AlertsVaric");
  var AlertsCytot = Data.getData(TestName,"OtherCare","AlertsCytot");
  var AlertsImmun = Data.getData(TestName,"OtherCare","AlertsImmun");
  var AlertsOther = Data.getData(TestName,"OtherCare","AlertsOther");
  var PreOnAdmiYes  = Data.getData(TestName,"OtherCare","PreOnAdmiYes");
  var PreOnAdmiNo  = Data.getData(TestName,"OtherCare","PreOnAdmiNo");
  var Comments  = Data.getData(TestName,"OtherCare","Comments");
  var PrecauType  = Data.getData(TestName,"OtherCare","PrecauType");
  var RoomPres  = Data.getData(TestName,"OtherCare","RoomPres");
  var Other  = Data.getData(TestName,"OtherCare","Other");
  var expdectdate = Data.getData(TestName,"OtherCare","expdectdate");

exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",Alerts_MRSA,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsVRE,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsESBL,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsMRAB,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsVISA,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsCRE,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsBurk,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsClostr,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsRespri,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsVaric,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsCytot,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsImmun,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",AlertsOther,exestatus);

    //Use this for Operational reports MRO in ICU
    if(aqString.Compare(TestName,"OR_MROinICU",false) ==0)
    {        
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_1\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_2\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_3\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_5\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_6\")",PreOnAdmiNo,exestatus);
    }
    else if(aqString.Compare(TestName,"OR_MROonAdmission",false) ==0)
    {        
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",PreOnAdmiYes,exestatus);
    }
    else
    {
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_2\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",PreOnAdmiNo,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",PreOnAdmiYes,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_6\")",PreOnAdmiNo,exestatus);
    }

  let AlertsandIsolationRequirements = new Object();
  AlertsandIsolationRequirements.AllDateDedect = Data.getData(TestName,"OtherCare","AllDateDedect")
  DedecDay = aqDateTime.GetDay(AlertsandIsolationRequirements.AllDateDedect);
	Dedecmonth = aqDateTime.GetMonth(AlertsandIsolationRequirements.AllDateDedect);
	Dedecyear = aqDateTime.GetYear(AlertsandIsolationRequirements.AllDateDedect); 
  
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DedecDay, Dedecmonth, Dedecyear,"00","00",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DedecDay, Dedecmonth, Dedecyear,"00","00",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", DedecDay, Dedecmonth, Dedecyear,"00", "00",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_4\")", DedecDay, Dedecmonth, Dedecyear,"00", "00",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_5\")", DedecDay, Dedecmonth, Dedecyear,"00", "00",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_6\")", DedecDay, Dedecmonth, Dedecyear,"00", "00",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Other,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",PrecauType,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",RoomPres,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_1\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Comments,exestatus);
         
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  //exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Alerts and Isolation Requirements");
  switch (TypeOfNavigation){
 case("Nursing"):
 // To select the Alerts And Isolation Requirements via nursing menu  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Alerts and Isolation Requirements");
  break;
	case ("Medical"):
  // To select the Alerts And Isolation Requirements via medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Alerts and Isolation Requirements");
  break;
 }
  aqUtils.Delay(2000);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_2\")", "Value",(new Date(expdectdate)),"DateDedectMRSA",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")", "Value",expdectdate,"DateDedectVRE",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_4\")", "Value",expdectdate,"DateDedectESBL",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_5\")", "Value",expdectdate,"DateDedectMRAB",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_6\")", "Value",expdectdate,"DateDedectVISA",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_3\")", "Value",expdectdate,"DateDedectCRE",exestatus);

  //Use this for Operational reports MRO in ICU
  if(aqString.Compare(TestName,"OR_MROinICU",false) ==0)
  {
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text",PreOnAdmiNo,"MRSAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_3\")", "Text",PreOnAdmiNo,"ESBLPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_5\")", "Text",PreOnAdmiNo,"VISAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_2\")", "Text",PreOnAdmiNo,"VREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_4\")", "Text",PreOnAdmiNo,"MRABPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_6\")", "Text",PreOnAdmiNo,"CREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Other,"Other",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",PrecauType,"PrecauType",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",RoomPres,"RoomPres",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);

  }
  else if(aqString.Compare(TestName,"OR_MROonAdmission",false) ==0)
  {
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text",PreOnAdmiYes,"MRSAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_3\")", "Text",PreOnAdmiYes,"ESBLPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_5\")", "Text",PreOnAdmiYes,"VISAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_2\")", "Text",PreOnAdmiYes,"VREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_4\")", "Text",PreOnAdmiYes,"MRABPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_6\")", "Text",PreOnAdmiYes,"CREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Other,"Other",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",PrecauType,"PrecauType",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",RoomPres,"RoomPres",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);

  }
  else
  {
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text",PreOnAdmiYes,"MRSAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_3\")", "Text",PreOnAdmiYes,"ESBLPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_5\")", "Text",PreOnAdmiYes,"VISAPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_2\")", "Text",PreOnAdmiNo,"VREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_4\")", "Text",PreOnAdmiNo,"MRABPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkFalse_6\")", "Text",PreOnAdmiNo,"CREPreonAdmi",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",Other,"Other",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",PrecauType,"PrecauType",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",RoomPres,"RoomPres",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",Comments,"Comments",exestatus);

  }

   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Alerts And Isolation Requirements");
      Log.Checkpoint("End of Documenting Alerts And Isolation Requirements","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Alerts And Isolation Requirements","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVAlliedHealthProgressNotes
// Desc :Feature to document the Allied Health Progress Notes 
// Owner :Satheeshkumar C
// Creation date:16 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVAlliedHealthProgressNotes(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Allied Health Progress Notes for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Allied Health Progress Notes  
	
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Allied Health Progress Note");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for Allied Health Progress Notes
	Log.Message("***Enter details for Allied Health Progress Notes***");
  
 var AHPNote = Data.getData(TestName,"OtherCare","AHPNote");

   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",AHPNote,exestatus);
	    
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Allied Health Progress Notes: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Allied Health Progress Notes: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save..   
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Allied Health Progress Note");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",AHPNote,"AHPNote",exestatus);


   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Allied Health Progress Notes",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",AHPNote,"AHPNote",exestatus);

  
  // close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Allied Health Progress Notes");
      Log.Checkpoint("End of Allied Health Progress Notes","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Allied Health Progress Notes","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVPharmacyProgressNote
// Desc :Feature to document the Pharmacy Progress Note 
// Owner :Satheeshkumar C
// Creation date:16 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVPharmacyProgressNote(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Pharmacy Progress Note for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Pharmacy Progress Note  
	
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Pharmacy Notes","Pharmacy Progress Note");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for Pharmacy Progress Note
	Log.Message("***Enter details for Pharmacy Progress Note***");
  
 var PharmaNote = Data.getData(TestName,"OtherCare","PharmaNote");
 var ExpPharValue = Data.getData(TestName,"OtherCare","ExpPharValue");
 

   exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",PharmaNote,exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_1\")",exestatus);

	    
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
 
   //New Function
     timeSavedValue = timeSavedValue.OleValue
 	  Log.Checkpoint("Pharmacy Progress Note: "+ timeSavedValue);
    
  MsgValue = timeSavedValue.OleValue
	Log.Checkpoint("Pharmacy Progress Note: "+ MsgValue);
  
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

  //To proceed with windowspopup
        
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save..   
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
	//Validation part open form again
  
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Pharmacy Notes","Pharmacy Progress Note");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  

  
	// Wait for screen to appear
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ExpPharValue,"ExpPharValue",exestatus);


   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  // Validation of documented values in Progress note tab
  exestatus = mvObjects.buttonClick(vProcess,"Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"Pharmacy Progress Notes",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ExpPharValue,"ExpPharValue",exestatus);

  
  // close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Pharmacy Progress Notes");
      Log.Checkpoint("End of Pharmacy Progress Notes","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Pharmacy Progress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVPhysiotherapyAssessmentTool
// Desc :Feature to document Physiotherapy Assessment via scores 
// Owner :Satheeshkumar C
// Creation date:17 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVPhysiotherapyAssessmentTool(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Physiotherapy Assessment for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Physiotherapy Assessment Tool  
	exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Physiotherapy Assessment Tool");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for  Physiotherapy Assessment
	Log.Message("***Enter details for Physiotherapy Assessment***");
  
  var IMSScore = Data.getData(TestName,"OtherCare","IMSScore");
  var NoOfStafReq = Data.getData(TestName,"OtherCare","NoOfStafReq");
  var AdveEvntCardio = Data.getData(TestName,"OtherCare","AdveEvntCardio");
  var AdveEvntExtub = Data.getData(TestName,"OtherCare","AdveEvntExtub");
  var AdveEvntFall = Data.getData(TestName,"OtherCare","AdveEvntFall"); 
  var AdveEvntRespiIns = Data.getData(TestName,"OtherCare","AdveEvntRespiIns");
  var EquipUseBaria = Data.getData(TestName,"OtherCare","EquipUseBaria");
  var EquipUseFASF = Data.getData(TestName,"OtherCare","EquipUseFASF");
  var EquipUseHois = Data.getData(TestName,"OtherCare","EquipUseHois");
  var EquipUseStandFra = Data.getData(TestName,"OtherCare","EquipUseStandFra");
  var EquipUseTilTab = Data.getData(TestName,"OtherCare","EquipUseTilTab");
  var DurIntExce = Data.getData(TestName,"OtherCare","DurIntExce");
  var DayOfFirstStand = Data.getData(TestName,"OtherCare","DayOfFirstStand");
  var DayOfFirstWalk  = Data.getData(TestName,"OtherCare","DayOfFirstWalk");
  var RespriFunct  = Data.getData(TestName,"OtherCare","RespriFunct");
  var Cough  = Data.getData(TestName,"OtherCare","Cough");
  var MovWithBed  = Data.getData(TestName,"OtherCare","MovWithBed");
  var SupineSitt  = Data.getData(TestName,"OtherCare","SupineSitt");
  var DynamSit  = Data.getData(TestName,"OtherCare","DynamSit");
  var StandBalanc = Data.getData(TestName,"OtherCare","StandBalanc");
  var SitStand = Data.getData(TestName,"OtherCare","SitStand");
  var TranBedChair = Data.getData(TestName,"OtherCare","TranBedChair");
  var Stepping = Data.getData(TestName,"OtherCare","Stepping");
  var GripinStrenth = Data.getData(TestName,"OtherCare","GripinStrenth");
  var DailScrAwaOpenOrClose = Data.getData(TestName,"OtherCare","DailScrAwaOpenOrClose");
  var DailScrAwaLooAtMe = Data.getData(TestName,"OtherCare","DailScrAwaLooAtMe");
  var DailScrAwaOpnYouMouth = Data.getData(TestName,"OtherCare","DailScrAwaOpnYouMouth");
  var LeftShoulFlex = Data.getData(TestName,"OtherCare","LeftShoulFlex");
  var LeftElbowFlex = Data.getData(TestName,"OtherCare","LeftElbowFlex");
  var LeftWristExtn = Data.getData(TestName,"OtherCare","LeftWristExtn");
  var LeftHipFlex = Data.getData(TestName,"OtherCare","LeftHipFlex");
  var LeftKneeExtn = Data.getData(TestName,"OtherCare","LeftKneeExtn");
  var LeftAngleDorsi = Data.getData(TestName,"OtherCare","LeftAngleDorsi");
  var RightShoulFlex = Data.getData(TestName,"OtherCare","RightShoulFlex");
  var RightElbowFlex = Data.getData(TestName,"OtherCare","RightElbowFlex");
  var RightWristExtn = Data.getData(TestName,"OtherCare","RightWristExtn");
  var RightHipFlex = Data.getData(TestName,"OtherCare","RightHipFlex");
  var RightKneeExtn = Data.getData(TestName,"OtherCare","RightKneeExtn");
  var RightAngleDorsi = Data.getData(TestName,"OtherCare","RightAngleDorsi");
  var CPAxScore = Data.getData(TestName,"OtherCare","CPSxScore");
  var MRCScore = Data.getData(TestName,"OtherCare","MRCScore");

// Selection of MRC-SS Score
aqUtils.Delay(2000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 4)",exestatus);
var ObjVisble = vProcess.Find("Name", "WPFObject(\"cboTextCombo_13\")", 1000);
  
if (ObjVisble.Enabled == false)
  {
    exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",DailScrAwaOpenOrClose,exestatus);
    exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",DailScrAwaLooAtMe,exestatus);
    exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",DailScrAwaOpnYouMouth,exestatus);
    }
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",LeftShoulFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",LeftElbowFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",LeftWristExtn,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_16\")",LeftHipFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_17\")",LeftKneeExtn,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_18\")",LeftAngleDorsi,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_19\")",RightShoulFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_20\")",RightElbowFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_21\")",RightWristExtn,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_22\")",RightHipFlex,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_23\")",RightKneeExtn,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_24\")",RightAngleDorsi,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 1)",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",IMSScore,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",NoOfStafReq,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",AdveEvntCardio,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",AdveEvntExtub,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",AdveEvntFall,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",AdveEvntRespiIns,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",EquipUseBaria,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",EquipUseFASF,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",EquipUseHois,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",EquipUseStandFra,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",EquipUseTilTab,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtNumeric_2\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",DurIntExce,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",DayOfFirstStand,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",DayOfFirstWalk,exestatus);

//Selection of CPAx Score
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",RespriFunct,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",Cough,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",MovWithBed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",SupineSitt,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",DynamSit,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",StandBalanc,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",SitStand,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",TranBedChair,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",Stepping,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",GripinStrenth,exestatus);

    //Selection of CPAx Chart
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 3)",exestatus);

   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Physiotherapy Assessment Tool");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",IMSScore,"IMSScore",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",NoOfStafReq,"NoOfStafReq",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",DurIntExce,"DurIntExce",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")", "Value",DayOfFirstStand,"DayOfFirstStand",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")", "Value",DayOfFirstWalk,"DayOfFirstWalk",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",RespriFunct,"RespriFunct",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",Cough,"Cough",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",MovWithBed,"MovWithBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",SupineSitt,"SupineSitt",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",DynamSit,"DynamSit",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",StandBalanc,"StandBalanc",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")", "Text",SitStand,"SitStand",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_10\")", "Text",TranBedChair,"TranBedChair",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",Stepping,"Stepping",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_12\")", "Text",GripinStrenth,"GripinStrenth",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")", "Text",CPAxScore,"CPAxScore",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 4)",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_13\")", "Text",LeftShoulFlex,"LeftShoulFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_14\")", "Text",LeftElbowFlex,"LeftElbowFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_15\")", "Text",LeftWristExtn,"LeftWristExtn",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_16\")", "Text",LeftHipFlex,"LeftHipFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_17\")", "Text",LeftKneeExtn,"LeftKneeExtn",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_18\")", "Text",LeftAngleDorsi,"LeftAngleDorsi",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_19\")", "Text",RightShoulFlex,"RightShoulFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_20\")", "Text",RightElbowFlex,"RightElbowFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_21\")", "Text",RightWristExtn,"RightWristExtn",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_22\")", "Text",RightHipFlex,"RightHipFlex",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_23\")", "Text",RightKneeExtn,"RightKneeExtn",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_24\")", "Text",RightAngleDorsi,"RightAngleDorsi",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_2\")", "Text",MRCScore,"MRCScore",exestatus);
   
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Physiotherapy Assessment");
      Log.Checkpoint("End of Documenting Physiotherapy Assessment","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Physiotherapy Assessment","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVManualHandling
// Desc :Feature to document Manual Handling 
// Owner :Satheeshkumar C
// Creation date:17 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVManualHandling(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Manual Handling for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Manual Handling  
	exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Manual Handling");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for  Manual Handling
	Log.Message("***Enter details for Manual Handling***");
  
  var Weight = Data.getData(TestName,"OtherCare","Weight");
  var Height = Data.getData(TestName,"OtherCare","Height");
  var HipWidth = Data.getData(TestName,"OtherCare","HipWidth");
  var Grith = Data.getData(TestName,"OtherCare","Grith");
  var MidUppArm = Data.getData(TestName,"OtherCare","MidUppArm");

  var ObstrSleep = Data.getData(TestName,"OtherCare","ObstrSleep");
  var HomeNonInva = Data.getData(TestName,"OtherCare","HomeNonInva");
  var BedPosi = Data.getData(TestName,"OtherCare","BedPosi");
  var MoveInBed = Data.getData(TestName,"OtherCare","MoveInBed");
  var Mobilic = Data.getData(TestName,"OtherCare","Mobilic");
  var WalkingFrm = Data.getData(TestName,"OtherCare","WalkingFrm");
  var WhlChar = Data.getData(TestName,"OtherCare","WhlChar");
  var ShowrChar = Data.getData(TestName,"OtherCare","ShowrChar");
  var LungeChr  = Data.getData(TestName,"OtherCare","LungeChr");

  var DeviceSett  = Data.getData(TestName,"OtherCare","DeviceSett");
  var LivingOther = Data.getData(TestName,"OtherCare","LivingOther");
  var Diagnostic  = Data.getData(TestName,"OtherCare","Diagnostic");
  var Emergency  = Data.getData(TestName,"OtherCare","Emergency");
  var FallProcedure  = Data.getData(TestName,"OtherCare","FallProcedure");
  var DischrOrTrnsfr = Data.getData(TestName,"OtherCare","DischrOrTrnsfr");
  var Dietition = Data.getData(TestName,"OtherCare","Dietition");
  var OccupationalTherpy = Data.getData(TestName,"OtherCare","OccupationalTherpy");
  var Physiothrpst = Data.getData(TestName,"OtherCare","Physiothrpst");
  var SocialWork = Data.getData(TestName,"OtherCare","SocialWork");

  var BedElect = Data.getData(TestName,"OtherCare","BedElect");
  var EqmntBedHilo = Data.getData(TestName,"OtherCare","EqmntBedHilo");
  var EqmntSlfHlp = Data.getData(TestName,"OtherCare","EqmntSlfHlp");
  var EqmntHvmat = Data.getData(TestName,"OtherCare","EqmntHvmat");
  var EqmntSlidSht = Data.getData(TestName,"OtherCare","EqmntSlidSht");
  var EqmntCommode = Data.getData(TestName,"OtherCare","EqmntCommode");

  var ToiEqPeliXlar = Data.getData(TestName,"OtherCare","ToiEqPeliXlar");
  var ToiEqWhlChXlar = Data.getData(TestName,"OtherCare","ToiEqWhlChXlar");
  var ToiEqOverFramStnd= Data.getData(TestName,"OtherCare","ToiEqOverFramStnd");
  var ShwEqChrXlarg = Data.getData(TestName,"OtherCare","ShwEqChrXlarg");

  var BedSafework = Data.getData(TestName,"OtherCare","BedSafework");
  var TrantTrolyBed = Data.getData(TestName,"OtherCare","TrantTrolyBed");
  var EnVidiMovingPatiBd = Data.getData(TestName,"OtherCare","EnVidiMovingPatiBd");
  var EnvAidsSitPatBed = Data.getData(TestName,"OtherCare","EnvAidsSitPatBed");
  var EnvAidsAisToWak = Data.getData(TestName,"OtherCare","EnvAidsAisToWak");
  
  //var SitPatientBed = Data.getData(TestName,"OtherCare","SitPatientBed");
  //var AissToWalk = Data.getData(TestName,"OtherCare","AissToWalk");

  var TranBdChrSliShtXlarge = Data.getData(TestName,"OtherCare","TranBdChrSliShtXlarge");
  
var NoStafReqTransToBed = Data.getData(TestName,"OtherCare","NoStafReqTransToBed");
var NoStafReqMovingPatientBed = Data.getData(TestName,"OtherCare","NoStafReqMovingPatientBed");
var NoStafReqSitPatientBed = Data.getData(TestName,"OtherCare","NoStafReqSitPatientBed");
var NoStafReqAissToWalk = Data.getData(TestName,"OtherCare","NoStafReqAissToWalk");
var NoStafReqTranBdChr = Data.getData(TestName,"OtherCare","NoStafReqTranBdChr");
var NoStafReqToilet = Data.getData(TestName,"OtherCare","NoStafReqToilet");
var NoStafReqShower = Data.getData(TestName,"OtherCare","NoStafReqShower");


exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Weight,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Height,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",HipWidth,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",Grith,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",MidUppArm,exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ObstrSleep,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",HomeNonInva,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",BedPosi,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",MoveInBed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",Mobilic,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",WalkingFrm,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",WhlChar,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",ShowrChar,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",LungeChr,exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",DeviceSett,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",LivingOther,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Diagnostic,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Emergency,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",FallProcedure,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",DischrOrTrnsfr,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_10\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Dietition,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",OccupationalTherpy,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",Physiothrpst,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_10\")",SocialWork,exestatus);


// TO enter input details for Environment and Aids
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",EqmntBedHilo,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",EqmntSlfHlp,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",EqmntHvmat,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",EqmntSlidSht,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_1\")",EqmntCommode,exestatus);



exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",ToiEqPeliXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",ToiEqWhlChXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_2\")",ToiEqWhlChXlar,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",ToiEqPeliXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",ToiEqWhlChXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_3\")",ShwEqChrXlarg ,exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTab_2\").WPFObject(\"picFrame_4\").WPFObject(\"picFrameIn_4\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",BedSafework,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",TrantTrolyBed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",EnVidiMovingPatiBd,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",EnvAidsSitPatBed,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",EnvAidsAisToWak,exestatus);


exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",ToiEqPeliXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",ToiEqWhlChXlar,exestatus);
exestatus = mvObjects.ListCheckBoxSelection("WPFObject(\"lstTextList_4\")",TranBdChrSliShtXlarge,exestatus);


exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",NoStafReqTransToBed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_7\")",NoStafReqMovingPatientBed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_8\")",NoStafReqSitPatientBed,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_9\")",NoStafReqAissToWalk,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_10\")",NoStafReqTranBdChr,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_11\")",NoStafReqToilet,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_12\")",NoStafReqShower,exestatus);

  let NoOfStafReq = new Object();
        NoOfStafReq.DueDate = Data.getData(TestName,"OtherCare","AllDateDedect")
        Day = aqDateTime.GetDay( NoOfStafReq.DueDate);
	      month = aqDateTime.GetMonth(NoOfStafReq.DueDate);
	      year = aqDateTime.GetYear(NoOfStafReq.DueDate); 
  
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", Day,month,year,"00","00",exestatus);
  
  
  
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Manual Handling");
  
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")", "Value",Weight,"Weight",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")", "Value",Height,"Height",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")", "Value",HipWidth,"HipWidth",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")", "Value",Grith,"Grith",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")", "Value",MidUppArm,"MidUppArm",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",ObstrSleep,"ObstrSleep",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")", "Text",HomeNonInva,"HomeNonInva",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")", "Text",BedPosi,"BedPosi",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")", "Text",MoveInBed,"MoveInBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")", "Text",Mobilic,"Mobilic",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")", "Text",WalkingFrm,"WalkingFrm",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_7\")", "Text",WhlChar,"WhlChar",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_8\")", "Text",ShowrChar,"ShowrChar",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_9\")", "Text",LungeChr,"LungeChr",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",DeviceSett,"DeviceSett",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",LivingOther,"LivingOther",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",Diagnostic,"Diagnostic",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Emergency,"Emergency",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",FallProcedure,"FallProcedure",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",DischrOrTrnsfr,"DischrOrTrnsfr",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",Dietition,"Dietition",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",OccupationalTherpy,"OccupationalTherpy",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",Physiothrpst,"Physiothrpst",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_10\")", "Text",SocialWork,"SocialWork",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_10\")", "Text",BedSafework,"BedSafework",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",TrantTrolyBed,"TrantTrolyBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_12\")", "Text",EnVidiMovingPatiBd,"EnVidiMovingPatiBd",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_13\")", "Text",EnvAidsSitPatBed,"EnvAidsSitPatBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_14\")", "Text",EnvAidsAisToWak,"EnvAidsAisToWak",exestatus);


exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")", "Value",NoStafReqTransToBed,"NoStafReqTransToBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_7\")", "Value",NoStafReqMovingPatientBed,"NoStafReqMovingPatientBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_8\")", "Value",NoStafReqSitPatientBed,"NoStafReqSitPatientBed",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_9\")", "Value",NoStafReqAissToWalk,"NoStafReqAissToWalk",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_10\")", "Value",NoStafReqTranBdChr,"NoStafReqTranBdChr",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_11\")", "Value",NoStafReqToilet,"NoStafReqToilet",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_12\")", "Value",NoStafReqShower,"NoStafReqShower",exestatus);
  
     
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Manual Handling");
      Log.Checkpoint("End of Documenting Manual Handling","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Manual Handling","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVMedicalDischargeSummary
// Desc :Feature to document Medical Dischare Summary 
// Owner :Satheeshkumar C
// Creation date:20 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVMedicalDischargeSummary(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Medical Dischare Summary for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Medical Discharge Summary  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Medical Discharge Summary");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_1\")", 120,exestatus);
		
    // ** Fill in the details for  Medical Discharge Summary
	Log.Message("***Enter details for Medical Discharge Summary***");
  
  var DischrAgainstMdl = Data.getData(TestName,"OtherCare","DischrAgainstMdl");
  var Height = Data.getData(TestName,"OtherCare","Height");
  var UnitOutCome = Data.getData(TestName,"OtherCare","UnitOutCome");
  var SigInterEven = Data.getData(TestName,"OtherCare","SigInterEven");
  var MediMgmplan = Data.getData(TestName,"OtherCare","MediMgmplan"); 
  var Weight = Data.getData(TestName,"OtherCare","Weight");
  var ElectiveAdmn = Data.getData(TestName,"OtherCare","ElectiveAdmission");
  //var ICUDischargePlan = Data.getData(TestName,"OtherCare","ICUDischargePlan");
  var ReasonOfAdmission = Data.getData(TestName,"OtherCare","ReasonOfAdmission");
  var PastMedicalHistory = Data.getData(TestName,"OtherCare","PastMedicalHistory");
  var FamilyAndSocialHistory = Data.getData(TestName,"OtherCare","FamilyAndSocialHistory");
  var ProbListAcuteActive = Data.getData(TestName,"OtherCare","ProbListAcuteActive");
  var ProbListAcuteResolved = Data.getData(TestName,"OtherCare","ProbListAcuteResolved");

        let MedicalDischargeSummary = new Object();
        
        MedicalDischargeSummary.HospAdmDT = Data.getData(TestName,"OtherCare","HospAdmDT")
        AdDay = aqDateTime.GetDay(MedicalDischargeSummary.HospAdmDT);
	      AdMonth = aqDateTime.GetMonth(MedicalDischargeSummary.HospAdmDT);
	      AdYear= aqDateTime.GetYear(MedicalDischargeSummary.HospAdmDT);
        
        MedicalDischargeSummary.UntDeciDischDT = Data.getData(TestName,"OtherCare","UntDeciDischDT")
        UDDTDay = aqDateTime.GetDay(MedicalDischargeSummary.UntDeciDischDT);
	      UDDTMonth = aqDateTime.GetMonth(MedicalDischargeSummary.UntDeciDischDT);
	      UDDTYear= aqDateTime.GetYear(MedicalDischargeSummary.UntDeciDischDT);
        
        MedicalDischargeSummary.UDisDatTime = Data.getData(TestName,"OtherCare","UDisDatTime")
        DiDTDay = aqDateTime.GetDay(MedicalDischargeSummary.UDisDatTime);
	      DiDTMonth = aqDateTime.GetMonth(MedicalDischargeSummary.UDisDatTime);
	      DiDTYear= aqDateTime.GetYear(MedicalDischargeSummary.UDisDatTime);
        
  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", AdDay,AdMonth,AdYear,"14","45",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",DischrAgainstMdl,exestatus);  
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",ElectiveAdmn,exestatus);
  exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",UnitOutCome,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",MediMgmplan,exestatus);


  //Reason for admission tab
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",ReasonOfAdmission,exestatus);

  //Past medical History tab
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 3)",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",PastMedicalHistory,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",FamilyAndSocialHistory,exestatus);


  // To enter input details for Interventions and events
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 4)",exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",SigInterEven,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",ProbListAcuteActive,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",ProbListAcuteResolved,exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_1\")",exestatus);

 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Medical Discharge Summary");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);

  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"chkTrue_1\")", "Text",DischrAgainstMdl,"DischrAgainstMdl",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",UnitOutCome,"UnitOutCome",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")", "Value",Height,"Height",exestatus);
  //exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_4\")", "Text",Weight,"Weight",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",MediMgmplan,"MediMgmplan",exestatus);
    
  //Reason for admission tab
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",ReasonOfAdmission,"ReasonOfAdmission",exestatus);

  //Past medical History tab
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 3)",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",PastMedicalHistory,"PastMedicalHistory",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",FamilyAndSocialHistory,"FamilyAndSocialHistory",exestatus);

  //Interventions and Events
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 4)",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",SigInterEven,"SigInterEven",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",ProbListAcuteActive,"ProbListAcuteActive",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",ProbListAcuteResolved,"ProbListAcuteResolved",exestatus);
  
     
	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Medical Discharge Summary");
      Log.Checkpoint("End of Documenting Medical Discharge Summary","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Medical Discharge Summary","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVPrintMedicalDischargeSummary
// Desc :Feature to the Print Medical Discharge Summary 
// Owner :Satheeshkumar C
// Creation date:20-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVPrintMedicalDischargeSummary(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of Printing  Medical Discharge Summary for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
  
var FromDate = Data.getData(TestName,"HandOver","FromDate");
	 // To select the Medical Discharge Summary option  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Medical Discharge Summary");
	
  // To select the Print button 
	exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"mvToolActionBorder\").WPFObject(\"mvToolAction\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 1)",exestatus);
		// ** Fill in the details to print patient medical record
	Log.Message("*** Enter details for print Medical Discharge Summary ***");
     

   //To set the from date 
   //exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"mvcboTimeFrom\")",FromDate,exestatus);
   // To Preview the selected medical record
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdPreview\")",exestatus);
  aqUtils.Delay(5000);
  // To close the preview form
  exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmRBPreview\").WinFormsObject(\"cmdClose\")",exestatus);
 // To close the print window
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdClose\")",exestatus);
 aqUtils.Delay(3000);
 //To close the main window
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  //Handle the Pop-Up - temporarily as this is not happening in 6.4.
  if (vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000).Exists)
  {
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
        aqUtils.Delay(300);
  }

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Printed Medical Discharge Summary");
      Log.Checkpoint("End of printing Medical Discharge Summary","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped print Medical Discharge Summary","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVVerifyANZICSDetailsTab01
// Desc :Feature to the ANZICS Addin
// Owner :AJ
// Creation date:28-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVVerifyANZICSDetailsTab01(TestName,exestatus)
{
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) 
    {
        Log.Checkpoint("Start of ANZICS tab01 validation for "+tcDesc ,"The flow is started");
	
        //Start of the feature 
      	 vProcess = Sys.Process("iMDSoft.Metavision");
  
        // Select ANZICS
        exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "ANZICS");

        aqUtils.Delay(1000);
        
        //Verify the fields on Tab-01
        
        
        
        
    
    }
    return exestatus;  
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MVANZICSDetails
// Desc :Feature to the ANZICS Addin
// Owner :AJ
// Creation date:28-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVANZICSDetails(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"ANZICS","TC_DESC");
var  ErrorInd = Data.getData(TestName,"ANZICS","ErrorInd");
var  WarningInd = Data.getData(TestName,"ANZICS","WarningInd");
var  HosAdmDate = Data.getData(TestName,"ANZICS","HosAdmDate");
var  ICUAdmDate = Data.getData(TestName,"ANZICS","ICUAdmDate");
var  HospSource = Data.getData(TestName,"ANZICS","HospSource");
var  ICUSource = Data.getData(TestName,"ANZICS","ICUSource");
var  Elect_Surgery = Data.getData(TestName,"ANZICS","Elect_Surgery");
var  Adm_Planned = Data.getData(TestName,"ANZICS","Adm_Planned");
var  Treat_Goals = Data.getData(TestName,"ANZICS","Treat_Goals");
var  Emer_Response = Data.getData(TestName,"ANZICS","Emer_Response");
var  Cardiac_Arrest = Data.getData(TestName,"ANZICS","Cardiac_Arrest");
var  Care_Type = Data.getData(TestName,"ANZICS","Care_Type");
var  Care_UnitID = Data.getData(TestName,"ANZICS","Care_UnitID");
var  Throm_Propaxis = Data.getData(TestName,"ANZICS","Throm_Propaxis");
var  Age = Data.getData(TestName,"ANZICS","Age");
var  Height = Data.getData(TestName,"ANZICS","Height");
var  Weight = Data.getData(TestName,"ANZICS","Weight");
var  Sex = Data.getData(TestName,"ANZICS","Sex");
var  Preg_Status = Data.getData(TestName,"ANZICS","Preg_Status");
var  Indigenous = Data.getData(TestName,"ANZICS","Indigenous");
var  Postcode = Data.getData(TestName,"ANZICS","Postcode");
var  ICU_DisDate = Data.getData(TestName,"ANZICS","ICU_DisDate");
var  ICU_Outcome = Data.getData(TestName,"ANZICS","ICU_Outcome");
var  ICU_DisDesDt = Data.getData(TestName,"ANZICS","ICU_DisDesDt");
var  Hos_DisDate = Data.getData(TestName,"ANZICS","Hos_DisDate");
var  Hos_Outcome = Data.getData(TestName,"ANZICS","Hos_Outcome");
var  seqA3CHEAids = Data.getData(TestName,"ANZICS","seqA3CHEAids");
var  seqA3CHECirrhosis = Data.getData(TestName,"ANZICS","seqA3CHECirrhosis");
var  seqA3CHEHepatic = Data.getData(TestName,"ANZICS","seqA3CHEHepatic");
var  seqA3CHEImmuno = Data.getData(TestName,"ANZICS","seqA3CHEImmuno");
var  seqA3CHELeukaemia = Data.getData(TestName,"ANZICS","seqA3CHELeukaemia");
var  seqA3CHELymphoma = Data.getData(TestName,"ANZICS","seqA3CHELymphoma");
var  seqA3CHEMetastatic = Data.getData(TestName,"ANZICS","seqA3CHEMetastatic");
var  seqA3CHENone = Data.getData(TestName,"ANZICS","seqA3CHENone");
var  seqA2CHE_Renal = Data.getData(TestName,"ANZICS","seqA2CHE_Renal");
var  seqA2CHECardiovascular = Data.getData(TestName,"ANZICS","seqA2CHECardiovascular");
var  seqA2CHEIMT = Data.getData(TestName,"ANZICS","seqA2CHEIMT");
var  seqA2CHEISD = Data.getData(TestName,"ANZICS","seqA2CHEISD");
var  seqA2CHELiver = Data.getData(TestName,"ANZICS","seqA2CHELiver");
var  seqA2CHENone = Data.getData(TestName,"ANZICS","seqA2CHENone");
var  seqA2CHERespiratory = Data.getData(TestName,"ANZICS","seqA2CHERespiratory");
var  Diagnosis = Data.getData(TestName,"ANZICS","Diagnosis");
var  ThromTherapSts = Data.getData(TestName,"ANZICS","ThromTherapSts");
var  FirstC = Data.getData(TestName,"ANZICS","FirstC");
var  NbrCorArt = Data.getData(TestName,"ANZICS","NbrCorArt");
var  TempHigh = Data.getData(TestName,"ANZICS","TempHigh");
var  TempLow = Data.getData(TestName,"ANZICS","TempLow");
var  HRHigh = Data.getData(TestName,"ANZICS","HRHigh");
var  HRLow = Data.getData(TestName,"ANZICS","HRLow");
var  RRHigh = Data.getData(TestName,"ANZICS","RRHigh");
var  RRLow = Data.getData(TestName,"ANZICS","RRLow");
var  HighRRInd = Data.getData(TestName,"ANZICS","HighRRInd");
var  LowRRInd = Data.getData(TestName,"ANZICS","LowRRInd");
var  MAPHigh = Data.getData(TestName,"ANZICS","MAPHigh");
var  MAPLow = Data.getData(TestName,"ANZICS","MAPLow");
var  SysBPHigh = Data.getData(TestName,"ANZICS","SysBPHigh");
var  SysBPLow = Data.getData(TestName,"ANZICS","SysBPLow");
var  DisBPHigh = Data.getData(TestName,"ANZICS","DisBPHigh");
var  DisBPLow = Data.getData(TestName,"ANZICS","DisBPLow");
var  UrineOut = Data.getData(TestName,"ANZICS","UrineOut");
var  IspatVoid = Data.getData(TestName,"ANZICS","IspatVoid");
var  IsAcuteRenal = Data.getData(TestName,"ANZICS","IsAcuteRenal");
var  InvVent24hrs = Data.getData(TestName,"ANZICS","InvVent24hrs");
var  InvVent = Data.getData(TestName,"ANZICS","InvVent");
var  NonInvVent = Data.getData(TestName,"ANZICS","NonInvVent");
var  TrachICU = Data.getData(TestName,"ANZICS","TrachICU");
var  GCSSedated = Data.getData(TestName,"ANZICS","GCSSedated");
var  Eye = Data.getData(TestName,"ANZICS","Eye");
var  Verbal = Data.getData(TestName,"ANZICS","Verbal");
var  Motor = Data.getData(TestName,"ANZICS","Motor");
var  ECMO = Data.getData(TestName,"ANZICS","ECMO");
var  RRT = Data.getData(TestName,"ANZICS","RRT");
var  Intrope = Data.getData(TestName,"ANZICS","Intrope");
var  Diabetes = Data.getData(TestName,"ANZICS","Diabetes");
var  Frailty = Data.getData(TestName,"ANZICS","Frailty");
var  Delirium = Data.getData(TestName,"ANZICS","Delirium");
var  PresInjury = Data.getData(TestName,"ANZICS","PresInjury");
var  NaHigh = Data.getData(TestName,"ANZICS","NaHigh");
var  NaLow = Data.getData(TestName,"ANZICS","NaLow");
var  KHigh = Data.getData(TestName,"ANZICS","KHigh");
var  KLow = Data.getData(TestName,"ANZICS","KLow");
var  BicarbHigh = Data.getData(TestName,"ANZICS","BicarbHigh");
var  BicarbLow = Data.getData(TestName,"ANZICS","BicarbLow");
var  CreatHigh = Data.getData(TestName,"ANZICS","CreatHigh");
var  CreatLow = Data.getData(TestName,"ANZICS","CreatLow");
var  Urea = Data.getData(TestName,"ANZICS","Urea");
var  AlbHigh = Data.getData(TestName,"ANZICS","AlbHigh");
var  AlbLow = Data.getData(TestName,"ANZICS","AlbLow");
var  Bilirubin = Data.getData(TestName,"ANZICS","Bilirubin");
var  GluHigh = Data.getData(TestName,"ANZICS","GluHigh");
var  GluLow = Data.getData(TestName,"ANZICS","GluLow");
var  HctHigh = Data.getData(TestName,"ANZICS","HctHigh");
var  HctLow = Data.getData(TestName,"ANZICS","HctLow");
var  WBCHigh = Data.getData(TestName,"ANZICS","WBCHigh");
var  WBCLow = Data.getData(TestName,"ANZICS","WBCLow");
var  HbHigh = Data.getData(TestName,"ANZICS","HbHigh");
var  HbLow = Data.getData(TestName,"ANZICS","HbLow");
var  PlateletsHigh = Data.getData(TestName,"ANZICS","PlateletsHigh");
var  PlateletsLow = Data.getData(TestName,"ANZICS","PlateletsLow");
var  HighLact = Data.getData(TestName,"ANZICS","HighLact");

Log.Checkpoint("Start of ANZICS for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
  
  // Select ANZICS
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "ANZICS");

   aqUtils.Delay(300);
   // Entering all the details in the ANZICS form
  exestatus = mvObjects.enterANZICSDateTimePicker(vProcess, "*WinFormsObject(\"ctlHospAdmissionDate\")",HosAdmDate,exestatus);
	exestatus = mvObjects.enterANZICSDateTimePicker(vProcess, "*WinFormsObject(\"ctlICUAdmissionDateTime\")",ICUAdmDate,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlAdmissionSourceHospitalCombo\").WinFormsObject(\"cboValue\")",HospSource,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlAdmissionSourceICUCombo\").WinFormsObject(\"cboValue\")",ICUSource,1,exestatus);
    if (vProcess.Find("Name", "Window(\"Static\"*)", 1000).Exists){
        var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
        Log.Checkpoint("ANZICS Addin Validation '"+msg+"'");
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\", 1)",exestatus);
        aqUtils.Delay(300);
      }
      
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlElectiveSurgeryCombo\").WinFormsObject(\"cboValue\")",Elect_Surgery,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlPlannedAdmissionCombo\").WinFormsObject(\"cboValue\")",Adm_Planned,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlTreatmentGoalsCombo\").WinFormsObject(\"cboValue\")",Treat_Goals,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlMETCalCombo\").WinFormsObject(\"cboValue\")",Emer_Response,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlCardArrestCombo\").WinFormsObject(\"cboValue\")",Cardiac_Arrest,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlICUAdmissionTypeCombo\").WinFormsObject(\"cboValue\")",Care_Type,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlCareUnitCombo\").WinFormsObject(\"cboValue\")",Care_UnitID,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlThromboembolismProphylaxisCombo\").WinFormsObject(\"cboValue\")",Throm_Propaxis,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlAgeTextbox\").WinFormsObject(\"txtValue\")",Age,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlWeightTextbox\").WinFormsObject(\"txtValue\")",Weight,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlHeightTextbox\").WinFormsObject(\"txtValue\")",Height,4,exestatus);
  
  if (Sex === "Unknown") {
   Sex = Sex +"*";
  }
  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlGenderCombo\").WinFormsObject(\"cboValue\")",Sex,1,exestatus);
  aqUtils.Delay(300);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlPregnancyStatusCombo\").WinFormsObject(\"cboValue\")",Preg_Status,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlIndigenousStatusCombo\").WinFormsObject(\"cboValue\")",Indigenous,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlPostcodeTextbox\").WinFormsObject(\"txtValue\")",Postcode,4,exestatus);
  exestatus = mvObjects.enterANZICSDateTimePicker(vProcess, "*WinFormsObject(\"ctlICUDischargeDateTime\")",ICU_DisDate,exestatus);
	exestatus = mvObjects.enterANZICSDateTimePicker(vProcess, "*WinFormsObject(\"ctlICUDischargeDecisionDateTime\")",ICU_DisDesDt,exestatus);
  exestatus = mvObjects.enterANZICSDateTimePicker(vProcess, "*WinFormsObject(\"ctlHospDischargeDateTime\")",Hos_DisDate,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlICUOutcomeCombo\").WinFormsObject(\"cboValue\")",ICU_Outcome,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlHospitalOutcomeCombo\").WinFormsObject(\"cboValue\")",Hos_Outcome,1,exestatus);
  
  // Tab 2 entry 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Chronic Health / Scoring",2,exestatus);
  aqUtils.Delay(300);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlAidsCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHEAids,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlHepaticFailureCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHEHepatic,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlLymphomaCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHELymphoma,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlMetastaticCancerCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHEMetastatic,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlLeukeamiaMyelomaCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHELeukaemia,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlImmunosuppressedCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHEImmuno,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlCirrhosisCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHECirrhosis,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlNoneOfTheAboveCheckbox\").WinFormsObject(\"checkBox\")",seqA3CHENone,3,exestatus);
  
  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlRespiratoryCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHERespiratory,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlCardiovascularCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHECardiovascular,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlLiverCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHELiver,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlRenalCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHE_Renal,3,exestatus);
   
    var  chkARF = false;
    if (vProcess.Find("Name", "Window(\"Static\"*)", 3000).Exists){
     var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
     Log.Checkpoint("ANZICS Addin Validation '"+msg+"'");
     chkARF = true
     exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\", 1)",exestatus);
     aqUtils.Delay(1000);
      }
      
  //Verify if the Renal(Dialysis) is already checked from the admission summary
  //If this is checked then make chkARF = true 
  var renalDialysisCheckedLareadyOrNot = vProcess.Find("FullName","*WinFormsObject(\"ctlRenalCheckbox\").WinFormsObject(\"checkBox\")",1000);
  
  if(renalDialysisCheckedLareadyOrNot.Checked == true) 
  {
    Log.Message("Renal Dialysis is checked already");
    chkARF = true;
  }
  
  //Verify that the diagnosis search button is visible then only enter diagnosis
  var searchDiagnosis = vProcess.Find("Name","WinFormsObject(\"btnSearch*\")",1000);
  
  var enterDiagnosisFlag = true;
  
  if(searchDiagnosis.Exists == false) 
  {
    Log.Message("Diagnosis search is not visible");
    enterDiagnosisFlag = false;
  }
   
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlImmuneSuppressiveDiseaseCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHEISD,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlImmunosuppressiveTherapyCheckbox\").WinFormsObject(\"checkBox\")",seqA2CHEIMT,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlNoneOfTheAbove2Checkbox\").WinFormsObject(\"checkBox\")",seqA2CHENone,3,exestatus);
  
    if  (Diagnosis === null || Diagnosis === "" || Diagnosis === undefined || enterDiagnosisFlag == false) {
          Log.Message("Diagnosis","No value is entered in the Diagnosis");      
  	}
    else {
          exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"btnSearch*\")",exestatus);
          exestatus = mvObjects.Fullnametext(vProcess,"*WinFormsObject(\"frmTBSearch\").WinFormsObject(\"textBox1\")",Diagnosis ,exestatus);
          exestatus = mvObjects.Fullnametext(vProcess,"*WinFormsObject(\"frmTBSearch\").WinFormsObject(\"textBox1\")", "[Enter]",exestatus);
          aqUtils.Delay(300);
          exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"frmTBSearch\").WinFormsObject(\"listBox1\")",Diagnosis+"*",1,exestatus);
          exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmTBSearch\").WinFormsObject(\"btnOK\")",exestatus);
         
          
           if   (equal(Diagnosis.substring(0,3),"107")) { 
              exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreThromboTherapyCombo\").WinFormsObject(\"cboValue\")",ThromTherapSts,1,exestatus);
                }
         if   (equal(Diagnosis.substring(0,4),"1207")) { 
             exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreCABGRedoCombo\").WinFormsObject(\"cboValue\")",FirstC,1,exestatus);
             exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreNoCABGGraftsTxt\").WinFormsObject(\"txtValue\")",NbrCorArt,4,exestatus);
              }
        }
       
        
        
  // Tab 3 entry 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Obs / GCS",2,exestatus);
  aqUtils.Delay(300);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowTemperature\").WinFormsObject(\"textBoxHigh\")",TempHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowTemperature\").WinFormsObject(\"textBoxLow\")",TempLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowHR\").WinFormsObject(\"textBoxHigh\")",HRHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowHR\").WinFormsObject(\"textBoxLow\")",HRLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowRR\").WinFormsObject(\"textBoxHigh\")",RRHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowRR\").WinFormsObject(\"textBoxLow\")",RRLow,4,exestatus); 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*.WinFormsObject(\"RRHi_VentCheckBox\")",HighRRInd,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*.WinFormsObject(\"RRLo_VentCheckBox\")",LowRRInd,3,exestatus); 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowMap\").WinFormsObject(\"textBoxHigh\")",MAPHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowMap\").WinFormsObject(\"textBoxLow\")",MAPLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowSystolic\").WinFormsObject(\"textBoxHigh\")",SysBPHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowSystolic\").WinFormsObject(\"textBoxLow\")",SysBPLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowDiastolic\").WinFormsObject(\"textBoxHigh\")",DisBPHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowDiastolic\").WinFormsObject(\"textBoxLow\")",DisBPLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlUrineOutputTextbox\").WinFormsObject(\"txtValue\")",UrineOut,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlPatientFreevoidingCheckbox\").WinFormsObject(\"checkBox\")",IspatVoid,3,exestatus);
  
  if (vProcess.Find("Name", "Window(\"Static\"*)", 1000).Exists){
        var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
        Log.Checkpoint("ANZICS Addin Validation '"+msg+"'");
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\", 1)",exestatus);
        aqUtils.Delay(300);
      }
      
  if (equal(chkARF,true)) {
   Log.Message("Acute Renal Failure Checkbox been disabled" );
  }
  else {
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlARFCheckbox\").WinFormsObject(\"checkBox\")",IsAcuteRenal,3,exestatus);
  }
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreINV_DAYONECheckBox\").WinFormsObject(\"checkBox\")",InvVent24hrs,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreINV_INDCheckBox\").WinFormsObject(\"checkBox\")",InvVent,3,exestatus);
   exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreNIV_INDCheckBox\").WinFormsObject(\"checkBox\")",NonInvVent,3,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreTrache_IndCheckBox\").WinFormsObject(\"checkBox\")",TrachICU,3,exestatus);     
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreSedationChk\").WinFormsObject(\"checkBox\")",GCSSedated,3,exestatus); 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"CtlScoreComplexCboGCS\").WinFormsObject(\"cboEye\")",Eye,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"CtlScoreComplexCboGCS\").WinFormsObject(\"cboMotor\")",Verbal,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"CtlScoreComplexCboGCS\").WinFormsObject(\"cboVerbal\")",Motor,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreECMO_INDCheckBox\").WinFormsObject(\"checkBox\")",ECMO,3,exestatus);  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreRENAL_INDCheckBox\").WinFormsObject(\"checkBox\")",RRT,3,exestatus);  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreINOTROP_INDCheckBox\").WinFormsObject(\"checkBox\")",Intrope,3,exestatus);  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreDIABETESCombo1\").WinFormsObject(\"cboValue\")",Diabetes,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreFrailtyCombo\").WinFormsObject(\"cboValue\")",Frailty,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreDeliriumCombo\").WinFormsObject(\"cboValue\")",Delirium,1,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScorePRESS_INJCombo\").WinFormsObject(\"cboValue\")",PresInjury,1,exestatus);
  
  // Tab 4 entry 
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Labs",2,exestatus);
  
  aqUtils.Delay(300);
  // add code for the labs data entry
  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowSodium\").WinFormsObject(\"textBoxHigh\")",NaHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowSodium\").WinFormsObject(\"textBoxLow\")",NaLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowPotassium\").WinFormsObject(\"textBoxHigh\")",KHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowPotassium\").WinFormsObject(\"textBoxLow\")",KLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowBicarbonate\").WinFormsObject(\"textBoxHigh\")",BicarbHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowBicarbonate\").WinFormsObject(\"textBoxLow\")",BicarbLow,4,exestatus);

    var chkHigh = vProcess.Find("FullName", "*WinFormsObject(\"ctlScoreHighLowCreatinineWithout\").WinFormsObject(\"textBoxHigh\")", 1000);
   
   if (chkHigh.Exists&& chkHigh.Visible) {
     exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowCreatinineWithout\").WinFormsObject(\"textBoxHigh\")",CreatHigh,4,exestatus);
     }
   else {
      exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowCreatinineWith\").WinFormsObject(\"textBoxHigh\")",CreatHigh,4,exestatus);
    }
  
  

  
  var chkLow = vProcess.Find("FullName", "*WinFormsObject(\"ctlScoreHighLowCreatinineWithout\").WinFormsObject(\"textBoxLow\")", 1000);
   
   if (chkLow.Exists&& chkLow.Visible) {
     exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowCreatinineWithout\").WinFormsObject(\"textBoxLow\")",CreatLow,4,exestatus);
     }
   else {
      exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowCreatinineWith\").WinFormsObject(\"textBoxLow\")",CreatLow,4,exestatus);
      } 
  
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowUrea\").WinFormsObject(\"textBoxHigh\")",Urea,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowAlbumin\").WinFormsObject(\"textBoxHigh\")",AlbHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowAlbumin\").WinFormsObject(\"textBoxLow\")",AlbLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowBilirubin\").WinFormsObject(\"textBoxHigh\")",Bilirubin,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowGlucose\").WinFormsObject(\"textBoxHigh\")",GluHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowGlucose\").WinFormsObject(\"textBoxLow\")",GluLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowHaematocrit\").WinFormsObject(\"textBoxHigh\")",HctHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowHaematocrit\").WinFormsObject(\"textBoxLow\")",HctLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowWCC\").WinFormsObject(\"textBoxHigh\")",WBCHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowWCC\").WinFormsObject(\"textBoxLow\")",WBCLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowTextbox2\").WinFormsObject(\"textBoxHigh\")",HbHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowTextbox2\").WinFormsObject(\"textBoxLow\")",HbLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowPlatelets\").WinFormsObject(\"textBoxHigh\")",PlateletsHigh,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowPlatelets\").WinFormsObject(\"textBoxLow\")",PlateletsLow,4,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"ctlScoreHighLowLactate\").WinFormsObject(\"textBoxHigh\")",HighLact,4,exestatus);
  
  // Again Clicking on tab to check information entered check,
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Admission / Discharge",2,exestatus);
  exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Chronic Health / Scoring",2,exestatus);
   exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Obs / GCS",2,exestatus);
   exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"tabControl\")","Labs",2,exestatus);
   
  
  if (equal(exestatus,true)) {
		  Log.Checkpoint("Successfully Entered all the details for ANZICS");
   
    }
  // Click on Ready for export and Click on Save
    exestatus = mvObjects.selectFullNameObjType(vProcess,"*WinFormsObject(\"chkReadyforExport\").WinFormsObject(\"checkBox\")","Yes",3,exestatus);  
    exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"btnSave\")",exestatus);
    
    aqUtils.Delay(300);
     // Validation code for warning in ANZICS Addin
 if (vProcess.Find("WndCaption", "Warnings", 1000).Exists){
        var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
        if (equal(WarningInd,"No")) { 
        Log.Checkpoint("ANZICS Validation, Expected - No Warnings , Actual - Warnings",msg);
        }
        if (equal(WarningInd,"Yes")) { 
        Log.Checkpoint("ANZICS Validation, Expected - Warnings , Actual - Warnings",msg);
        }
         exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\", 1)",exestatus);
        
        }
  else 
  {
     if (equal(WarningInd,"No")) { 
        Log.Checkpoint("ANZICS Validation, Expected - No Warnings , Actual - No Warnings");
        }
      if (equal(WarningInd,"Yes")) { 
        Log.Checkpoint("ANZICS Validation, Expected - Warnings , Actual - No Warnings");
        }
  }   
     // Validation code for error in ANZICS Addin
     if (vProcess.Find("WndCaption", "Errors", 1000).Exists){
        var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
          if (equal(ErrorInd,"No")) { 
        Log.Checkpoint("ANZICS Validation, Expected - No Errors , Actual - Errors",msg);
        }
        if (equal(ErrorInd,"Yes")) { 
        Log.Checkpoint("ANZICS Validation, Expected - Errors , Actual - Errors",msg);
        }
         exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\", 1)",exestatus);
        
        }
  else 
  {
     if (equal(ErrorInd,"No")) { 
        Log.Checkpoint("ANZICS Validation, Expected - No Errors , Actual - No Errors");
        }
      if (equal(ErrorInd,"Yes")) { 
        Log.Checkpoint("ANZICS Validation, Expected - Errors , Actual - No Errors");
        }
  }  
    
    // Validation code for save session in ANZICS Addin
    if (vProcess.Find("WndCaption", "Save Session", 1000).Exists){
        var msg =  mvObjects.getObjectProperty(vProcess, "Name", "Window(\"Static\"*)", "WndCaption",exestatus)
        Log.Message("ANZICS Saving Session Popup ",msg);
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"&No\", 2)",exestatus);
        
        Log.Checkpoint("Successfully saved all the details for ANZICS");
     }
  
     
  }
  else {
  Log.Message("Skipped ANZICS Addin form ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MVExcel
// Desc :Function to execute HL7 message validation
// Owner :Ragurathan S
// Creation date:21-Nov-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVExcel(TestName,exestatus)
{
//   Check for pre-existing Excel and kill it if it exists:

   var old = Sys.WaitProcess("excel", 100) ;

   if(old.Exists)

   {

      if (!old.Close())

      {

        Log.Warning("Excel was not closed successfully and will be terminated.") ;

        // Close Excel:

        old.Terminate() ;

      }


   }

//var filename = "C:\\Ragu\\eRIC_TestAutomation_Data.xls";   
var Excel = Sys.OleObject("Excel.Application");
Excel.Workbooks.Open("C:\\Ragu\\eRIC_TestAutomation_Data.xlsm");
Excel.Visible = false;
Excel.Run("ThisWorkbook.CreateHL7");

}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvReleasePatient
// Desc :Function to release patient on MV
// Owner :Satheeshkumar C
// Creation date: 22 Nov 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


// Feature created to release patient in MV
function MvReleasePatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


//var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
Log.Checkpoint("Start of Release a Patient ","The flow is started");
	
  //Start of the feature 
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open patient file
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
  
	// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

     
		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
		// Enter the Status
		exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Released",exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient released since the unit discharge date updated in Medical summary",exestatus);
		frmPatientRegistration.WinFormsObject("picButtonsContainer").WinFormsObject("cmdOK").Click()
     //var MsgForm = vProcess.Find("Name", "WinFormsObject(\"Message\")", 1000);
     
    

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient Status changed to released successfully");
      Log.Checkpoint("End release a patient MV","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Release a Patient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientDeathDateTime
// Desc :Feature  to enter patient death date and time
// Owner :Satheeshkumar C
// Creation date: 22 Nov 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvPatientDeathDateTime(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");

Log.Checkpoint("To update the patient death date and time ","The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
   
//var DeathTime = Data.getData(TestName,"Patient","DeathTime");
	// Open Patient Admission/Discharge Times
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Admission/Discharge Times");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"*Admission/Discharge Times*\", 1)", 120,exestatus);
  
  let PatientDemo = new Object();
  
  PatientDemo.DeathDate = Data.getData(TestName,"Patient","DeathDate")
        DTDay = aqDateTime.GetDay(PatientDemo.DeathDate);
	      DTMonth = aqDateTime.GetMonth(PatientDemo.DeathDate);
	      DTYear= aqDateTime.GetYear(PatientDemo.DeathDate);
        
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", DTDay,DTMonth,DTYear,"00","00",exestatus); 
//exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", "00","00","0000","12","00",exestatus); 
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"dtpDate_3\")",DeathTime ,exestatus);
     
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);    

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient death time and date updated successfully");
      Log.Checkpoint("End of updating patient death time and date","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped updating Patient death time and date","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MVNursingDischargeSummary
// Desc :Feature to document Nursing Discharge Summary 
// Owner :Satheeshkumar C
// Creation date:23 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MVNursingDischargeSummary(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
Log.Checkpoint("Start of documenting Nursing Discharge Summary for "+tcDesc ,"The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// To select the Nursing Discharge Summary  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Discharge Summary");
	
  // Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtFreeText_3\")", 120,exestatus);
		
    // ** Fill in the details for  Nursing Discharge Summary
	Log.Message("***Enter details for Nursing Discharge Summary***");
  
  var Weight = Data.getData(TestName,"OtherCare","Weight");
  var Height = Data.getData(TestName,"OtherCare","Height");
  
  var PrConNotified= Data.getData(TestName,"OtherCare","PrConNotified");
  var ReviewSolWork= Data.getData(TestName,"OtherCare","ReviewSolWork");
  var FamConfAttend= Data.getData(TestName,"OtherCare","FamConfAttend");
  var ConComment= Data.getData(TestName,"OtherCare","ConComment");

  var EyeResp= Data.getData(TestName,"OtherCare","EyeResp");
  var Verbres= Data.getData(TestName,"OtherCare","Verbres");
  var MotorResponse = Data.getData(TestName,"OtherCare","MotorResponse");
  var NPainSclRst= Data.getData(TestName,"OtherCare","NPainSclRst");
  var NumPnSlMovemnt= Data.getData(TestName,"OtherCare","NumPnSlMovemnt");
  var PCA = Data.getData(TestName,"OtherCare","PCA");

 var RespAirwy = Data.getData(TestName,"OtherCare","RespAirwy");
 var O2DelDev = Data.getData(TestName,"OtherCare","O2DelDev");
 var FlowO2 = Data.getData(TestName,"OtherCare","FlowO2");
 var Fio2Set = Data.getData(TestName,"OtherCare","Fio2Set");
 var SPO2 = Data.getData(TestName,"OtherCare","SPO2");
 var RespRate = Data.getData(TestName,"OtherCare","RespRate");
 var AmtSputm = Data.getData(TestName,"OtherCare","AmtSputm");
 var SptmColor = Data.getData(TestName,"OtherCare","SptmColor");
 var ConsisSptm = Data.getData(TestName,"OtherCare","ConsisSptm");
 var Humdifica = Data.getData(TestName,"OtherCare","Humdifica");
 var ChstPhsiReq = Data.getData(TestName,"OtherCare","ChstPhsiReq");
 var TrachTyp = Data.getData(TestName,"OtherCare","TrachTyp");
 var SzeTracho = Data.getData(TestName,"OtherCare","SzeTracho");
 var InnerConntac = Data.getData(TestName,"OtherCare","InnerConntac");
 var CuffPresu = Data.getData(TestName,"OtherCare","CuffPresu");
 var CareTrachos = Data.getData(TestName,"OtherCare","CareTrachos");

 var CardiRythm = Data.getData(TestName,"OtherCare","CardiRythm");
 var sABP = Data.getData(TestName,"OtherCare","sABP");
 var dABP = Data.getData(TestName,"OtherCare","dABP");
 var mABP = Data.getData(TestName,"OtherCare","mABP");
 var HR = Data.getData(TestName,"OtherCare","HR");
 var sNIBP = Data.getData(TestName,"OtherCare","sNIBP");
 var dNIBP = Data.getData(TestName,"OtherCare","dNIBP");
 var mNIBP = Data.getData(TestName,"OtherCare","mNIBP");

 var BGL = Data.getData(TestName,"OtherCare","BGL");
 var Temprature = Data.getData(TestName,"OtherCare","Temprature");
 var SourceTemp = Data.getData(TestName,"OtherCare","SourceTemp");


 var PatintFeedRout = Data.getData(TestName,"OtherCare","PatintFeedRout");
 var PatientFdType = Data.getData(TestName,"OtherCare","PatientFdType");
 var CurFedRte = Data.getData(TestName,"OtherCare","CurFedRte");
 var FeedGoalRate = Data.getData(TestName,"OtherCare","FeedGoalRate");
 var SpeechPathAssemnt = Data.getData(TestName,"OtherCare","SpeechPathAssemnt");
 var Comments = Data.getData(TestName,"OtherCare","Comments");

 var UrinDevicTyp = Data.getData(TestName,"OtherCare","UrinDevicTyp");
 var IDCSize = Data.getData(TestName,"OtherCare","IDCSize");
 var TypIDC = Data.getData(TestName,"OtherCare","TypIDC");
 var PassUrnPastRmo = Data.getData(TestName,"OtherCare","PassUrnPastRmo"); 

 var PressCareFrq = Data.getData(TestName,"OtherCare","PressCareFrq");
 
 var MobilityAid = Data.getData(TestName,"OtherCare","MobilityAid");
 var FallSinceAdmis = Data.getData(TestName,"OtherCare","FallSinceAdmis");

 var UntOutCome = Data.getData(TestName,"OtherCare","UntOutCome");
 var DesgtiUnidis = Data.getData(TestName,"OtherCare","DesgtiUnidis");

 var MediChartComp = Data.getData(TestName,"OtherCare","MediChartComp");
 var MdOrderComle = Data.getData(TestName,"OtherCare","MdOrderComle");
 var InsulinSlideScl = Data.getData(TestName,"OtherCare","InsulinSlideScl");
 var IDBrandPresnt = Data.getData(TestName,"OtherCare","IDBrandPresnt");
 var OldNteOrImg = Data.getData(TestName,"OtherCare","OldNteOrImg");
 var ChecklisAle = Data.getData(TestName,"OtherCare","ChecklisAle");
 var PatntBelong = Data.getData(TestName,"OtherCare","PatntBelong");

 var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
var ReasonForAdmission = Data.getData(TestName,"MedicalCare","ReasonForAdmission");
var PastMedicalHis = Data.getData(TestName,"MedicalCare","PastMedicalHis");
var bmi = Data.getData(TestName,"MedicalCare","bmi");
var bsa = Data.getData(TestName,"MedicalCare","bsa");

var tcDesc = Data.getData(TestName,"NursingCare","TC_DESC");
var NurseHand = Data.getData(TestName,"NursingCare","NurseHand");
var NurseReci = Data.getData(TestName,"NursingCare","NurseReci");

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
var PC_Rel_Pat = Data.getData(TestName,"Patient","PC_Rel_Pat");
var PC_Gname = Data.getData(TestName,"Patient","PC_Gname");
var PC_Fname = Data.getData(TestName,"Patient","PC_Fname");


// To validate the prepopulated values

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",ReasonForAdmission,"ReasonForAdmission",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",PastMedicalHis,"PastMedicalHis",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",PC_Gname,"PriGveNm",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",PC_Fname,"PConLastNm",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_7\")", "Text",PC_Rel_Pat,"RlToPatient",exestatus);

// To enter the input details for Weight and dimension

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Height,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Weight,exestatus);


// To enter input details for Social

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",PrConNotified,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",ReviewSolWork,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_8\")",FamConfAttend,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_9\")",ConComment,exestatus);

let NursingDischarge = new Object();
        NursingDischarge.LstFamConfe = Data.getData(TestName,"OtherCare","LstFamConfe")
        Day = aqString.substring( NursingDischarge.LstFamConfe, 0, 2);
	      month = aqString.substring(NursingDischarge.LstFamConfe, 3, 2);
//	     year = aqString.substring(NursingDischarge.LstFamConfe, 6, 4); 
//  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", Day,month,"2017","09","45",exestatus);


// To enter input details for Clinical data tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);


// To details for neurological observation

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",EyeResp,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",Verbres,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",MotorResponse,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",NPainSclRst,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_7\")",NumPnSlMovemnt,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_2\")",PCA,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_11\")",Comments,exestatus);

// To details for Respiratory

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_8\")",RespAirwy,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",O2DelDev,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",FlowO2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",Fio2Set,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",SPO2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",RespRate,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_10\")",AmtSputm,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox", SptmColor,exestatus);

exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_6\").WPFObject(\"picFrameIn_6\").WPFObject(\"picTextList_1\").WPFObject(\"cboTextComboMulti_1\")","ImdCheckedComboBox", SptmColor,exestatus, 1);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_12\")",Humdifica,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",ConsisSptm,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",ChstPhsiReq,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_13\")",TrachTyp,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_7\")",SzeTracho,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_14\")",InnerConntac,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_8\")",CuffPresu,exestatus);
//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_5\").WPFObject(\"picFrameIn_5\").WPFObject(\"picTextList_2\").WPFObject(\"cboTextComboMulti_2\")","ImdCheckedComboBox", CareTrachos,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_6\").WPFObject(\"picFrameIn_6\").WPFObject(\"picTextList_2\").WPFObject(\"cboTextComboMulti_2\")","ImdCheckedComboBox", CareTrachos,exestatus, 1);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_12\")",Comments,exestatus);

        NursingDischarge.TraInserDate = Data.getData(TestName,"OtherCare","TraInserDate")
        InstDay = aqString.substring(NursingDischarge.TraInserDate, 0, 2);
	Instmonth = aqString.substring(NursingDischarge.TraInserDate, 3, 2);
	Instyear = aqString.substring(NursingDischarge.TraInserDate, 6, 4); 
  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", InstDay,Instmonth,Instyear,"00","00",exestatus);

        NursingDischarge.TraRemovDte = Data.getData(TestName,"OtherCare","TraRemovDte")
        RemoDay = aqString.substring(NursingDischarge.TraRemovDte, 0, 2);
	Remomonth = aqString.substring(NursingDischarge.TraRemovDte, 3, 2);
	Remoyear = aqString.substring(NursingDischarge.TraRemovDte, 6, 4); 
  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", RemoDay,Remomonth,Remoyear,"00","00",exestatus);


// To enter details for cardiovascular

exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_7\").WPFObject(\"picFrameIn_7\").WPFObject(\"picTextList_3\").WPFObject(\"cboTextComboMulti_3\")","ImdCheckedComboBox", CardiRythm,exestatus, 1);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_12\")",HR,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_9\")",sABP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_10\")",dABP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_11\")",mABP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_13\")",sNIBP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_14\")",dNIBP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_15\")",mNIBP,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_13\")",Comments,exestatus);

// To enter details for metabolic
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_14\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_16\")",BGL,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_17\")",Temprature,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_15\")",SourceTemp,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_14\")",Comments,exestatus);


// To enter input details for Gastro
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_15\")",exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_9\").WPFObject(\"picFrameIn_9\").WPFObject(\"picTextList_4\").WPFObject(\"cboTextComboMulti_4\")","ImdCheckedComboBox", PatintFeedRout,exestatus, 1);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_18\")",CurFedRte,exestatus);

        NursingDischarge.LstFamConfe = Data.getData(TestName,"OtherCare","LstFamConfe")
        Day = aqString.substring( NursingDischarge.LstFamConfe, 0, 2);
	      month = aqString.substring(NursingDischarge.LstFamConfe, 3, 2);
	      year = aqString.substring(NursingDischarge.LstFamConfe, 6, 4); 
        exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_4\")", Day,month,year,"10","45",exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_9\").WPFObject(\"picFrameIn_9\").WPFObject(\"picTextList_5\").WPFObject(\"cboTextComboMulti_5\")","ImdCheckedComboBox", PatientFdType,exestatus, 1);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_19\")",FeedGoalRate,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_16\")",SpeechPathAssemnt,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_15\")",Comments,exestatus);

// To enter details for Renal
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_16\")",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_17\")",UrinDevicTyp,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_18\")",IDCSize,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_19\")",TypIDC,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_20\")",PassUrnPastRmo,exestatus);


        NursingDischarge.TraInserDate = Data.getData(TestName,"OtherCare","TraInserDate")
        InstDay = aqString.substring(NursingDischarge.TraInserDate, 0, 2);
	Instmonth = aqString.substring(NursingDischarge.TraInserDate, 3, 2);
	Instyear = aqString.substring(NursingDischarge.TraInserDate, 6, 4); 
  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_5\")", InstDay,Instmonth,Instyear,"11","45",exestatus);


        NursingDischarge.TraRemovDte = Data.getData(TestName,"OtherCare","TraRemovDte")
        RemoDay = aqString.substring(NursingDischarge.TraRemovDte, 0, 2);
	Remomonth = aqString.substring(NursingDischarge.TraRemovDte, 3, 2);
	Remoyear = aqString.substring(NursingDischarge.TraRemovDte, 6, 4); 
  exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_6\")", RemoDay,Remomonth,Remoyear,"10","45",exestatus);
 
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_16\")",Comments,exestatus);

// To enter details for integumentry
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_19\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_17\")",Comments,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_21\")",PressCareFrq,exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_20\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_19\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_20\")",Comments,exestatus);

    //Verify pressure injury risk assessment
    var totalScore = Data.getData(TestName,"Othercare","TotalScore");

    var totalScoreField = vProcess.Find("Name", "WPFObject(\"txtFreeText_18\")", 1000);
    totalScoreValue =  aqObject.GetPropertyValue(totalScoreField, "Text");
  	if (aqString.Find(totalScore, totalScoreValue) != -1) 
    {
  		Log.Checkpoint("Found expected value: "+ totalScore);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ totalScore +", not found. Found: "+ totalScoreValue);
  		exestatus = false;
  	}


//To enter details for mobility
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_21\")",exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_2\").WPFObject(\"picFrame_13\").WPFObject(\"picFrameIn_13\").WPFObject(\"picTextList_6\").WPFObject(\"cboTextComboMulti_6\")","ImdCheckedComboBox", MobilityAid,exestatus, 1);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_21\")",Comments,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_4\")",FallSinceAdmis,exestatus);


// To enter details for Check list tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 3)",exestatus);

// To enter details for discharge information

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_22\")",UntOutCome,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_23\")",DesgtiUnidis,exestatus);


// To enter details for checklist

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_24\")",MediChartComp,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_25\")",MdOrderComle,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_5\")",InsulinSlideScl,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_26\")",OldNteOrImg,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"picTabs\").WPFObject(\"picTab_3\").WPFObject(\"picFrame_16\").WPFObject(\"picFrameIn_16\").WPFObject(\"picTextList_7\").WPFObject(\"cboTextComboMulti_7\")","ImdCheckedComboBox", ChecklisAle,exestatus, 1);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_6\")",IDBrandPresnt,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_27\")",PatntBelong,exestatus);

// To enter details for Signature

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_26\")",NurseHand,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_27\")",NurseReci,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"chkBoolean_1\")",exestatus);


   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus);   
	
  // save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
   
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
	// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
    }
  
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Nursing Discharge Summary");
  //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
	// Validation of documented values
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus)

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_8\")", "Text",FamConfAttend,"FamConfAttend",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_9\")", "Text",ConComment,"ConComment",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 2)",exestatus);

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_11\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_12\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_13\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_14\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_15\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_16\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_17\")", "Text",Comments,"Comments",exestatus);
//exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_18\")", "Text",Comments,"Comments",exestatus);
exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_20\")",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_19\")", "Text",Comments,"Comments",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_20\")", "Text",Comments,"Comments",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"DXTabItem\", \"\", 3)",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_23\")", "Text",DesgtiUnidis,"DesgtiUnidis",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_26\")", "Text",NurseHand,"NurseHand",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_27\")", "Text",NurseReci,"NurseReci",exestatus);



	// close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

  // To validate the values in Weight and Dimensions
  exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Weights and Dimensions");
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",Height, "Height",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value",Weight, "WeightLatest",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",bmi, "bmi",exestatus);  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",bsa, "bsa",exestatus);
  
  // close the form 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"No\")",exestatus);
    }
    
  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Nursing Discharge Summary");
      Log.Checkpoint("End of Documenting Nursing Discharge Summary","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Documenting Nursing Discharge Summary","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvAdvancedSearchPatient
// Desc :Function to search a patient  on MV with multiple parameter
// Owner :Satheeshkumar C
// Creation date:27-Nov-17
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvAdvancedSearchPatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Patient");

var tcDesc =Data.getData(TestName,"Patient","TC_DESC");
var FirstName = Data.getData(TestName,"Patient","FirstName");
var MRN = Data.getData(TestName,"Patient","MRN");
var LastName = Data.getData(TestName,"Patient","LastName");


var tcDesc =Data.getData(TestName,"OtherCare","TC_DESC");
var NoOfParameters = Data.getData(TestName,"OtherCare","NoOfParameters");
var Row1Field = Data.getData(TestName,"OtherCare","Row1Field");
var Row1FieldOperator = Data.getData(TestName,"OtherCare","Row1FieldOperator");
var Row1Value = Data.getData(TestName,"OtherCare","Row1Value");
var Row2Condition = Data.getData(TestName,"OtherCare","Row2Condition");
var Row3Condition = Data.getData(TestName,"OtherCare","Row3Condition");
var Row2Field = Data.getData(TestName,"OtherCare","Row2Field");
var Row2FieldOperator = Data.getData(TestName,"OtherCare","Row2FieldOperator");
var Row2Value = Data.getData(TestName,"OtherCare","Row2Value");
var Row3Field = Data.getData(TestName,"OtherCare","Row3Field");
var Row3FieldOperator = Data.getData(TestName,"OtherCare","Row3FieldOperator");
var Row3Value = Data.getData(TestName,"OtherCare","Row3Value");
var Row4Field = Data.getData(TestName,"OtherCare","Row4Field");
var Row4FieldOperator = Data.getData(TestName,"OtherCare","Row4FieldOperator");
var Row4Value = Data.getData(TestName,"OtherCare","Row4Value");

//Log.Message("MRN details "+MRN);
Log.Checkpoint("Start MV Advanced Search Patient","The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");
  exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

	//Checks or unchecks the specified menu item.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|Patient Search");
  
        exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"PatientSearchViewModel\")", 120,exestatus);
        exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"TextBlock \", \"Advanced search\", 1)",exestatus);


 
for (i = 1; i <= NoOfParameters; i++) {
switch(i){
case 1:
{
// Enter input details for 1st row
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridCellContentPresenter\", \"\", 2).WPFObject(\"PART_Editor\")",Row1Field,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"PART_Editor\")",Row1FieldOperator,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"PART_Editor\")",Row1Value,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
aqUtils.Delay(3000);
break;
}
case 2:
{
// Enter input details for 2nd row
//exestatus = mvObjects.selectFullNameObjType(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 1).WPFObject(\"PART_Editor\")","Or","4",exestatus);
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 1).WPFObject(\"PART_Editor\")",Row2Condition,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 2).WPFObject(\"PART_Editor\")",Row2Field,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"PART_Editor\")",Row2FieldOperator,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"GridRow\", \"\", 2).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"PART_Editor\")",Row2Value,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
aqUtils.Delay(3000);
break;
}

case 3:
{
// Enter input details for 3rd row
//exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 3).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 1).WPFObject(\"PART_Editor\")",Row3Condition,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 3).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 2).WPFObject(\"PART_Editor\")",Row3Field,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 3).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"PART_Editor\")",Row3FieldOperator,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 3).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"PART_Editor\")",Row3Value,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
aqUtils.Delay(3000);
break;
}
case 4:
{
// Enter input details for 4th row
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 4).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 2).WPFObject(\"PART_Editor\")",Row4Field,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 4).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 3).WPFObject(\"PART_Editor\")",Row4FieldOperator,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"Border\", \"\", 2).WPFObject(\"Grid\", \"\", 1).WPFObject(\"grid\").WPFObject(\"tableView\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 4).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"PART_Editor\")",Row4Value,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
aqUtils.Delay(3000);
//break;
}
default:
Log.Message("No of parameters is greater than 4");

}
}

	//exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"ImdButton\", \"Find\", 1)",exestatus);
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  //Log.Message(RowCount)
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
   //Log.Message("value of counter" + i);
  // Log.Message( "value of row id "+ j);
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 4)", 1000);  
	var searchMRN = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientName = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchName = admittedPatientListPatientName.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientStatus = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 6)", 1000);  
	var searchStatus = admittedPatientListPatientStatus.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
	
	var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
  var listName = aqObject.GetPropertyValue(searchName, "Text");
  var listStatus = aqObject.GetPropertyValue(searchStatus, "Text");
  
	//var freePatientBed = getEmptyBedFromAdmittedPatientList();  
	Log.Message("Patient MRN: "+ listMRN);
  Log.Message("Patient Name: "+ listName );
  Log.Message("Patient Status: "+ listStatus );
  
switch (NoOfParameters){
  
  case ("1"):{
  
  if (aqString.Contains(listMRN, MRN) != -1 ) {
		admittedPatientList.DblClick();
	
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To load the patient details.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient with given MRN is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
 case ("2"):{
 
  if (aqString.Contains(listMRN, MRN) != -1 && aqString.Contains(listName,FirstName)!= -1 ) {
		admittedPatientList.DblClick();
	
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To load the patient details.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient with given MRN and First Name  is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("3"):{
  
  if (aqString.Contains(listMRN, MRN) != -1 && aqString.Contains(listName,FirstName)!= -1 && aqString.Contains(listName,LastName) != -1) {
  
  admittedPatientList.DblClick();
	
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To load the patient details.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient with given MRN ,First Name and Last Name is found");
    k = 1
    break;
    
	        }
     k = 0;     
  
  }
  
  case ("4"):{      
        if (aqString.Contains(listMRN, MRN) != -1 && aqString.Contains(listName,FirstName)!= -1 && aqString.Contains(listName,LastName) != -1 && aqString.Contains(listStatus,Row4Value) != -1) {
        
        admittedPatientList.DblClick();
	
      var ms = 5000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To load the patient details.";
      aqUtils.Delay (ms, HelpStr);
        Log.CheckPoint("Patient with given MRN ,First Name ,Last Name and Patient status is found");
    k = 1
    break;
    
	        }
         k = 0;
  
     }
  break;
  
  
   }
  
  
 
	}
  
	control = vProcess.Find("Name","WPFObject(\"btnClose\")", 1000);
	if (control.Exists )
	{
		exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"btnClose\")",exestatus);
		}
    
		control = vProcess.Find("Name", "WPFObject(\"view\")", 1000);
	if (control.Visible) {
  	  control = vProcess.Find("ToolTip", "Close", 1000);
  	  control.click();
       	}
  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }
			
	

	 
  if (equal(exestatus,true)) {
	 
      Log.Checkpoint("End MV Advance Search Patient","The flow is completed");
      
	    }
  }
  else {
  Log.Message("Skipped  MV Advance Search Patient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvChronologicalPrint
// Desc :Feature  to print the form in Chronological format
// Owner :Satheeshkumar C
// Creation date: 28 Nov 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvChronologicalPrint(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");

Log.Checkpoint("Feature to print the form via chronologicalo Option ","The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
   
var TimeSettings = Data.getData(TestName,"OtherCare","TimeSettings");
var SessionSettings = Data.getData(TestName,"OtherCare","SessionSettings");
var FormatSettings = Data.getData(TestName,"OtherCare","FormatSettings");


	// Open Patient Chronological Printing Tool
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Chronological Printing Tool");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"optEntireCase\")", 120,exestatus);
  
// To select the time settings radio button
switch(TimeSettings){

case ("Entire case"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optEntireCase\")",exestatus);
break;

case ("Today"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optToday\")",exestatus);
break;

case ("Yesterday"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optYesterday\")",exestatus);
break;

case ("Last 24 hrs"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optLast24hr\")",exestatus);
break;

case ("Last 48 hrs"):
exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optLast48hr\")",exestatus);
break; 

case ("Custom"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optCustome\")",exestatus);
let Choronological = new Object();
        Choronological.TimeSetFromTime = Data.getData(TestName,"OtherCare","TimeSetFromTime")
        Day = aqString.substring( Choronological.TimeSetFromTime, 0, 2);
	      month = aqString.substring(Choronological.TimeSetFromTime, 3, 2);
        year = aqString.substring(Choronological.TimeSetFromTime, 6, 4); 
       exestatus =  mvObjects.enterDateTimeNotEmpty(vProcess, "WinFormsObject(\"dtFromTime\")",Day ,month,year,"09","45",exestatus);
      
        Choronological.TimeSetToTime = Data.getData(TestName,"OtherCare","TimeSetToTime")
        Day = aqString.substring( Choronological.TimeSetToTime, 0, 2);
	      month = aqString.substring(Choronological.TimeSetToTime, 3, 2);
        year = aqString.substring(Choronological.TimeSetToTime, 6, 4); 
        exestatus =  mvObjects.enterDateTimeNotEmpty(vProcess, "WinFormsObject(\"dtToTime\")",Day ,month,year,"10","45",exestatus);

break; 

default:
Log.Message("Did not enter Time settings values");
}

// To select the session settings radio button

switch(SessionSettings){

case ("All sessions"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optALl\")",exestatus);
break;

case ("Full disclosure"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"optFullDisclosure\")",exestatus);
break;

default:
Log.Message("Did not enter Session settings values");

}


// To select the format settings radio button

switch(FormatSettings){

case ("Hide Tab Header(s)"):

exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"chkHideTabs\")",exestatus);
break;

case ("Hide Frame Header(s)"):
exestatus = mvObjects.buttonClick(vProcess, "Name","WinFormsObject(\"chkHideFrames\")",exestatus);
break;

default:
Log.Message("Did not enter format settings values");

}

// To select the preview button
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmPrintForms\").WinFormsObject(\"cmdPreview\")",exestatus);  
aqUtils.Delay(10000);

var MsgForm = vProcess.Find("Name", "Window(\"#32770\", \"Chronological Printing\", 1)", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\", \"OK\", 1)",exestatus);
    }
  else{
//Close the PDF window
var PDFWindow=Sys.Process("iMDSoft.Metavision").WinFormsObject("PrintPreviewFormExBase");
PDFWindow.Close();
}
// To close the chronological window
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmPrintForms\").WinFormsObject(\"cmdClose\")",exestatus);
  

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully previewed and printed forms");
      Log.Checkpoint("End of previewing and priting different forms","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Chronological feature","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvIntraAorticBalloonCatheter
// Desc :Feature to document the Intra Aortic Balloon Catheter
// Owner :Satheeshkumar C
// Creation date:
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 

function MvIntraAorticBalloonCatheter(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of documenting Intra Aortic Balloon Catheter for "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

// To select the Intra Aortic Balloon Catheter from medical menu
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Lines","Arterial Catheter","Intra-aortic balloon catheter");
	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);

// To select the attachment button
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
    
    
// ** Fill in the details for Intra Aortic Balloon Catheter **
Log.Message("***Enter details for Intra Aortic Balloon Catheter ***");
	

var ProcedureLoca  = Data.getData(TestName,"HandOver","ProcedureLoca");
var InsertBy  = Data.getData(TestName,"HandOver","InsertBy");
var IABPModel  = Data.getData(TestName,"HandOver","IABPModel");
var CatheterSize  = Data.getData(TestName,"HandOver","CatheterSize");
var IABPSize  = Data.getData(TestName,"HandOver","IABPSize");
var InsertDpth  = Data.getData(TestName,"HandOver","InsertDpth");
var FinalTipLocat  = Data.getData(TestName,"HandOver","FinalTipLocat");
var Comments  = Data.getData(TestName,"HandOver","Comments");

var LocaRemo  = Data.getData(TestName,"HandOver","LocaRemo");
var RemovedBy = Data.getData(TestName,"HandOver","RemovedBy");
var TypPrsApp = Data.getData(TestName,"HandOver","TypPrsApp");


// To enter input details for insertion

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ProcedureLoca,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",InsertBy ,exestatus);

let IABCathe = new Object();
        IABCathe.InsertOrRemovDate = Data.getData(TestName,"HandOver","InsertOrRemovDate")
       Day = aqString.substring( IABCathe.InsertOrRemovDate, 0, 2);
	     month = aqString.substring(IABCathe.InsertOrRemovDate, 3, 2);
	     year = aqString.substring(IABCathe.InsertOrRemovDate, 6, 4); 
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", Day,month,year,"09","45",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",IABPModel,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",CatheterSize,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",IABPSize,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",InsertDpth ,exestatus);

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus); 

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",FinalTipLocat ,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Comments ,exestatus);

// To enter input details for removal

exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",LocaRemo,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",RemovedBy ,exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", Day,month,year,"15","30",exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",TypPrsApp,exestatus);

        IABCathe.TimePreAppAndRemo = Data.getData(TestName,"HandOver","TimePreAppAndRemo")
        TMDay = aqString.substring( IABCathe.TimePreAppAndRemo, 0, 2);
	     TMmonth = aqString.substring(IABCathe.TimePreAppAndRemo, 3, 2);
	     TMyear = aqString.substring(IABCathe.TimePreAppAndRemo, 6, 4); 
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", TMDay,TMmonth,TMyear,"10","45",exestatus);
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_4\")", TMDay,TMmonth,TMyear,"16","30",exestatus);

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"picTextList_3\").WPFObject(\"lstTextList_3\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Comments ,exestatus);

// To save and close the form

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);

// To open the form again
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

// Validation of documented values
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",ProcedureLoca,"ProcedureLoca",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_2\")", "Text",InsertBy, "InsertBy",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")","Text",IABPModel,"IABPModel",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",CatheterSize,"CatheterSize",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")","Text",IABPSize,"IABPSize",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",InsertDpth, "InsertDpth",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_3\")", "Text",FinalTipLocat, "FinalTipLocat",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_4\")", "Text",Comments, "Comments",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",LocaRemo,"LocaRemo",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_5\")", "Text",RemovedBy, "RemovedBy",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_6\")","Text",TypPrsApp,"TypPrsApp",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_6\")", "Text",Comments, "Comments",exestatus);
   
 // To close the form
 
 exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"cmdCancel\")",exestatus);
  
 // To initiate the catherter
exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
aqUtils.Delay(2000);   
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
aqUtils.Delay(2000);   
   

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully initiated Intra Aortic Balloon Catheter");
      Log.Checkpoint("End of Intra Aortic Balloon Catheter","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Intra Aortic Balloon Catheter","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvSubduralDrain
// Desc :Feature to document the Subdural Drain
// Owner :Satheeshkumar C
// Creation date:01-Dec-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 

function MvSubduralDrain(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of Subdural Drain for "+tcDesc ,"The flow is started");
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

   // To select the Subdural drain
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Drains","Neurological","Subdural Drain (Left)");
	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);

  // To select the attachment button
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
   
// To check for the mandatory validation 
 exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
 
 //var SubDuralMandMsg = Data.getData(TestName,"HandOver","SubDuralMandMsg");
 var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName", "*WinFormsObject(\"ImdFormBase\").WinFormsObject(\"Message\")","Text",SubDuralMandMsg, "MandatoryValidationMessage",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    }
    
// ** Fill in the details for Subdural drain **
Log.Message("***Enter details for Subdural drain ***");
	
var DrainageVolume  = Data.getData(TestName,"HandOver","DrainageVolume");
var TotalVolumeInDrain = Data.getData(TestName,"HandOver","TotalVolumeInDrain");
var LevelofBru = Data.getData(TestName,"HandOver","LevelofBru"); 
var DrainRef = Data.getData(TestName,"HandOver","Drain Reference");
var DrainStaus = Data.getData(TestName,"HandOver","DrainStaus");
var DrainageDes = Data.getData(TestName,"HandOver","DrainageDes");

  
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",DrainageVolume,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",TotalVolumeInDrain ,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",LevelofBru ,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",DrainRef,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",DrainStaus,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",DrainageDes,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 4)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Subdural Drain Saved Time: "+ timeSavedValue);

// Save and close the form
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);

// To open the form again
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);

//To validate the documented values
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",DrainageVolume, "DrainageVolume",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value",TotalVolumeInDrain, "TotalVolumeInDrain",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",LevelofBru, "LevelofBru",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",DrainRef,"DrainRef",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")","Text",DrainStaus,"DrainStaus",exestatus);  
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",DrainageDes,"DrainageDes",exestatus);  

// To close the form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

 // To initiate the drain
exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
aqUtils.Delay(2000);   
    
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
aqUtils.Delay(2000);   
   

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully initiated Subdural Drain");
      Log.Checkpoint("End of Subdural Drain","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Subdural Drain initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvBalloonTamponadeDevice
// Desc :Feature to document the Balloon Tamponade Device
// Owner :Satheeshkumar C
// Creation date:04-Dec-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 

function MvBalloonTamponadeDevice(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of documenting Balloon Tamponade Device for "+tcDesc ,"The flow is started");
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

   // To select the Balloon Tamponade Device
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Tubes","Gastrointestinal","Balloon Tamponade Device");
	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)", 120,exestatus);

  // To select the attachment button
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
   
// To check for the mandatory validation 
 exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
 
 
 var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Ok\")",exestatus);
    }
    
// ** Fill in the details for Balloon Tamponade Device **
Log.Message("***Enter details for Balloon Tamponade Device ***");
	

var Size  = Data.getData(TestName,"HandOver","Size");
var PosiAtTeeth  = Data.getData(TestName,"HandOver","PosiAtTeeth");
var GasBallInfaVlm  = Data.getData(TestName,"HandOver","GasBallInfaVlm");
var Traction  = Data.getData(TestName,"HandOver","Traction");
var DrainageVolume  = Data.getData(TestName,"HandOver","DrainageVolume");
var DrainageDes = Data.getData(TestName,"HandOver","DrainageDes");
var Duration = Data.getData(TestName,"HandOver","Duration");
var OesBallInfaVlm  = Data.getData(TestName,"HandOver","OesBallInfaVlm");
var OesDrainageVolume  = Data.getData(TestName,"HandOver","OesDrainageVolume");
var OesDrainageDes = Data.getData(TestName,"HandOver","OesDrainageDes");

// To enter input details for Balloon Tamponade device

exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 1)",exestatus); 
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 2)",exestatus); 
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\"))",Size ,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\"))",PosiAtTeeth ,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\"))",GasBallInfaVlm ,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\"))",OesBallInfaVlm ,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Traction,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\"))",DrainageVolume ,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",DrainageDes,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\"))",OesDrainageVolume ,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",OesDrainageDes,exestatus);


// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Subdural Drain Saved Time: "+ timeSavedValue);


// To save and close the form

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);

// To open the form again
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);



// Validation of documented values
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_1\")","Value",Size, "Size",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_2\")","Value",PosiAtTeeth, "PosiAtTeeth",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_3\")","Value",GasBallInfaVlm, "GasBallInfaVlm",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_4\")","Value",OesBallInfaVlm, "OesBallInfaVlm",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",Traction,"Traction",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_5\")","Value",DrainageVolume, "DrainageVolume",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")","Text",DrainageDes,"DrainageDes",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtNumeric_6\")","Value",OesDrainageVolume, "OesDrainageVolume",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",OesDrainageDes,"OesDrainageDes",exestatus);

// To close the form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

 // To initiate the drain
 exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Grid\", \"\", 1).WPFObject(\"ProcessStyleView\", \"\", 1).WPFObject(\"Process_Style_Group\").WPFObject(\"LayoutGroup\", \"\", 1).WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",Duration,exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"Button\", \"Validate\", 1)",exestatus);

    
// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
aqUtils.Delay(2000);  

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully initiated Balloon Tamponade Device");
      Log.Checkpoint("End of Balloon Tamponade Device","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Balloon Tamponade Device initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvCAMICU
// Desc :Feature to document the Confusion Assessment (CAM-ICU)
// Owner :Satheeshkumar C
// Creation date:05-Dec-2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************// 

function MvCAMICU(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start of documenting CAM-ICU for "+tcDesc ,"The flow is started");
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

   // To select CAM-ICU
	exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "CAM-ICU");

	// Wait for screen to appear
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus);

  
    
// ** Fill in the details for CAM-ICU **
Log.Message("***Enter details for CAM-ICU Scores ***");
	

var AcuteChnge  = Data.getData(TestName,"HandOver","AcuteChnge");
var Inattention  = Data.getData(TestName,"HandOver","Inattention");
var CurrentRASS  = Data.getData(TestName,"HandOver","CurrentRASS");
var CAMICUNegative = Data.getData(TestName,"HandOver","CAMICUNegative");
var CAMICUPositive = Data.getData(TestName,"HandOver","CAMICUPositive");
var DisorganThinking = Data.getData(TestName,"HandOver","DisorganThinking");

// To enter input details for CAM- ICU

switch (AcuteChnge){

case ("No"):{
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",AcuteChnge,exestatus);
}
break;

case ("Yes"):{
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",AcuteChnge,exestatus);

 switch (Inattention)
  {
  case ("0-2 errors"):
     {
      exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Inattention,exestatus);
     }
     break;
  case (">2 errors"):
      {
      exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",Inattention,exestatus);
      exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",CurrentRASS,exestatus);
      var ObjVisible = vProcess.Find("Name", "WPFObject(\"cboTextCombo_5\")", 1000);
     
           if (ObjVisible.Visible == true)
           {      
    
             exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUPositive,"CAMICUPositive",exestatus);
           }
      
      switch(CurrentRASS)
      {

       case("0 - Alert and calm"):
       {
        
         switch (DisorganThinking)
         {
           case("0-1 error"):
           {
           exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",DisorganThinking,exestatus);
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUNegative,"CAMICUNegative",exestatus);
           }  
           break;
           case (">1 error"):
           {
           exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",DisorganThinking,exestatus);
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUPositive,"CAMICUPositive",exestatus);
           }
           break;
           
         }          
       } 
       
      }
     break;
      }
   }
  break;
 }
 
} 


// Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
	timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
	Log.Checkpoint("Saved Time: "+ timeSavedValue);


// To save the form

   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdApply\")",exestatus);


// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
   exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
//Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
    
// close the form
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
  
//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "CAM-ICU");
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }



// Validation of documented values
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  switch (AcuteChnge){

case ("No"):
 {

exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",AcuteChnge,"AcuteChnge",exestatus);
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUNegative,"CAMICUNegative",exestatus);
 }
break;

case ("Yes"):
{
exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")","Text",AcuteChnge,"AcuteChnge",exestatus);

 switch (Inattention)
  {
  case ("0-2 errors"):
     {
     exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")","Text",Inattention,"Inattention",exestatus);
     exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUNegative,"CAMICUNegative",exestatus); 
     }
     break;
  case (">2 errors"):
      {
      
       exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_2\")","Text",Inattention,"Inattention",exestatus);
       exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",CurrentRASS,"CurrentRASS",exestatus);
       
      switch(CurrentRASS)
      {
      
       case("0 - Alert and calm"):
       {
       exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_3\")","Text",CurrentRASS,"CurrentRASS",exestatus);
        
         switch (DisorganThinking)
         {
           case("0-1 error"):
           {
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")","Text",DisorganThinking,"DisorganThinking",exestatus);
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUNegative,"CAMICUNegative",exestatus);
           }  
           break;
           case (">1 error"):
           {
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_4\")","Text",DisorganThinking,"DisorganThinking",exestatus);
           exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_5\")","Text",CAMICUPositive,"CAMICUPositive",exestatus);
           }
           break;
           
         }          
       } 
       
      }
   
     break;
      }
   }
  break;
  }
 
 }

// To close the form
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);

 

    
// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);
aqUtils.Delay(2000);  

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully documented Confusion Assessment (CAM-ICU)");
      Log.Checkpoint("End of documenting Confusion Assessment (CAM-ICU)","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Confusion Assessment (CAM-ICU) documentation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateLogin
// Desc :Feature to login to DB update tool
// Owner :Satheeshkumar C 
// Creation date:07-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateLogin(TestName,exestatus)
{
 
 var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
 Log.Checkpoint("Start Test Case "+tcDesc );
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//Start of the feature 
Log.Checkpoint("Start Login","The flow is started");

//object to fetch all the data for the parameter
   
    var userName = Data.getData(TestName,"Navigation","UserID");
    var password = Data.getData(TestName,"Navigation","Password");
    
    
//Terminate any existing DBUpdate Process to tidy up
	if (Sys.WaitProcess("MvDBUpdate").Exists){
  	vProcess = Sys.Process("MvDBUpdate");
  if (vProcess.Find("Name", "WPFObject(\"txtLogin\")", 1000).Exists){
    Log.Message("Already session is active and Relogging in it." );
  
  }
  else {
		Sys.Process("MvDBUpdate").Terminate();
      	// Start DBUpdate
    Log.Message("Terminating Metavision session and opening new one");   
  
    TestedApps.iMDSoft_MvDBUpdate.Run();
     var Res = Sys.Process("MvDBUpdate").Exists;
   
  // Checks whether DBUpdate has started successfully
  if (Res) {
    Log.Checkpoint("DBUpdate tool has been started successfully.");}
  else{
    Log.Error("DBUpdate tool hasn't been started.");
    exestatus = false;}
    
       }
   
	 }
   else {
    Log.Message("Opening new session of Metavision");   
  	
    TestedApps.iMDSoft_MvDBUpdate.Run();
     var Res = Sys.Process("MvDBUpdate").Exists;
   
  // Checks whether DBUpdate has started successfully
  if (Res) {
    Log.Checkpoint("DBUpdate tool has been started successfully.");}
  else {
    Log.Error("DBUpdate tool hasn't been started.");
    exestatus = false;}
    
     }

	
	// use default password if not passed in
	if (equal(password, "")) {
		password = "P@ssword1";
	} else {
  		password = password;
	}
	
   	vProcess = Sys.Process("MvDBUpdate");
    
  	// Wait for the login screen to appear
  	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"txtLogin\")", 120,exestatus);

  	// Enter Login details
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtLogin\")", userName,exestatus);
  	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBox\")", password,exestatus);
  	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"btnLogin\")",exestatus);

    Sys.WaitProcess("MvDBUpdate",1000);  
    
    // To handle invalid credentials pop up
//    if (vProcess.Find("FullName", "*Window(\"#32770\", \"\", 1).Window(\"Button\", \"OK\", 1)", 2000).Exists) {
//		
//    Log.Error("Invalid login name or password");
//    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\", \"OK\", 1)",exestatus);
//    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Cancel\", 2)",exestatus);
//    //exestatus = false;
//	}	 
  
	
  	// To check DB update tool logged in successfully
   control = vProcess.Find("Name", "WPFObject(\"ComboBox\", \"\", 1)", 2000);
   if (control.Exists) {
  	
      Log.Checkpoint("DB Update tool logged in successfully as '"+ userName+"'" );
      Log.Checkpoint("End of DBUpdate Login","DBUpdate tool logged in successfully.");
	}
   else if (vProcess.Find("FullName", "*Window(\"#32770\", \"\", 1).Window(\"Button\", \"OK\", 1)", 2000).Exists) {
		
    //Log.Error("Invalid login name or password");
    exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\", \"OK\", 1)",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Cancel\", 2)",exestatus);
    Log.Message("The use doesn't have access to DB update tool")
    //exestatus = false;
	  }	 
  }
  else {
  Log.Message("Skip DBUpdate Login","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateLogout
// Desc :Feature to logout of DBUpdate tool
// Owner :Satheeshkumar C 
// Creation date:07-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for Logout of DBUpdate tool 
function MvDBUpdateLogout(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

Log.Checkpoint("Start Logout","The flow is started");  

 
   
  
 // To close the DB Update tool   
	
if (Sys.WaitProcess("MvDBUpdate").Exists){
  	Sys.Process("MvDBUpdate").Terminate();
     Log.Checkpoint("DBUpdate tool session loggged out successfully.");
     Log.Checkpoint("End Logout","DBUpdate tool session loggged out successfully.");
    
	 }
   else 
   {
    Log.Error("There is no session exists to close");
    exestatus = false;
   }
   
  }
 

 var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
 Log.Checkpoint("End Test Case "+tcDesc );   
  return exestatus;

}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateSearchByAllFields
// Desc :Feature to search by all fields ( FirstName, LastName, MRN, Account Number)
// Owner :Satheeshkumar C 
// Creation date:08-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateSearchByAllFields(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of Searching by different fields in DBUpdate tool"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for different fields***");
	  var FirstName = Data.getData(TestName,"Patient","FirstName");
    var PartialFname = aqString.SubString(FirstName,0,16);
    var LastName = Data.getData(TestName,"Patient","LastName");
    var PartialLname = aqString.SubString(LastName,0,16);
    var MRN = Data.getData(TestName,"Patient","MRN");
    var PartialMRN = aqString.SubString(MRN,0,9);
    var AccountNo = Data.getData(TestName,"Patient","VisitID");
    var Department = Data.getData(TestName,"Navigation","Department");
    
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var TypeofField = Data.getData(TestName,"DBUpdate","TypeofField");
    var Facility = Data.getData(TestName,"DBUpdate","Facility");  

 // Check production DB selected by default    
  var ProduDBRadio = vProcess.Find("Name","WPFObject(\"RadioButton\", \"Production\", 1)",1000);
  
  if (ProduDBRadio.IsChecked == true)
    {
    Log.Message("Production DB selected by default");
    
    }else {
    Log.Error("Archive DB selected by default instead of Production DB");
    exestatus = false;
    }   
    
// To enter input details for different fields

 switch (TypeofField)
 {

     case ("FirstName"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 1)",PartialFname,exestatus);
     break; 
     
     case ("LastName"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 2)",PartialLname,exestatus);
     break; 
     
     case ("MRN"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",PartialMRN,exestatus);
     break;   
     
     case ("AccountNo"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 5)",AccountNo,exestatus);
     break; 
     
     
     case ("All"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 1)",FirstName,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 2)",LastName,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 5)",AccountNo,exestatus);
     exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"WindowMain\", \"MV Archive/Production DB Update\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ComboBox\", \"\", 1)","ComboBox", Facility,exestatus);
     break; 
     
     case("FirstNameAndLastName"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 1)",PartialFname,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 2)",PartialLname,exestatus);
     break;
     
     default:
     Log.Message("Type of field value not matching");
 
}
   aqUtils.Delay(2000);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   
   
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var searchFirstName = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientName = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);  
	var searchLastName = admittedPatientListPatientName.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientMRN = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchMRN = admittedPatientListPatientMRN.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var admittedPatientListPatientAccNo = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 7)", 1000);  
	var searchAccno = admittedPatientListPatientAccNo.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListfacility = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 8)", 1000);  
  var searchFacility = admittedPatientListfacility.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var listFirstName = aqObject.GetPropertyValue(searchFirstName, "Text");
  var listLastName = aqObject.GetPropertyValue(searchLastName, "Text");
  var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
  var listAccno = aqObject.GetPropertyValue(searchAccno, "Text");
  var listFacility = aqObject.GetPropertyValue(searchFacility, "Text");
  
	  
	Log.Message("Patient FirstName: "+ listFirstName);
  Log.Message("Patient LastName: "+ listLastName );
  Log.Message("Patient MRN: "+ listMRN );
  Log.Message("Patient Accno: "+ listAccno );
  Log.Message("Facility Name: "+ listFacility);
  
switch (TypeofField){
  
  case ("FirstName"):{
  
  if (aqString.Contains(listFirstName, PartialFname) != -1 ) {
  
        Log.CheckPoint("Patient with given FirstName is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("LastName"):{
  
  if (aqString.Contains(listLastName, PartialLname) != -1 ) {
  
        Log.CheckPoint("Patient with given LastName is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }

  case ("MRN"):{
  
  if (aqString.Contains(listMRN, PartialMRN) != -1 ) {
  
        Log.CheckPoint("Patient with given MRN is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("FirstNameAndLastName"):{
  
  if (aqString.Contains(listFirstName, PartialFname) != -1 && aqString.Contains(listLastName, PartialLname) != -1 ) {
       
        Log.CheckPoint("Patient with given FirstName and LastName is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("All"):{
  
  if (aqString.Compare(listFirstName, FirstName,false)== 0 && aqString.Compare(listLastName, LastName,false)== 0 && aqString.Compare(listMRN, MRN,false)== 0 && aqString.Compare(listAccno, AccountNo,false)== 0 && aqString.Compare(listFacility, Department,false)== 0 )  {
  
        Log.CheckPoint("Patient with given FirstName ,LastName ,MRN, Account No and facility values are found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("AccountNo"):{
  
  if (aqString.Compare(listAccno, AccountNo,false)== 0 ) {
  
        Log.CheckPoint("Patient with given Account no is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }

   break;
 
  
   }
  
  
 
	}
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }



 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given search criteria's are matching with search result");
      Log.Checkpoint("Searching by different fields in DBUpdate tool","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Searching by different fields in DBUpdate tool","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvClosePatient
// Desc :Feature to close patient on MV
// Owner :Satheeshkumar C
// Creation date: 08 Dec 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


// Feature created to close patient in MV
function MvClosePatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
Log.Checkpoint("Start of close a Patient ","The flow is started");
	
  //Start of the feature 
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open patient file
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
  
	// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

     
		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
		// Enter the Status
		exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Archived",exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "^[End]!^[Home][Del]" ,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtComments\")", "Patient status changed to closed and will be validated in Archive DBupdate",exestatus);
   
    let patientDetails = new Object();
// To set the status & from datetime value as 48 hrs before current time, so can validate in arhive DB
 
  var statusValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpStatusFromTime\")", 1000);
	var fromValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpLocationFromTime\")", 1000);
    // have to select the time as current system time
	statusValueText = aqObject.GetPropertyValue(statusValueObject.Value, "OleValue");
	admitTime = aqConvert.DateTimeToFormatStr(statusValueText, "%d/%m/%Y %H:%M");
	ArcRegisDateTime = aqDateTime.AddTime(admitTime, -2, -4, -10, -10);
  patientDetails.admissionTime = admitTime;
  
  statusValueResult = aqObject.SetPropertyValue(statusValueObject, "Value", ArcRegisDateTime);
	fromValueResult = aqObject.SetPropertyValue(fromValueObject, "Value", ArcRegisDateTime);
  
  if (fromValueResult) {
		       Log.Checkpoint("Patient File From Date set to Status Date.");
	         } else {
		       Log.Error("Patient File From Date not set to Status Date");
		       exestatus = false;
	         }
		frmPatientRegistration.WinFormsObject("picButtonsContainer").WinFormsObject("cmdOK").Click()
    exestatus = mvObjects.buttonClick(vProcess,"FullName","*WinFormsObject(\"ImdFormBase\").WinFormsObject(\"Buttons\").WinFormsObject(\"Proceed\")",exestatus); 
     
    

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient Status changed to closed successfully");
      Log.Checkpoint("End of close a patient MV","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped close a Patient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateAllFields
// Desc :Feature to update by all fields ( FirstName, LastName, MRN, AUID & Account Number)
// Owner :Satheeshkumar C 
// Creation date:11-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateAllFields(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of updating different fields in DBUpdate tool and validate in MV"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
   Log.Message("***Enter details for different fields***");
    var MRN = Data.getData(TestName,"Patient","MRN");
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var UpdateFirstname = Data.getData(TestName,"DBUpdate","UpdateFirstname"); 
    var Updatelastname = Data.getData(TestName,"DBUpdate","Updatelastname");
    var UpdateMRN = Data.getData(TestName,"DBUpdate","UpdateMRN");
    var UpdateAUID = Data.getData(TestName,"DBUpdate","UpdateAUID");
    var UpdateAccountNo =Data.getData(TestName,"DBUpdate","UpdateAccountNo");
    var UpdateGender = Data.getData(TestName,"DBUpdate","UpdateGender");
    var UpdateMedicareNo = Data.getData(TestName,"DBUpdate","UpdateMedicareNo");
    var UpdateDVACardNo = Data.getData(TestName,"DBUpdate","UpdateDVACardNo");
    var DVAColor = Data.getData(TestName,"DBUpdate","DVAColor");
    var Comments = Data.getData(TestName,"DBUpdate","Comments");
    var TypeOfDB = Data.getData(TestName,"DBUpdate","TypeOfDB");

 // To select the Arhive DB
      
      if (TypeOfDB == null || TypeOfDB == "" || TypeOfDB == undefined ){
      Log.Message( "Production DB selected by default");
      } 
      else if (aqString.Compare(TypeOfDB, "Archive", false)== 0)
      {
      exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"RadioButton\", \"Archive\", 2)",exestatus);
      }
    
// To enter input details for different fields
     
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     
     exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   //aqUtils.Delay(2000);
   
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  // Log.Message(i+ " space "+ RowCount )
   // aqUtils.Delay (3000, "Move to next list item");
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 

  
  var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchMRN = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
	
  var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
  
  Log.Message("Patient MRN: "+ listMRN );
  
  
  if (aqString.Contains(listMRN, MRN) != -1 ) {
      admittedPatientList.DblClick();
        Log.CheckPoint("Patient with given MRN is found");
    k = 1
    break;
    
	    }
    k = 0;
 
	}
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }
    
    // To update the different fields
    Log.Message("Enter updated input details");
    
    // To clear the existing values
     //exestatus= mvObjects.waitForObject(vProcess,"*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 2)",120,exestatus);
     aqUtils.Delay(1000);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"txtFirstName\")",exestatus);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 2)",exestatus);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 3)",exestatus);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 4)",exestatus);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 5)",exestatus); 
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 3).WPFObject(\"TextBox\", \"\", 1)",exestatus);
     
    // To enter input details for comment field
    exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 3).WPFObject(\"TextBox\", \"\", 1)",Comments,exestatus);
    // Save & Close
     exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: WindowUpdateRecord\", \"MV Production/Archive DB Update window\").WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 3).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"Save and Close\", 2)",exestatus);
     
    //To proceed with pop
     var MsgForm = vProcess.Find("Name", "WPFObject(\"WindowMessageBox\", \"Message\", 1)", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Yes\", 1)",exestatus);
    }
    aqUtils.Delay(2000);
    
     // To check for the mandatory validation pop up
     var MsgForm = vProcess.Find("Name", "WPFObject(\"WindowMessageBox\", \"Message\", 1)", 1000);
     if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"OK\", 3)",exestatus);
    }
     
     
     // To enter updated field values
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"txtFirstName\")",UpdateFirstname,exestatus);
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 2)",Updatelastname,exestatus);
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 3)",UpdateMRN,exestatus);
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 4)",UpdateAUID,exestatus);
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 5)",UpdateAccountNo,exestatus);
     
     
        var UpdateDOB = Data.getData(TestName,"DBUpdate","UpdateDOB")
        
       exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"DatePicker\", \"\", 1)",UpdateDOB,exestatus);
       exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"ComboBox\", \"\", 1)","ComboBox", UpdateGender,exestatus)
       exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"TextEdit\", \"\", 1)",UpdateMedicareNo,exestatus);
       
       var MedicareExp = Data.getData(TestName,"DBUpdate","MedicareExp")

       exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"DatePicker\", \"\", 2)",MedicareExp,exestatus);
       exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"TextEdit\", \"\", 2)",UpdateDVACardNo,exestatus);    
       exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"ComboBox\", \"\", 2)","ComboBox",DVAColor,exestatus) 
     
       
     
       // Save & Close
     exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: WindowUpdateRecord\", \"MV Production/Archive DB Update window\").WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 3).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"Save and Close\", 2)",exestatus);
     
     // To proceed with pop
     var MsgForm = vProcess.Find("Name", "WPFObject(\"WindowMessageBox\", \"Message\", 1)", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Yes\", 1)",exestatus);
    }
     aqUtils.Delay(3000);
     
     // Wait untill the object become enable to ensure the proper saving of update details
    exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",120,exestatus);
      
 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given details are updated in DB Update tool");
      Log.Checkpoint("Update different fields in DBUpdate tool","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped update different fields in DBUpdate tool","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateUnsaved
// Desc :Feature to validate quit confirmation pop up and validation of unsaved changes
// Owner :Satheeshkumar C 
// Creation date:13-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateUnsaved(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of validating quit confirmation pop up and validation of unsaved changes"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
   Log.Message("***Enter details for different fields***");
    var MRN = Data.getData(TestName,"Patient","MRN");
    var FirstName = Data.getData(TestName,"Patient","FirstName");
    var LastName = Data.getData(TestName,"Patient","LastName");
   
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var UpdateFirstname = Data.getData(TestName,"DBUpdate","UpdateFirstname"); 
    var Updatelastname = Data.getData(TestName,"DBUpdate","Updatelastname");
    
    
// To enter input details for different fields
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     
     exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   //aqUtils.Delay(2000);
   
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000);
  
  var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchMRN = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
	
  
  var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");

  Log.Message("Patient MRN: "+ listMRN );
  
  
  if (aqString.Contains(listMRN, MRN) != -1 ) {
      admittedPatientList.DblClick();
        Log.CheckPoint("Patient with given MRN is found");
    k = 1
    break;
    
	    }
    k = 0;
 
	}
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }
    
    // To update the different fields
    Log.Message("Enter updated input details");
    
    
     aqUtils.Delay(1000);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"txtFirstName\")",exestatus);
     exestatus =mvObjects.clearText(vProcess,"FullName","*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 2)",exestatus);
      
     
     // To enter updated first name and last name
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"txtFirstName\")",UpdateFirstname,exestatus);
     exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"TextEdit\", \"\", 2)",Updatelastname,exestatus);
        
     
       // Click on close button
     exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: WindowUpdateRecord\", \"MV Production/Archive DB Update window\").WPFObject(\"WindowUpdateRecord\", \"MV Production/Archive DB Update window\", 1).WPFObject(\"GroupBox\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 3).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"Button\", \"Close\", 3)",exestatus);
       
     // To proceed with quit confirmation message and discard the changes
     
     var MsgForm = vProcess.Find("Name", "WPFObject(\"WindowMessageBox\", \"Message\", 1)", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Yes\", 1)",exestatus);
    }
    aqUtils.Delay(1000);
    

       //To search for the same patient again
      exestatus =mvObjects.clearText(vProcess,"Name","WPFObject(\"TextEdit\", \"\", 3)",exestatus); 
      exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     
      exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   
       exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000);
   
  var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var searchFirstName = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientName = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);  
	var searchLastName = admittedPatientListPatientName.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var listFirstName = aqObject.GetPropertyValue(searchFirstName, "Text");
  var listLastName = aqObject.GetPropertyValue(searchLastName, "Text");

  Log.Message("Patient FirstName: "+ listFirstName);
  Log.Message("Patient LastName: "+ listLastName );

  
  if (aqString.Compare(listFirstName, FirstName,false)== 0 && aqString.Compare(listLastName, LastName,false)== 0) {
        Log.CheckPoint("First and Last name for the patient are not updated since the action has been discarded");
	    }
    else
    {
      Log.CheckPoint("First and Last name for the patient are updated even though the action has been discarded ");
      exestatus= false;
      }
      
 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given first and last name details are not updated in DB Update tool");
      Log.Checkpoint("Validation of quit confirmation pop up and Unsaved changes in DBUpdate tool","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of quit confirmation pop up and Unsaved changes in DBUpdate tool","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientDetailsFromDB
// Desc :Feature to validate updated values in DB update tool reflected in MV
// Owner :Satheeshkumar C
// Creation date: 13 Dec 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvPatientDetailsFromDB(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


Log.Checkpoint("Start of validating updated values in DB update tool reflected in MV ","The flow is started");
	
  //Start of the feature 
	
	 vProcess = Sys.Process("iMDSoft.Metavision");
   
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var UpdateFirstname = Data.getData(TestName,"DBUpdate","UpdateFirstname"); 
    var Updatelastname = Data.getData(TestName,"DBUpdate","Updatelastname");
    var UpdateMRN = Data.getData(TestName,"DBUpdate","UpdateMRN");
    var UpdateAccountNo = Data.getData(TestName,"DBUpdate","UpdateAccountNo");
    var UpdateGender = Data.getData(TestName,"DBUpdate","UpdateGender");
    var Comments = Data.getData(TestName,"DBUpdate","Comments");
    var UpdateDOB = Data.getData(TestName,"DBUpdate","UpdateDOB")
      

	// Open patient file
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
     
		iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
		frmPatientRegistration = iMDSoft_Metavision.frmPatientRegistration;
		
    // validation of updated values in MV from DB update
		 
   exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"FormCaption\")", 30,exestatus);
	patientListFormObject = vProcess.Find("Name", "WinFormsObject(\"frmPatientRegistration\")");
  
	screenMRNObject = vProcess.Find("Name", "WinFormsObject(\"txtMRNumber\")", 100); 
	
  // Findu updated Patient Number from DB
	screenMRNValue =  aqObject.GetPropertyValue(screenMRNObject, "Text");
	if (aqString.Compare(screenMRNValue, UpdateMRN, false) == 0) {
		Log.Checkpoint("Found expected value "+ UpdateMRN);
	} else {
		Log.Error("Expected value, "+ UpdateMRN +", not found. Found: "+ screenMRNValue);
		exestatus = false;
	}
  
  // Find updated Patient account# from DB
  
  screenAUIDObject = vProcess.Find("Name", "WinFormsObject(\"cboSocialSecurity\")", 100);
	screenAUIDValue =  aqObject.GetPropertyValue(screenAUIDObject, "Text");
	if (aqString.Compare(screenAUIDValue, UpdateAccountNo, false) == 0) {
		Log.Checkpoint("Found expected value "+ UpdateAccountNo);
	} else {
		Log.Error("Expected value, "+ UpdateAccountNo +", not found. Found: "+ screenAUIDValue);
		exestatus = false;
	}
  
	// Find updated First Name from DB
	screenFirstNameObject = vProcess.Find("Name", "WinFormsObject(\"txtFirstName\")", 100);
	screenFirstNameValue =  aqObject.GetPropertyValue(screenFirstNameObject, "Text");
	if (aqString.Compare(screenFirstNameValue, UpdateFirstname, false) == 0) {
		Log.Checkpoint("Found expected value "+ UpdateFirstname);
	} else {
		Log.Error("Expected value, "+ UpdateFirstname +", not found. Found: "+ screenFirstNameValue);
		exestatus = false;
	}
    
	// Find updated Last Name from DB
	screenLastNameObject = vProcess.Find("Name", "WinFormsObject(\"txtLastName\")", 100);
	screenLastNameValue =  aqObject.GetPropertyValue(screenLastNameObject, "Text");
	if (aqString.Compare(screenLastNameValue, Updatelastname, false) == 0) {
		Log.Checkpoint("Found expected value "+ Updatelastname);
	} else {
		Log.Error("Expected value, "+ Updatelastname +", not found. Found: "+ screenLastNameValue);
		exestatus = false;
	}
  
  // Find updated comments from DB
  
  screencommentsObject = vProcess.Find("Name", "WinFormsObject(\"txtComments\")", 100);
	screencommentsValue =  aqObject.GetPropertyValue(screencommentsObject, "Text");
	if (aqString.Compare(screencommentsValue, Comments, false) == 0) {
		Log.Checkpoint("Found expected value "+ Comments);
	} else {
		Log.Error("Expected value, "+ Comments +", not found. Found: "+ screencommentsValue);
		exestatus = false;
	}
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"CmdCancel\")",exestatus);
  
  // Find gender & DOB in demographics
  exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient Demographics");
  exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"dtpDate_1\")",120,exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"dtpDate_1\")", "Value", UpdateDOB, "UpdateDOB",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_1\")", "Text",UpdateGender,"UpdateGender",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
   
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Updated patient details in DB update tool reflected in MV");
      Log.Checkpoint("End of validating updated patient details in MV","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of updated details in MV","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateSearchByFacility
// Desc :Feature to search by different facility
// Owner :Satheeshkumar C 
// Creation date:14-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateSearchByFacility(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
Log.Checkpoint("Start of Searching by different fields in DBUpdate tool"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for different fields***");
    var Department = Data.getData(TestName,"Navigation","Department");
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var Facility = Data.getData(TestName,"DBUpdate","Facility");  

// To enter input details for facility
Log.Message("** Enter input details for facility")

// Select facility value from drop down

if (aqString.Compare(Facility,"Coffs Harbour",false)==0 ||aqString.Compare(Facility,"Grafton Base Hospital",false)==0 ||aqString.Compare(Facility,"Lismore Base Hospital",false)==0 ||aqString.Compare(Facility,"Port Macquarie",false)==0 ||aqString.Compare(Facility,"The Tweed Hospital",false)==0 ||aqString.Compare(Facility,"The Tweed Hospital",false)==0 ||aqString.Compare(Facility,"All Facilities",false)==0 )
{

exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"WindowMain\", \"MV Archive/Production DB Update\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ComboBox\", \"\", 1)","ComboBox", Facility,exestatus);
}
else
{
Log.Error("Entered facility not configured in MV");
exestatus = false;
}


// click on search button
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   
   var DBWindow = vProcess.Find("Name","WPFObject(\"HwndSource: WindowMain\", \"MV Archive/Production DB Update\")",1000);
    DBWindow.Maximize();
    
   aqUtils.Delay(3000);
  var tableview =  vProcess.Find("Name","WPFObject(\"TableView\", \"\", 1)",1000)
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  //patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");
  Log.Message("Total no of records : " + RowCount);
	 var k = 0;
	 var j = 0;
   
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       //patGridRow.Keys("[Down]");
       //patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
if (i>= 30){
 PatientListObject.MouseWheel(10);  
}
  
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 8)", 1000);  
	var searchFacility = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientMRN = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchMRN = admittedPatientListPatientMRN.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientFirstName = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var searchFirstName = admittedPatientListPatientFirstName.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var listFacility = aqObject.GetPropertyValue(searchFacility, "Text");
  var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
  var listFirstName = aqObject.GetPropertyValue(searchFirstName, "Text");
	  
	Log.Message("Facility Name: "+ listFacility);
  Log.Message("Patient MRN: "+ listMRN);  
  Log.Message("Patient FirstName: "+ listFirstName);
  
  
  
  
if (aqString.Compare(Facility,"Coffs Harbour",false)==0 ||aqString.Compare(Facility,"Grafton Base Hospital",false)==0 ||aqString.Compare(Facility,"Lismore Base Hospital",false)==0 ||aqString.Compare(Facility,"Port Macquarie",false)==0 ||aqString.Compare(Facility,"The Tweed Hospital",false)==0 ||aqString.Compare(Facility,"The Tweed Hospital",false)==0 )
      {
        if (aqString.Compare(listFacility, Department,false)== 0) 
         {
  
        Log.CheckPoint("List of Patient with selected facility " +Department + " displayed");
        k = 1
    
         }
         else {
          k = 0;  
          }
    
       }  
       else{
       
       if (aqString.Compare(listFacility, "CCH-ICU",false)== 0 ||aqString.Compare(listFacility, "GBH-ICU",false)== 0 || aqString.Compare(listFacility, "LBH-ICU",false)== 0 ||aqString.Compare(listFacility, "PMB-ICU",false)== 0 ||aqString.Compare(listFacility, "TTH-ICU",false)== 0 ) 
         {
  
        Log.CheckPoint(" List of Patient's with different facilities are displayed");
    k = 1
    
         }
         else{
             k = 0;  
              }
            }
        
   
 }
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }



 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given search criteria's are matching with search result");
      Log.Checkpoint("Searching by different facility values in DBUpdate tool","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Searching by different facility values in DBUpdate tool","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateSearchByAUID
// Desc :Feature to search by full and partial AUID
// Owner :Satheeshkumar C 
// Creation date:18-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateSearchByAUID(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
Log.Checkpoint("Start of Searching by full and partial AUID DBUpdate tool"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for different fields***");
    var TypeofAUID = Data.getData(TestName,"DBUpdate","TypeofAUID");
	  var AUID = Data.getData(TestName,"DBUpdate","UpdateAUID");
    var PartialAUID = aqString.SubString(AUID,0,9);
      

// To enter input details for different fields

 switch (TypeofAUID)
 {
  
     case ("Partial"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 4)",PartialAUID,exestatus);
     break;   
     
     case ("Full"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 4)",AUID,exestatus);
     break; 
     
     default:
     Log.Message("Type of AUID value not entered");
 
}
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   //aqUtils.Delay(2000);
   
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 6)", 1000);  
	var searchAUID = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var listAUID = aqObject.GetPropertyValue(searchAUID, "Text");
	  
	Log.Message("Patient AUID: "+ listAUID);
  
  
switch (TypeofAUID){
  
  case ("Partial"):{
  
  if (aqString.Contains(listAUID, PartialAUID) != -1 ) {
  
        Log.CheckPoint("Patient with given Partial AUID is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("Full"):{
  
  if (aqString.Compare(listAUID, AUID,false)== 0 ) {
  
        Log.CheckPoint("Patient with given AUID is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }

  break;
 
  
   }
 
	}
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }



 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given search criteria's are matching with search result");
      Log.Checkpoint("Search by full and partial AUID fields in DBUpdate tool","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Search by full and partial AUID fields in DBUpdate tool","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateArhiveDBSearchByFields
// Desc :Function to search by all fields ( FirstName, LastName, MRN, Account Number, facility) in archive DB
// Owner :Satheeshkumar C 
// Creation date:18-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateArhiveDBSearchByFields(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of Searching by different fields in Arhive DB"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for different fields***");
    
	  var FirstName = Data.getData(TestName,"Patient","FirstName");
    var LastName = Data.getData(TestName,"Patient","LastName");
    var PartialLname = aqString.SubString(LastName,0,16);
    var MRN = Data.getData(TestName,"Patient","MRN");
    var AccountNo = Data.getData(TestName,"Patient","VisitID");
    var Department = Data.getData(TestName,"Navigation","Department");
    
    var tcDesc = Data.getData(TestName,"DBUpdate","TC_DESC");
    var TypeofField = Data.getData(TestName,"DBUpdate","TypeofField"); 
    var TypeOfDB = Data.getData(TestName,"DBUpdate","TypeOfDB");
    var Facility = Data.getData(TestName,"DBUpdate","Facility");
    
// Check archive DB not selected by default    
  var ArchDBRadio = vProcess.Find("Name","WPFObject(\"RadioButton\", \"Archive\", 2)",1000);
  
  if (ArchDBRadio.IsChecked == false)
    {
    Log.Message("Archive DB not selected by default");
    
    }else {
    Log.Error("Archive DB selected by default instead of Production DB");
    exestatus = false;
    }

// Select the Archive DB to proceed the search
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"RadioButton\", \"Archive\", 2)",exestatus);
aqUtils.Delay(1000);    
    
// To enter input details for different fields
 switch (TypeofField)
 {

     case ("FirstName"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 1)",FirstName,exestatus);
     break; 
     
     case ("LastName"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 2)",PartialLname,exestatus);
     break; 
     
     case ("MRN"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     break;   
     
     case ("AccountNo"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 5)",AccountNo,exestatus);
     break; 
     
     
     case ("All"):
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 1)",FirstName,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 2)",LastName,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);
     exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 5)",AccountNo,exestatus);
     exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"WindowMain\", \"MV Archive/Production DB Update\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ComboBox\", \"\", 1)","ComboBox", Facility,exestatus);
     break; 
     
     default:
     Log.Message("Type of field value not matching");
 
}
  aqUtils.Delay(10000);
   
   
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
   
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");

  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var searchFirstName = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientName = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);  
	var searchLastName = admittedPatientListPatientName.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListPatientMRN = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	var searchMRN = admittedPatientListPatientMRN.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var admittedPatientListPatientAccNo = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 7)", 1000);  
	var searchAccno = admittedPatientListPatientAccNo.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
  var admittedPatientListfacility = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 8)", 1000);  
  var searchFacility = admittedPatientListfacility.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	var listFirstName = aqObject.GetPropertyValue(searchFirstName, "Text");
  var listLastName = aqObject.GetPropertyValue(searchLastName, "Text");
  var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
  var listAccno = aqObject.GetPropertyValue(searchAccno, "Text");
  var listFacility = aqObject.GetPropertyValue(searchFacility, "Text");
  
	  
	Log.Message("Patient FirstName: "+ listFirstName);
  Log.Message("Patient LastName: "+ listLastName );
  Log.Message("Patient MRN: "+ listMRN );
  Log.Message("Patient Accno: "+ listAccno );
  Log.Message("Facility Name: "+ listFacility);
  
switch (TypeofField){
  
  case ("FirstName"):{
  
  if (aqString.Compare(listFirstName, FirstName,false)== 0 ) {
  
        Log.CheckPoint("Patient with given FirstName is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("LastName"):{
  
  if (aqString.Contains(listLastName, PartialLname) != -1 ) {
  
        Log.CheckPoint("Patient with given LastName is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }

  case ("MRN"):{
  
  if (aqString.Compare(listMRN, MRN,false)== 0 ) {
  
        Log.CheckPoint("Patient with given MRN is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  
  case ("All"):{
  
  if (aqString.Compare(listFirstName, FirstName,false)== 0 && aqString.Compare(listLastName, LastName,false)== 0 && aqString.Compare(listMRN, MRN,false)== 0 && aqString.Compare(listAccno, AccountNo,false)== 0 && aqString.Compare(listFacility, Department,false)== 0)  {
  
        Log.CheckPoint("Patient with given FirstName ,LastName ,MRN, Account No and facility values are found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }
  
  case ("AccountNo"):{
  
  if (aqString.Compare(listAccno, AccountNo,false)== 0 ) {
  
        Log.CheckPoint("Patient with given Account no is found");
    k = 1
    break;
    
	    }
    k = 0;  
  
  }

   break;
 
  
   }
  
  
 
	}
  

  if (k===0){  
		Log.Error("Patient with given search criteria is not found")
		exestatus = false
    }



 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given search criteria's are matching with search result");
      Log.Checkpoint("Searching by different fields in Archive DB","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Searching by different fields in Archive DB","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateArhiveDBSearchAllPatient
// Desc :Function to search by all fields ( FirstName, LastName, MRN, Account Number, facility) in archive DB
// Owner :Satheeshkumar C 
// Creation date:21-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateArhiveDBSearchAllPatient(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of Searching by different fields in Arhive DB"+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for different fields***");

    var LastName = Data.getData(TestName,"Patient","LastName");
// To maximize the window
  var DBWindow = vProcess.Find("Name","WPFObject(\"HwndSource: WindowMain\", \"MV Archive/Production DB Update\")",1000);
    DBWindow.Maximize();
// Check archive DB not selected by default    
  var ArchDBRadio = vProcess.Find("Name","WPFObject(\"RadioButton\", \"Archive\", 2)",1000);
  
  if (ArchDBRadio.IsChecked == false)
    {
    Log.Message("Archive DB not selected by default");
    
    }else {
    Log.Error("Archive DB selected by default instead of Production DB");
    exestatus = false;
    }

// Select the Archive DB to proceed the search
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"RadioButton\", \"Archive\", 2)",exestatus);

       
   
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
  aqUtils.Delay(3000);
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  //patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");
  //var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleOnScreen");
  Log.Message("No of rows visible on screen: " + RowCount);
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       //patGridRow.Keys("[^]");
       patGridRow.Keys("[Down]");
       var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	 var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);
   if ( admittedPatientList.IsSelected== false){
   Log.Message("Unable to select multiple rows by using Cont Key");
   }
      
	  var searchFirstName = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
    var listFirstName = aqObject.GetPropertyValue(searchFirstName, "Text");  
	  Log.Message("Patient FirstName: "+ listFirstName);
    
	}
  



 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Patient with given search criteria's are matching with search result");
      Log.Checkpoint("Searching by different fields in Archive DB","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Searching by different fields in Archive DB","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDBUpdateNoResult
// Desc :Function to search a patient that does not exits in production DB & validate
// Owner :Satheeshkumar C 
// Creation date:26-Dec-2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvDBUpdateNoResult(TestName,exestatus)
{
 
 
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"Patient","TC_DESC");
Log.Checkpoint("Start of search a patient that does not exits in database "+tcDesc ,"The flow is started");
   
   //Start of the feature 
	 vProcess = Sys.Process("MvDBUpdate");
   
 
	// ** Fill in the details for different fields **
Log.Message("***Enter details for MRN field***");

    var MRN = Data.getData(TestName,"Patient","MRN");
    
// Check archive DB not selected by default    
  var ArchDBRadio = vProcess.Find("Name","WPFObject(\"RadioButton\", \"Archive\", 2)",1000);
  
  if (ArchDBRadio.IsChecked == false)
    {
    Log.Message("Archive DB not selected by default");
    
    }else {
    Log.Error("Archive DB selected by default instead of Production DB");
    exestatus = false;
    }

// Enter patient ID that dose available in production DB
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"TextEdit\", \"\", 3)",MRN,exestatus);

// Click on search button  
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Search\", 1)",exestatus);
  
  aqUtils.Delay(3000);
  exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TableView\", \"\", 1)", 120,exestatus);
  
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"GridControl\", \"\", 1)", 1000); 
  patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "VisibleRowCount");
  
  
	 var k = 0;
	 var j = 0;
  for (i = 1; i <= RowCount; i++) {
  
        j = j+1; 
  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  if(!patGridRow.exists)
  {
  j=1;
  }  
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
       
   var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	 var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 5)", 1000);  
	 var searchMRN = admittedPatientList.FindChild("Name", "WPFObject(\"TextEdit\", \"\", 1)", 1000);
  
	 var listMRN = aqObject.GetPropertyValue(searchMRN, "Text");
	  
	Log.Message("Patient MRN: "+ listMRN);
  
  if (aqString.Compare(listMRN, MRN,false)== 0 ) {
  
        Log.Error("Patient match is found for the data that dose not exits in database ");
    k = 1
    exestatus = false
    break;
    
	    }
    k = 0;  
  
  break;

	}
  

  if (k===0){  
		Log.CheckPoint("Patient with given search criteria is not found when data dose not exits in database ")
		exestatus = true
    }

    


 if (equal(exestatus,true)) {
	 	  Log.Checkpoint("No search result being displayed when data dose not exits in database");
      Log.Checkpoint("Search a patient that does not exits in database","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped search a patient that does not exits in database","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MveHOCRegularMedication
// Desc :
// Owner :Satheeshkumar C
// Creation date: 10 Jan 2018
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MveHOCRegularMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"eHOC","TC_DESC");

Log.Checkpoint("To validate regular medication details in eHOC report ","The flow is started");

// To select eHOC from nursing menu
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "eHOC");
	
  //Start of the feature 
	 //vProcess = Sys.Process("AcroRd32");
  
  // To load the PDF document
 docobj = PDF_Function.loadDocument("C:\Users\60107922\AppData\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5\X5XSCWJM\Report[1].pdf") 
 
 // To get the desired page from list of pages
 //pageObj = getPage ( docobj, 6)
 
 // To get text from desired page
 
 text = getTextDiffrentPages (docobj,6,6)
 Log.Message(text);

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Regular medication details for the patient validated successfully");
      Log.Checkpoint("End of validating regular medication details in eHOC report ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of regular medication in eHOC report","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrintPatientBelongings
// Desc :Feature to Print Patient Belongings List
// Owner :Sangiliraja J
// Creation date:Nov 21 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Printing Patient Belongings List
function MvPrintPatientBelongings(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Print Patient Belongings List for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Print Patient Belongings List.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Patient Belongings");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Print Patient Belongings List form data ***");
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

	
        var Clothing = Data.getData(TestName,"OtherCare1","Clothing");
        var Effects = Data.getData(TestName,"OtherCare1","Effects");
        var Items = Data.getData(TestName,"OtherCare1","Items");
        var Security = Data.getData(TestName,"OtherCare1","Security");
        var PersonChecking = Data.getData(TestName,"OtherCare1","PersonChecking");
        var PersonVerifying = Data.getData(TestName,"OtherCare1","PersonVerifying");
	
	      exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Clothing,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Effects,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Items,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Security,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",PersonChecking,exestatus);
        exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",PersonVerifying,exestatus);
	 
   // Save the form data and Print Preview the document for Printing
	      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        aqUtils.Delay(2000);
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
        //var To = Data.getData(TestName,"OtherCare","To");
        //exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"mvcboTimeTo\")", "Current",exestatus);
        //exestatus = mvObjects.wildcardfullname(vProcess, "*WinFormsObject(\"frmRBPrint\").WinFormsObject(\"fraTime\").WinFormsObject(\"mvcboTimeTo\")","ImdComboBox",To,exestatus);
        exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdPreview\")",exestatus);
        aqUtils.Delay(3000);
        exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmRBPreview\").WinFormsObject(\"cmdClose\")",exestatus);
        aqUtils.Delay(1000);
        exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WinFormsObject(\"frmRBPrint\").WinFormsObject(\"cmdClose\")",exestatus);
        
  
	// Clicking on Save and Close.
	 
        aqUtils.Delay(3000);
       exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
    if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Print Patient Belongings List is successful");
      Log.Checkpoint("End Print Patient Belongings List","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Print Patient Belongings List","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************// 

//******************************************************************************************//
//******************************************************************************************//


// Name :MvAssessMetabolicDischarge
// Desc :Feature to AssessMetabolicDischarge
// Owner :Sangiliraja J
// Creation date:21 Nov 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvAssessMetabolicDischarge(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {




var tcDesc = Data.getData(TestName,"Medications","TC_DESC");
Log.Checkpoint("Start of Assess Metabolic Discharge"+tcDesc ,"The flow is started");
	
  
//Start of the feature 
vProcess = Sys.Process("iMDSoft.Metavision");


//** Fill in the details for prescribe medication tab**  
Log.Message("*** Enter details for Prescribe medication");

var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity=Data.getData(TestName,"Medications","quantity");
var DoseRate = Data.getData(TestName,"Medications","DoseRate");
var Diluent_Quant = Data.getData(TestName,"Medications","Diluent_Quant");
var Password = Data.getData(TestName,"Navigation","Password");
 


Log.Message("*** Enter details for Medication");
//Prescribe Medication
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);


//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype,exestatus)
//exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);



// Enter medication quantity 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);

// enter infuse over
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Main_Group\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"OrderingStyle\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 4).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"HybridRangeEdit\", \"\", 1)",3,exestatus);


// Saving the order
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review and resolve the issue

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

//Click on Prescribe TPN Products 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",4)",exestatus);

// Selecting different tab
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"TabGrid\").WPFObject(\"MvTab\").WPFObject(\"TabItem\", \"\", 2)",exestatus);

// Click on Blood Products
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1)*.WPFObject(\"ImdButton\", \"\",1)",exestatus);

// Click on TPN-BLT
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"picTabs\")*.WPFObject(\"cmdAction_2\")",exestatus);


//Entering values in orderable window 
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",Diluent_Quant,exestatus);
exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"OrderingStyleRow\").WPFObject(\"OrderingStyleView\", \"\", 1).WPFObject(\"Order_Style_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 2).WPFObject(\"Grid\", \"\", 2).WPFObject(\"RateRange\")",DoseRate,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"OK\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);


//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

// Selecting Medication plan tab
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);
// Validation of AssessMetabolicStatus- Flow sheet

// Selecting Metabolic tab for assessing Status
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,19",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Successfully Assessed Metabolic Discharge");
      Log.Checkpoint("End of Assess Metabolic Discharge","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Assess Metabolic Discharge","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//


// Name :MvPlanPatientCare
// Desc :Feature to Plan Patient Care
// Owner :Sangiliraja J
// Creation date:21 Nov 2017
// Update By :Sangiliraja J
// Update date:Dec 06,2017
// Update desc:Included Timed Interventions and flow for Dose and Task list
//******************************************************************************************//
//******************************************************************************************//

//Flowsheet Validation to be completed//

function MvPlanPatientCare(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Plan Patient Care for "+tcDesc ,"The flow is started");
//Start of the feature 
// Wait for screen to appear

vProcess = Sys.Process("iMDSoft.Metavision");
exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
// ** Fill in the details to Plan Patient Care **
Log.Message("*** enter details for Plan Patient Care for patient ***");
 

var Password = Data.getData(TestName,"Navigation","Password");

//Clicking the Care Plan Interventions tab as below

exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\",9)",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",31)",exestatus);
//aqUtils.Delay(1000);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",30)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 1)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 3)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 4)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 5)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 6)",exestatus);
aqUtils.Delay(1000);
var medicaltype6=Data.getData(TestName,"OtherCare1","medicaltype6");
var SetInterval1=Data.getData(TestName,"OtherCare1","SetInterval1");

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype6,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval1,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 7)",exestatus);
aqUtils.Delay(1000);
var medicaltype1=Data.getData(TestName,"OtherCare1","medicaltype1");

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype1,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 5).WPFObject(\"Button\", \"OK\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 8)",exestatus);
aqUtils.Delay(1000);
var medicaltype6=Data.getData(TestName,"OtherCare1","medicaltype6");
var SetInterval1=Data.getData(TestName,"OtherCare1","SetInterval1");

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype6,exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 3).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval1,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 9)",exestatus);
aqUtils.Delay(1000);
var medicaltype1=Data.getData(TestName,"OtherCare1","medicaltype1");

//Frequency
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype1,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrderEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Main_Group\").WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 5).WPFObject(\"Button\", \"OK\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 10)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 11)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 12)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 13)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 14)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);
aqUtils.Delay(1000);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 15)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 17)",exestatus);

var Medicine = Data.getData(TestName,"OtherCare1","Medicine");
var Totaldiscarded  = Data.getData(TestName,"OtherCare1","Totaldiscarded");
var Concept1 = Data.getData(TestName,"OtherCare1","Concept1");

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Medicine,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Totaldiscarded,exestatus);
exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"txtFreeText_2\")",Concept1,exestatus); 

// Save the form data

//Click on Sign and then wait for "save and sign"
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSignet\")",exestatus);
aqUtils.Delay(1000);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"2\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"mnuSignet\").WPFObject(\"2\")",exestatus);

var Password = Data.getData(TestName,"Navigation","Password");

exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtPassword\")", Password ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
var MsgForm = vProcess.Find("FullName", "*WinFormsObject(\"ImdFormBase\").WinFormsObject(\"Buttons\")", 1000);
     
    if (MsgForm.Exists)
    {
    
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
    
aqUtils.Delay(1000);
//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 18)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 19)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 20)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 21)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 22)",exestatus);
aqUtils.Delay(1000);
//var medicaltype3=Data.getData(TestName,"OtherCare1","medicaltype3");

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype3,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 23)",exestatus);
aqUtils.Delay(1000);
//var medicaltype4=Data.getData(TestName,"OtherCare1","medicaltype4");

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype4,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 24)",exestatus);
aqUtils.Delay(1000);
//var medicaltype2=Data.getData(TestName,"OtherCare1","medicaltype2");

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype2,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 24)",exestatus);
aqUtils.Delay(1000);
//var medicaltype5=Data.getData(TestName,"OtherCare1","medicaltype5");

//exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem", medicaltype5,exestatus);

//exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 25)",exestatus);
aqUtils.Delay(1000);
var Specify = Data.getData(TestName,"OtherCare","Specify");
var Concept2 = Data.getData(TestName,"OtherCare","Concept2");

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Specify,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBox",Specify,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBox",Specify,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Concept2,exestatus);

//// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSignet\")",exestatus);
//
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"mnuSignet\").WPFObject(\"2\")",exestatus);
//
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtPassword\")", "P@ssword" ,exestatus);
exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 26)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 27)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 28)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 29)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\",\"OK\",1)",exestatus);

//Clicking on Timed Interventions

//var Specify = Data.getData(TestName,"OtherCare","Specify");
var Feeding  = Data.getData(TestName,"OtherCare1","Feeding");
var Analgesia = Data.getData(TestName,"OtherCare1","Analgesia");
var Sedation = Data.getData(TestName,"OtherCare1","Sedation");
var Throm = Data.getData(TestName,"OtherCare1","Throm");
var Head = Data.getData(TestName,"OtherCare1","Head");
var Ulcer = Data.getData(TestName,"OtherCare1","Ulcer");
var Glucose = Data.getData(TestName,"OtherCare1","Glucose");
var Comment1 = Data.getData(TestName,"OtherCare1","Comment1");
var Comment2 = Data.getData(TestName,"OtherCare1","Comment2");
var Comment3 = Data.getData(TestName,"OtherCare1","Comment3");
var Comment4 = Data.getData(TestName,"OtherCare1","Comment4");
var Comment5 = Data.getData(TestName,"OtherCare1","Comment5");
var Comment6 = Data.getData(TestName,"OtherCare1","Comment6");
var Comment7 = Data.getData(TestName,"OtherCare1","Comment7");

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 1)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 3)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 4)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 5)",exestatus);
aqUtils.Delay(1000);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
// Commenting since IABP removed from timed interventions
//exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ShoppingCartView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"mvToolBarBorder\").WPFObject(\"mvToolBar\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 2)",exestatus);
//exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"ToolbarView\", \"\", 1).WPFObject(\"MainGridLayout\").WPFObject(\"MainToolBarGrid\").WPFObject(\"TabGrid\").WPFObject(\"ToolStripBorder\").WPFObject(\"MvToolbar1\").WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\", 5)",exestatus);
//aqUtils.Delay(1000);
//exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 6).WPFObject(\"Button\", \"Initiate\", 1)",exestatus);


//Clicking on the Fasthug
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",3)",exestatus);

exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Feeding,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Analgesia,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Sedation,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",Throm,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",Head,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",Ulcer,exestatus);
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",Glucose,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",Comment1,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",Comment2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",Comment3,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",Comment4,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Comment5,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Comment6,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_7\")",Comment7,exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Dose & Task List");

exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: DoseAndTaskListViewModelBase\").WPFObject(\"DoseAndTaskListViewModelBase\").WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"DoseAndTaskReminderView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Button\", \"Close\", 1)",exestatus);

 
   if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully Plan Patient Care Details");
      Log.Checkpoint("End Plan Patient Care","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Plan Patient Care","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvNavigatePatientFiles
// Desc :Feature to Navigate Between Patient Files
// Owner :Sangiliraja J
// Creation date:Nov 22 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for Navigate Between Patient Files
function MvNavigatePatientFiles(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Navigate Between Patient Files for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  //var ms = 6000;
      //var HelpStr = "Delaying test run for " + ms + " milliseconds, To Navigate Between Patient Files.";
      //aqUtils.Delay (ms, HelpStr);

        	
	// Wait for screen to appear
	//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter Navigate Between Patient Files ***");
	
  
   //aqUtils.Delay(1000);

        

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Navigate Between Patient Files is successful");
      Log.Checkpoint("End Navigate Between Patient Files","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Navigate Between Patient Files","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvFluidBalancesCheck
// Desc :Flow to FluidBalancesCheck
// Owner :Sangiliraja J
// Creation date:Nov 22, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

// Feature created for MV FluidBalancesCheck
function MvFluidBalancesCheck(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start FluidBalancesCheck for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Review FluidBalancesCheck.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 18)",exestatus);
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ImdButton\",\"\",1)",exestatus);
        exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_29\")",exestatus);
        
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** FluidBalancesCheck ***");
	
        var DoesPatient = Data.getData(TestName,"MedicalCare","DoesPatient");
	var MechanismofInjury = Data.getData(TestName,"MedicalCare","MechanismofInjury");
  let BurnAdmission = new Object();
  
              BurnAdmission.TimeofBurn = Data.getData(TestName,"MedicalCare","TimeofBurn")
              DTDay = aqString.substring(BurnAdmission.TimeofBurn, 0, 2);
	            DTMonth = aqString.substring(BurnAdmission.TimeofBurn, 3, 2);
	            DTYear= aqString.substring(BurnAdmission.TimeofBurn, 6, 4);

	var DescriptionofInjury = Data.getData(TestName,"MedicalCare","DescriptionofInjury");
        

        var TBSADermal = Data.getData(TestName,"MedicalCare","TBSADermal");
        var TBSAFullThickness = Data.getData(TestName,"MedicalCare","TBSAFullThickness");
        var TBSATotal = Data.getData(TestName,"MedicalCare","TBSATotal");
        var Tetanus = Data.getData(TestName,"MedicalCare","Tetanus");
	      var FirstAid = Data.getData(TestName,"MedicalCare","FirstAid");	
	      var Current = Data.getData(TestName,"MedicalCare","Current"); 
        var Component = Data.getData(TestName,"MedicalCare","Component");
        var Evidence = Data.getData(TestName,"MedicalCare","Evidence");
        var ICU = Data.getData(TestName,"MedicalCare","ICU");
        var Opthalmology = Data.getData(TestName,"MedicalCare","Opthalmology");
        var PainScore = Data.getData(TestName,"MedicalCare","PainScore");
        var RASS = Data.getData(TestName,"MedicalCare","RASS");
        var CAM = Data.getData(TestName,"MedicalCare","CAM");
        var Airway = Data.getData(TestName,"OtherCare1","Airway");
        var Isthere = Data.getData(TestName,"MedicalCare","Isthere");
        var AirwayInhalation = Data.getData(TestName,"MedicalCare","AirwayInhalation");
        var Interventions = Data.getData(TestName,"MedicalCare","Interventions");
        var Plan = Data.getData(TestName,"MedicalCare","Plan");
        var Crystalloids = Data.getData(TestName,"MedicalCare","Crystalloids");
        var TotalFluids = Data.getData(TestName,"MedicalCare","TotalFluids");
        var Colloids = Data.getData(TestName,"MedicalCare","Colloids");
        var Bloods = Data.getData(TestName,"MedicalCare","Bloods");
        var Parkland = Data.getData(TestName,"MedicalCare","Parkland");
        var ParklandFormula = Data.getData(TestName,"MedicalCare","ParklandFormula");
        var BalanceFirstEight = Data.getData(TestName,"MedicalCare","BalanceFirstEight");
        var RateFirstEight = Data.getData(TestName,"MedicalCare","RateFirstEight");
        var BalanceNextSixteen = Data.getData(TestName,"MedicalCare","BalanceNextSixteen");
        var RateNextSixteen = Data.getData(TestName,"MedicalCare","RateNextSixteen");
        var TargetMinimum = Data.getData(TestName,"MedicalCare","TargetMinimum");
        var TargetMaximum = Data.getData(TestName,"MedicalCare","TargetMaximum");
        var WeightonAdmission = Data.getData(TestName,"MedicalCare","WeightonAdmission");
        


	       //exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",DoesPatient,exestatus);
         exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_1\").WPFObject(\"cboTextCombo_1\")","ImdComboBox",DoesPatient,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_1\")",MechanismofInjury,exestatus);
         exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", DTDay,DTMonth,DTYear,"00","00",exestatus); 
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_2\")",DescriptionofInjury,exestatus);
        
         
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",TBSADermal,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",TBSAFullThickness,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_1\")",Tetanus,exestatus);
         //exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",FirstAid,exestatus);
         exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_3\").WPFObject(\"cboTextCombo_3\")","ImdComboBoxItem",FirstAid,exestatus);  
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_2\")",Current,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_2\")",Component,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkTrue_3\")",Evidence,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_3\")",ICU,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"chkFalse_4\")",Opthalmology,exestatus);
         exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_4\").WPFObject(\"cboTextCombo_4\")","ImdComboBoxItem",PainScore,exestatus);  

         exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_5\").WPFObject(\"cboTextCombo_5\")","ImdComboBoxItem",RASS,exestatus);  

         exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_6\").WPFObject(\"cboTextCombo_6\")","ImdComboBoxItem",CAM,exestatus);  

         //exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtFreeText_6\")",exestatus);
         exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_6\").WPFObject(\"txtFreeText_6\")",exestatus);
         //exestatus = mvObjects.wildcardfullname(vProcess,"*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_4\").WPFObject(\"txtFreeText_4\")","ImdTextBox",AirwayInhalation,exestatus);
         exestatus = mvObjects.selectCheckComboItem(vProcess, "WPFObject(\"cboTextComboMulti_3\")",Isthere,exestatus);
         //exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_7\")",Airway,exestatus);
         exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextCombo_7\").WPFObject(\"cboTextCombo_7\")","ImdComboBoxItem",Airway,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_4\")",AirwayInhalation,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_5\")",Interventions,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_6\")",Plan,exestatus);
         exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_2\").WPFObject(\"picNumeric_6\").WPFObject(\"txtNumeric_6\")",exestatus);
         //exestatus = mvObjects.scrollUntilVisible("WPFObject(\"txtNumeric_6\")",exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",Crystalloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_4\")",Colloids,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_5\")",Bloods,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_6\")",WeightonAdmission,exestatus);

         //Calculate Fluid Reuscitation
          exestatus = mvObjects.scrolmultiwindow(1,"*WPFObject(\"HwndSource: frmMain\", \"\", 1)."+"*WPFObject(\"picFrameIn_2\").WPFObject(\"picFormula_15\").WPFObject(\"txtFormula_15\")",exestatus);
         exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_2\").WPFObject(\"picFrameIn_2\").WPFObject(\"cmdAction_3\")",exestatus);
         var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
   // iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSave\")",exestatus);
    }
         
    // close the form 
	      exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
        //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
	//Checking the Input Output tab for the Fluid Balances check

        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
    
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" FluidBalancesCheck is successful");
      Log.Checkpoint("FluidBalancesCheck","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped FluidBalancesCheck","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvRecordPatientDeath
// Desc :Feature to Record Patient Death
// Owner :Sangiliraja J
// Creation date: 23 Nov 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvRecordPatientDeath(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");

Log.Checkpoint("To Record Patient Death ","The flow is started");
	
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");
   
//var DeathTime = Data.getData(TestName,"Patient","DeathTime");
	// Open Patient demographcs
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient Demographics");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"capXP\")", 120,exestatus);
  
  let PatientDemo = new Object();
  
        PatientDemo.DeathDate = Data.getData(TestName,"Patient","DeathDate")
        DTDay = aqString.substring(PatientDemo.DeathDate, 0, 2);
	      DTMonth = aqString.substring(PatientDemo.DeathDate, 3, 2);
	      DTYear= aqString.substring(PatientDemo.DeathDate, 6, 4);
        
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", DTDay,DTMonth,DTYear,"00","00",exestatus); 
exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", "00","00","0000","12","00",exestatus); 
//exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"dtpDate_3\")",DeathTime ,exestatus);
     
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);    

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Record Patient Death updated successfully");
      Log.Checkpoint("End of Record Patient Death","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped updating Record Patient Death","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvAssembleModifyPatient
// Desc :Function to AssembleModifyPatient on MV
// Owner :Sangiliraja J 
// Creation date:Nov 23, 2017
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
// Feature created for MV AssembleModifyPatient to MV
function MvAssembleModifyPatient(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"Navigation");
var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
Log.Checkpoint("Start MvAssembleModifyPatient","The flow is started");
	//Start of the feature 
	

	var facility = Data.getData(TestName,"Navigation","Department");
	var bed = Data.getData(TestName,"Navigation","Bed");
	var layout = Data.getData(TestName,"Navigation","Layout");
  var bedNumber = bed + " (Active)"
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Open Worklist
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
  
	// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

  // Find a bed that is empty (or close Bed 02)
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
        j = j+1; 
    var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       patGridRow.Click();
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
	Log.Message("Patient Bed Details: "+ patientListDetails);
  
	if (aqString.Contains(patientListDetails, bedNumber) != -1) {
		admittedPatientList.ClickR();
		exestatus = mvObjects.buttonClick(vProcess, "Text", "Add to My List",exestatus);
    Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("Pre-admit and Admitted Only|My List");
    		// Wait for Worklist screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"Last refresh\", 1)", 120,exestatus);

  // Find a bed that is empty (or close Bed 02)
  var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000); 
  patientsGrid.Keys("[Home]");
  var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
  Log.Message(RowCount)
  var j = 0;
  for (i = 1; i <= RowCount; i++) {
        j = j+1; 
     var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
  
  if(!patGridRow.exists)
  {
  j=1;
  }
  var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\","+j+")", 1000);
       
       patGridRow.Keys("[Down]");
       patGridRow.Keys("[Down]");
   
  var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000); 
  
	var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 1)", 1000);  
	var patientListDetails = aqObject.GetPropertyValue(admittedPatientList, "ToolTip");
	Log.Message("Patient Bed Details: "+ patientListDetails);
  
	if (aqString.Contains(patientListDetails, bedNumber) != -1) {
		admittedPatientList.ClickR();
		exestatus = mvObjects.buttonClick(vProcess, "Text", "Remove from My List",exestatus);
    aqUtils.Delay(1000);
    Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Part_SlidePanel.Menu.WPFMenu.Click("My List|Change Patient Set|NSW|Pre-admit and Admitted Only");
    control = vProcess.Find("ToolTip", "Close", 1000);
	control.click();

   
if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" AssembleModifyPatient is successful");
      Log.Checkpoint("AssembleModifyPatient","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped AssembleModifyPatient","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}}}}}


//******************************************************************************************//
//******************************************************************************************//
// Name :MvDocumentPresenceTTube
// Desc :Flow to Document Presence of Transpyloric Tube
// Owner :Sangiliraja J
// Creation date:Dec 01, 2017
// Update By :Sangiliraja J
// Update date:Dec 21,2017
// Update desc:Updated TTube from Medical menu also
//******************************************************************************************//
//******************************************************************************************//

function MvDocumentPresenceTTube(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start T Tube documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");
//Presence of the T Tube

exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Lines / Drains / Tubes","Drains","Gastrointestinal","T-Tube");
// Wait for screen to appear

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
// ** Fill in the details for T Tube **
Log.Message("*** enter details for T Tube ***");
 
var Nage = Data.getData(TestName,"OtherCare1","Nage");
exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"txtNumeric_1\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"txtNumeric_1\")",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Nage,exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Lume  = Data.getData(TestName,"OtherCare1","Lume");
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Lume,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Condi = Data.getData(TestName,"OtherCare1","Condi");
exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 3)",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_1\").WPFObject(\"lstTextList_1\").WPFObject(\"ListBoxItem\", \"\", 4)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Car = Data.getData(TestName,"OtherCare1","Car");

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 5)",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picTextList_2\").WPFObject(\"lstTextList_2\").WPFObject(\"ListBoxItem\", \"\", 6)",exestatus);

// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);

exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Tubes","Gastrointestinal","Transpyloric Tube");
// Wait for screen to appear
exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: ImdGenericWindow\", \"\").WPFObject(\"ImdGenericWindow\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"OrphanDoseEntryView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"LayoutControl\", \"\", 2).WPFObject(\"Buttom_Group\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"AttachedFormsView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ScrollableToolBar\", \"\", 1).WPFObject(\"ContentPresenter\", \"\", 1).WPFObject(\"Button\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
// ** Fill in the details for T Tube **
Log.Message("*** enter details for T Tube ***");
 
var Siz = Data.getData(TestName,"OtherCare1","Siz");
var Loc  = Data.getData(TestName,"OtherCare1","Loc");
var Pos = Data.getData(TestName,"OtherCare1","Pos");

exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"txtNumeric_1\")", 120,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"txtNumeric_1\")",exestatus);

exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_1\")",Siz,exestatus);
exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Loc,exestatus); 
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",Pos,exestatus);


// Save the form data
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);


// Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
      if (equal(exestatus,true)) {
      Log.Checkpoint(" successfully initiated Documentation of T Tube");
      Log.Checkpoint("End Tc Tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Transpyloric Tube initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MvCompleteRuleNinesChart
// Desc :Flow to CompleteRuleNinesChart
// Owner :Sangiliraja J
// Creation date:Dec 1, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvCompleteRuleNinesChart(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start CompleteRuleNinesChart for "+tcDesc ,"The flow is started");
//Start of the feature 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns", "Burns Admission Management");
// Wait for screen to appear
//Rule of Nine Chart
 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_1\")",exestatus); 

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_1\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

     
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully CompleteRuleNinesChart");
      Log.Checkpoint("End CompleteRuleNinesChart","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped CompleteRuleNinesChart ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}



//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvViewPathology
// Desc :Flow to ViewPathology
// Owner :Sangiliraja J
// Creation date:Dec 04, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvViewPathology(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start ViewPathology documentation for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

// Validation of data in Pathology tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 15)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"TabularGridTChart\").WPFObject(\"MainCanvas\").WPFObject(\"CmdEdit\")",exestatus);
   exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MvMenuControl\").WPFObject(\"ImdMenuItem\", \"Show empty rows\", 3)",exestatus);
 
      if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated ViewPathology");
      Log.Checkpoint("End ViewPathology","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ViewPathology","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
 //******************************************************************************************//
//******************************************************************************************//


// Name :MvCompleteInjurySeverity
// Desc :Feature to CompleteInjurySeverity
// Owner :Sangiliraja J
// Creation date:4 Dec 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvCompleteInjurySeverity(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"HandOver");
var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start CompleteInjurySeverity for "+tcDesc ,"The flow is started");
//Start of the feature 
 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Injury Severity Score");
// Wait for screen to appear

exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
// ** Fill in the details to CompleteInjurySeverity **
Log.Message("*** enter details for CompleteInjurySeverityfor patient ***");
 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
var Total = Data.getData(TestName,"HandOver","Total");
var Head = Data.getData(TestName,"HandOver","Head");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Head,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Face  = Data.getData(TestName,"HandOver","Face");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_2\")",Face,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Chest = Data.getData(TestName,"HandOver","Chest");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_3\")",Chest,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Abdomen = Data.getData(TestName,"HandOver","Abdomen");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_4\")",Abdomen,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var Extremity = Data.getData(TestName,"HandOver","Extremity");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_5\")",Extremity,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

var External = Data.getData(TestName,"HandOver","External");
exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_6\")",External,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }


// Save the form data
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);

        
	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedUservalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	
        // close the form 
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
	      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	
//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Scores","Injury Severity Score");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 

  var documentedUserValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedUservalue,documentedUserValue,false) ==0)
  {
  Log.Checkpoint("Saved by user details are matching");
  }
  else
  {
  Log.Error("Saved by user details are not matched");
  exestatus =false;
  }
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFormula_1\")","Text",Total, "Total",exestatus);
// Close the form 
        
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	 
   if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully CompleteInjurySeverity");
      Log.Checkpoint("End CompleteInjurySeverity","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped CompleteInjurySeverity","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvUploadMedicalRetrieval
// Desc :Flow to UploadMedicalRetrieval
// Owner :Sangiliraja J
// Creation date:Dec 5, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvUploadMedicalRetrieval(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start UploadMedicalRetrieval for "+tcDesc ,"The flow is started");
//Start of the feature 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
// Wait for screen to appear
//Upload Medical Retrieval Documents
 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_2\")",exestatus); 

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picImage_1\").WPFObject(\"ileImage_1\").WPFObject(\"Canvas\", \"\", 1).WPFObject(\"_cmdAction_4\")",exestatus);

exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);

var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }

exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"cmdCancel\")",exestatus);

    
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully UploadMedicalRetrieval");
      Log.Checkpoint("End UploadMedicalRetrieval","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped UploadMedicalRetrieval ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}



//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvConfirmCurrentAllergies
// Desc :Feature to ConfirmCurrentAllergies
// Owner :Sangiliraja J
// Creation date:Dec 07 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvConfirmCurrentAllergies(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {
var tcDesc = Data.getData(TestName,"HandOver","TC_DESC");
Log.Checkpoint("Start Allergies for the patient "+tcDesc ,"The flow is started");

//Start of the feature  
vProcess = Sys.Process("iMDSoft.Metavision");

// Enter the Allergy Details
exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Allergies/ADR");


var allergies = vProcess.Find("Name", "WinFormsObject(\"MvcmdRemoveAllergy\")", 1000);
var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"FormCaption\")", 1000);
    
  if (allergies.Enabled == true)
  {
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"mvcmdEditAllergy\")",exestatus);
  Log.message("Edit the existing allergies");
  }
  else {
    Log.Message("No Allergy details");
       }
 
var type = Data.getData(TestName,"HandOver","type");
Log.message("Drug type value is ",type);
var seldrfam = Data.getData(TestName,"HandOver","seldrfam");
Log.message("Selected Drug family is ",seldrfam);
var seldrfam1 = Data.getData(TestName,"HandOver","seldrfam1");
Log.message("Selected Drug family is ",seldrfam1);
var med = Data.getData(TestName,"HandOver","med");
Log.message("Medication ",med);
var ingr = Data.getData(TestName,"HandOver","ingr");
Log.message("Ingredient ",ingr);
var msc = Data.getData(TestName,"HandOver","msc");
Log.message("Miscellaneous ",msc);
var Rea = Data.getData(TestName,"HandOver","Rea");
Log.message("Reactions ",Rea);
var Comment = Data.getData(TestName,"HandOver","Comment");
var Password = Data.getData(TestName,"Navigation","Password");

switch(type){
case ("Drug Family"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam,exestatus);
break;

case ("Drug subfamily"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",seldrfam1,exestatus);
break;

case ("Medication"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",med,exestatus);
break;

case ("Ingredient"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",ingr,exestatus);
break;

case ("Miscellaneous"):
exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboSelectedObject\")",msc,exestatus);
break;

default:
Log.Message("Did not enter drug type");

}
exestatus = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"mvstlReactions\")",25,56,exestatus);
exestatus  = mvObjects.ClickCoordinates(vProcess,"Name", "WinFormsObject(\"stCombobox\")",346,15,exestatus); 
exestatus = mvObjects.SearchSelectItem(vProcess,"WinFormsObject(\"Panel\" , \"\"\)",1,1,Rea,2,exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\"\)", Comment,exestatus);
exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);


//Check for Popup message (Allergen was previously documented for this patient

var Msgwindow = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
if (Msgwindow.Exists)
   {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    Log.Message("Allergen details was previously documented for this patient");
    }
    else
{
Log.Message("Allergen details have not been documented for this patient");
}

//Click on Save button in drug details window

exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdSave\")",exestatus);

//Check for Allergies Warning


var Password = Data.getData(TestName,"Navigation","Password");
   
var allergywindow = vProcess.Find("Name", "WinFormsObject(\"frmAllergyAlert\")", 1000);

if (allergywindow.Exists)
   {
 
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtRPW\")",Password,exestatus);
  exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtCommentsAllergies\")",allcomment,exestatus); 
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOk\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
    Log.Checkpoint("Allergies warning is displayed");
    }
    else
{
Log.Checkpoint("No warning message is displayed");
}

 return exestatus;
}
}
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewBurnDepthDescrip
// Desc :Flow to ReviewBurnDepthDescrip
// Owner :Sangiliraja J
// Creation date:Dec 8, 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvReviewBurnDepthDescrip(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start ReviewBurnDepthDescrip for "+tcDesc ,"The flow is started");
//Start of the feature 
 
vProcess = Sys.Process("iMDSoft.Metavision");

exestatus = mvObjects.selectMenuOption(exestatus,"Medical","Burns","Burns Admission Management");
// Wait for screen to appear
//ReviewBurnDepthDescription

        
        var DHead = Data.getData(TestName,"OtherCare1","DHead");
        var FHead = Data.getData(TestName,"OtherCare1","FHead");
        var DNeck = Data.getData(TestName,"OtherCare1","DNeck");
        var FNeck = Data.getData(TestName,"OtherCare1","FNeck");
        var DAntTrunk = Data.getData(TestName,"OtherCare1","DAntTrunk");
        var FAntTrunk = Data.getData(TestName,"OtherCare1","FAntTrunk");
        var DPostTrunk = Data.getData(TestName,"OtherCare1","DPostTrunk");
        var FPostTrunk = Data.getData(TestName,"OtherCare1","FPostTrunk");
        var DLeftArm = Data.getData(TestName,"OtherCare1","DLeftArm");
        var FLeftArm = Data.getData(TestName,"OtherCare1","FLeftArm");
        var DRightArm = Data.getData(TestName,"OtherCare1","DRightArm");
        var FRightArm = Data.getData(TestName,"OtherCare1","FRightArm");
        var DButtocks = Data.getData(TestName,"OtherCare1","DButtocks");
        var FButtocks = Data.getData(TestName,"OtherCare1","FButtocks");
        var DGenitalia = Data.getData(TestName,"OtherCare1","DGenitalia");
        var FGenitalia = Data.getData(TestName,"OtherCare1","FGenitalia");
        var DLeftLeg = Data.getData(TestName,"OtherCare1","DLeftLeg");
        var FLeftLeg = Data.getData(TestName,"OtherCare1","FLeftLeg");
        var DRightLeg = Data.getData(TestName,"OtherCare1","DRightLeg");
        var FRightLeg = Data.getData(TestName,"OtherCare1","FRightLeg");
        var DTotal = Data.getData(TestName,"OtherCare1","DTotal");
        var FTotal = Data.getData(TestName,"OtherCare1","FTotal");
        
         exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_2\")",exestatus); 
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_1\").WPFObject(\"txtNumeric_1\")",DHead,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_11\")",FHead,exestatus);
         
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_2\").WPFObject(\"txtNumeric_2\")",DNeck,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_12\")",FNeck,exestatus);
         
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_3\").WPFObject(\"txtNumeric_3\")",DAntTrunk,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_13\")",FAntTrunk,exestatus);
	       
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_4\").WPFObject(\"txtNumeric_4\")",DPostTrunk,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_14\")",FPostTrunk,exestatus);
	       
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_5\").WPFObject(\"txtNumeric_5\")",DLeftArm,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_15\")",FLeftArm,exestatus);
	       
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_6\").WPFObject(\"txtNumeric_6\")",DRightArm,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_16\")",FRightArm,exestatus);
	       
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_7\").WPFObject(\"txtNumeric_7\")",DButtocks,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_17\")",FButtocks,exestatus);
         
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_8\").WPFObject(\"txtNumeric_8\")",DGenitalia,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_18\")",FGenitalia,exestatus);
         
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_9\").WPFObject(\"txtNumeric_9\")",DLeftLeg,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_19\")",FLeftLeg,exestatus);
         
         exestatus = mvObjects.Fullnametext(vProcess, "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picNumeric_10\").WPFObject(\"txtNumeric_10\")",DRightLeg,exestatus);
         exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_20\")",FRightLeg,exestatus);

         //Saving and closing the Lund and Browder tool         
         exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdApply\")",exestatus);

    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"OK\")",exestatus);
    }
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_1\").WPFObject(\"txtFreeText_1\")","Text",DTotal, "DTotal",exestatus);
    exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"picFreeText_2\").WPFObject(\"txtFreeText_2\")","Text",FTotal, "FTotal",exestatus);
    //Open Burns Depth Information
    exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"PicTabsGrid\").WPFObject(\"ScrollViewer\", \"\", 1).WPFObject(\"picTabs\").WPFObject(\"picTab_1\").WPFObject(\"picFrame_1\").WPFObject(\"picFrameIn_1\").WPFObject(\"cmdAction_1\")",exestatus);
    //Close - Burns depth Information
    exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
    //Close - Lund and Browder
    exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\", 1).WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);
    //Close - Burns Management
    exestatus = mvObjects.buttonClick(vProcess, "FullName", "*WPFObject(\"HwndSource: frmMain\", \"\").WPFObject(\"frmMain\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ucFormBuilder_FBForm\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"MainGrid\").WPFObject(\"BottomGrid\").WPFObject(\"FormActionStackPanel\").WPFObject(\"cmdCancel\")",exestatus);

     
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully completed ReviewBurnDepthDescription");
      Log.Checkpoint("End ReviewBurnDepthDescription","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewBurnDepthDescription ","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}



//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvReviewAlliedHealthProgress
// Desc :Feature to ReviewAlliedHealthProgress
// Owner :Sangiliraja J
// Creation date:Dec 13 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to ReviewAlliedHealthProgress
function MvReviewAlliedHealthProgress(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start ReviewAlliedHealthProgress for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To ReviewAlliedHealthProgress.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Allied Health Notes", "Allied Health Progress Note");
	// Wait for screen to appear
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** enter ReviewAlliedHealthProgress Note form data ***");
	
        var AlliedNote = Data.getData(TestName,"OtherCare1","AlliedNote");
	
	exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtFreeText_1\")",AlliedNote,exestatus);
	 
   // Get the save time value
	var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
	
  timeSavedValue = timeSavedValue.OleValue
	Log.Checkpoint("ReviewAlliedHealthProgress Saved Time: "+ timeSavedValue);
	
		// save the form data
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdApply\")",exestatus);
        // to proceed with pop up
       // exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObjects(\"Yes\")",exestatus);
        var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
     
    if (MsgForm.Exists)
    {
    //iMDSoft_Metavision.ImdFormBase.WinFormsObject("Buttons").WinFormsObject("Yes").Click();
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }

	// wait for the form to save.. maybe this object if below don't work -> WPFObject("sessionscontrol")  
	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cmdNewSessionText\")", 120,exestatus);
  
  //Get the form saved time and date
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
  
	// Click Refresh
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdRefresh\")",exestatus); 

  
	// close the form 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
	//Validation part open form again
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes","Allied Health Notes","Allied Health Progress Note");
	// Wait for screen to appear
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
  var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
  if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
  {
  Log.Checkpoint("Time and date are matching");
  }
  else
  {
  Log.Error("time and date are not matched");
  exestatus =false;
  }
  
  
       exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",AlliedNote, "AlliedNote",exestatus);
  	// close the form 
  exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);

//Selecting the Progress Notes Filter
  exestatus = mvObjects.selectMenuOption(exestatus,"Add Progress Notes", "Progress Notes Filter", "Allied Health Filter");

  exestatus = mvObjects.progressnotes(timeSavedValue,"ReviewAlliedHealthProgress",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",AlliedNote, "AlliedNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"TabView\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"proportionalStack\").WPFObject(\"ContentControl\", \"\", 5).WPFObject(\"Grid\", \"\", 1).WPFObject(\"viewBorder\").WPFObject(\"viewPlaceHolder\").WPFObject(\"ChronologyView\").WPFObject(\"RootGrid\").WPFObject(\"fraButtons\").WPFObject(\"cmdEdit\")",exestatus);
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"mnuProperties\").WPFObject(\"1\")",exestatus);

  
  // Click on Progress Notes tab (so can get Add progress notes details)
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\", \"\", 10)",exestatus);
  exestatus = mvObjects.progressnotes(timeSavedValue,"ReviewAlliedHealthProgress",exestatus);
  
  exestatus =  mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"txtFreeText_1\")", "Text",AlliedNote, "AlliedNote",exestatus);
  	// close the form 
  
	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WPFObject(\"cmdCancel\")", 120,exestatus);


  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Document ReviewAlliedHealthProgress to is successful");
      Log.Checkpoint("End ReviewAlliedHealthProgresss Note","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ReviewAlliedHealthProgress Note","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvValidateCorrectUser
// Desc :Feature to ValidateCorrectUser
// Owner :Sangiliraja J
// Creation date:Dec 13 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created for ValidateCorrectUser
function MvValidateCorrectUser(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"OtherCare1","TC_DESC");
Log.Checkpoint("Start Review Status Bar Data for "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To ValidateCorrectUser.";
      aqUtils.Delay (ms, HelpStr);
  
	
		// ** Fill in the Patient details
	Log.Message("*** enter ValidateCorrectUser ***");
	
        var UserName = Data.getData(TestName,"OtherCare1","UserName");
        
exestatus =  mvObjects.verifyObjectProperty(vProcess, "FullName","*WPFObject(\"ContentPresenter\", \"\", 2).WPFObject(\"Border\", \"\", 1).WPFObject(\"StackPanel\", \"\", 1).WPFObject(\"txtParamValue\")" ,"Text", UserName, "Active user",exestatus);


aqUtils.Delay(1000);

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" ValidateCorrectUser is successful");
      Log.Checkpoint("End ValidateCorrectUser","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped ValidateCorrectUser","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//  
//******************************************************************************************//
//******************************************************************************************//
// Name :MvMedicationRecordView
// Desc :Feature to MedicationRecordView
// Owner :Sangiliraja J
// Creation date:Dec 14 2017
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


// Feature created for MV MedicationRecordView
function MvMedicationRecordView(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start MedicationRecordViewfor "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	    var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To  MedicationRecordView.";
      aqUtils.Delay (ms, HelpStr);
  
	
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 12)",exestatus);
       exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);


	// Wait for screen to appear
	//exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"lblFreeText_1\")", 120,exestatus);
		// ** Fill in the Patient details
	Log.Message("*** review the Timerange data ***");
	
  exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);

exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 2)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 3)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 4)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 5)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 6)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 7)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 8)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 9)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 10)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 11)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 12)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 13)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 14)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 15)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 16)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: root\").WPFObject(\"root\").WPFObject(\"Part_MainPlaceHolder\").WPFObject(\"FloatingDockPanel\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"patientView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 4).WPFObject(\"tabControlView\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Items\").WPFObject(\"Grid\", \"\", 1).WPFObject(\"Border\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"menuInterval\").WPFObject(\"MenuItem\", \"1 Hour\", 1)",exestatus);
exestatus = mvObjects.buttonClick(vProcess, "FullName","*.WPFObject(\"HwndSource: PopupRoot\", \"\").WPFObject(\"PopupRoot\", \"\", 1).WPFObject(\"Decorator\", \"\", 1).WPFObject(\"NonLogicalAdornerDecorator\", \"\", 1).WPFObject(\"MenuItem\", \"\", 17)",exestatus);

	
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnPageLeft\")",exestatus);
        exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnPageRight\")",exestatus);

  
  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("MedicationRecordView is successful");
      Log.Checkpoint("End MedicationRecordView","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MedicationRecordView","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}
//*****************************************************//
//*****************************************************//
//******************************************************************************************//
//******************************************************************************************//
// Name :MvVitalSignsWeightsHeights
// Desc :Feature to Vital Signs Weights Heights eHOC
// Owner :Sangiliraja J
// Creation date:Jan 12 2018
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to Vital Signs Weights Heights eHOC
function MvVitalSignsWeightsHeights(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


//var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
//Log.Checkpoint("Start Generating the Vital Signs Weights Heights eHOC report "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Generate the Vital Signs Weights Heights eHOC report.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical","eHOC");
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Generate the Vital Signs Weights Heights eHOC report***");
	
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Generate eHOC report for VitalSignsHeightsWeights is successful");
      Log.Checkpoint("End Generate eHOC report for VitalSignsHeightsWeights","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Generate eHOC report for VitalSignsHeightsWeights","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************// 
//******************************************************************************************//
//******************************************************************************************//
// Name :MveHOCPatientDetails
// Desc :Feature to Patient Details eHOC
// Owner :Sangiliraja J
// Creation date:Jan 22 2018
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to verify Patient Details on the eHOC
function MveHOCPatientDetails(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


//var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
//Log.Checkpoint("Start Generating the Patient Details eHOC report "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Generate the Patient Details eHOC report.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical","eHOC");
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Generate the Patient Details eHOC report***");
	
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Generate eHOC report for eHOCPatientDetails is successful");
      Log.Checkpoint("End Generate eHOC report for eHOCPatientDetails","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Generate eHOC report for eHOCPatientDetails","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************// 

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribeAntimicrobialMedication
// Desc :Feature to PrescribeAntimicrobialMedication
// Owner :Sangiliraja J
// Creation date:Jan 24 2018
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//  


// Feature created to PrescribeAntimicrobialMedication on the eHOC
function MvPrescribeAntimicrobialMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


//var tcDesc = Data.getData(TestName,"OtherCare","TC_DESC");
//Log.Checkpoint("Start Generating the Patient Details eHOC report "+tcDesc ,"The flow is started");
	//Start of the feature 
	
	
	 vProcess = Sys.Process("iMDSoft.Metavision");

	// Patient Details and defaults
	  var ms = 6000;
      var HelpStr = "Delaying test run for " + ms + " milliseconds, To Generate the PrescribeAntimicrobialMedication eHOC report.";
      aqUtils.Delay (ms, HelpStr);
  
	exestatus = mvObjects.selectMenuOption(exestatus,"Medical","eHOC");
	// Wait for screen to appear
	
		// ** Fill in the Patient details
	Log.Message("*** enter Generate the PrescribeAntimicrobialMedication eHOC report***");
	
   		
          if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Generate eHOC report for PrescribeAntimicrobialMedication is successful");
      Log.Checkpoint("End Generate eHOC report for PrescribeAntimicrobialMedication","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Generate eHOC report for PrescribeAntimicrobialMedication","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************// 
function SetHeartRate(ByValHR)
{
  //Clicks the 'btnMoveToCurrentTime' button.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.btnMoveToCurrentTime.ClickButton();
  //Moves the mouse cursor to the menu item specified and then simulates a single click.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.menuInterval.WPFMenu.Click("1 Hour|[0]");
  //Sets the track bar 'Slider' to position 15.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.Slider.wPosition = 15;
  //Clicks at point (222, 12) of the 'tChartConcrol' object.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl.tChartConcrol.Click(222, 12);
  //Enters '5' in the 'tChartConcrol' object.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl.tChartConcrol.Keys(ByValHR);
  //Sets the track bar 'Slider' to position 7.
  Aliases.iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.Slider.wPosition = 7;
  aqUtils.Delay(500)
  
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvSavePDF
// Desc :Feature to save the pdf files in desired location
// Owner :Jyoti Sonar 
// Creation date:Feb 1st 2019
// Update By : Satheeshkumar C
// Update date: 23-Feb-2018
// Update desc: Updated the feature to create the new folder if the folder is not present in the specified path
//******************************************************************************************//
//******************************************************************************************//

function SavePDF(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

var tcDesc = Data.getData(TestName,"eNMIC","TC_DESC");

//Start of the feature 
Log.Checkpoint("Start of saving pdf file","The flow is started");
aqUtils.Delay(20000); 
 var exestatus = true;
 
 // To wait until process exists

// if (Sys.WaitProcess("AcroRd32",-1).Exists)
// var pdf = Sys.Process("AcroRd32",2);

 if (Sys.WaitBrowser("iexplore",-1).Exists)
 var pdf1 = Sys.Browser("iexplore");
 //pdf.Activate();


 var i=0;
 while(i<150000)
  {
    
     i = i + 1;
    if ( (pdf1.Exists && pdf1.VisibleOnScreen) )
      break;
  }
 
  if (! (pdf1.Exists && pdf1.VisibleOnScreen)){
    Log.Error("PDF Window not found."); }
  else{
    Log.Message("PDF Window was found.");
   }

var crefolder = Data.getData(TestName,"eNMIC","crefolder");
if (!aqFileSystem.Exists(crefolder))
    {
       aqFileSystem.CreateFolder(crefolder);
     }else{
     
     Log.Message("Folder already exists");
       }

Sys.Desktop.KeyDown(VK_SHIFT);
Sys.Desktop.KeyDown(VK_CONTROL);
Sys.Desktop.Keys("S")
Sys.Desktop.KeyUp(VK_SHIFT);
Sys.Desktop.KeyUp(VK_CONTROL);
var pdf = Sys.Process("AcroRd32");

var Folderpath = Data.getData(TestName,"eNMIC","Folderpath");
var FileName = Data.getData(TestName,"eNMIC","FileName");
var fname = aqString.Concat(Folderpath, FileName);

    // To enter folder path
   exestatus = mvObjects.enterEditText(pdf, "Window(\"Edit\", \"\", 1)", "^A[Del]",exestatus);
   exestatus = mvObjects.enterEditText(pdf, "Window(\"Edit\", \"\", 1)", fname,exestatus);
   Sys.Desktop.KeyDown(VK_RETURN);
   Sys.Desktop.KeyUp(VK_RETURN);
    
     var override = pdf.Find("Name","Window(\"#32770\", \"Confirm Save As\", 1)",1000);
     if (override.Exists == true){
     exestatus = mvObjects.buttonClick(pdf, "Name","Window(\"Button\", \"&Yes\", 1)",exestatus);
     }else{
     Log.Message("Given file name is not present in specified path");
     }
   
     if (equal(exestatus,true)) {
	 	  Log.Checkpoint("PDF file has been saved to given path with a file name");
      Log.Checkpoint("Saving PDF file","The flow is completed");
    }
    
      //Close the Newly opened IE Browser
var Browser=Sys.Browser("iexplore");
Browser.BrowserWindow(0).Close();
    
//Click on Save and Close
vProcess = Sys.Process("iMDSoft.Metavision");
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

	}
  else{
  Log.Message("Skip Save PDF File","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :Close_Acrobat_Instances
// Desc :Function for terminate/kill the pdf pages and IE session if any open on Script run
// Owner :Jyoti S
// Creation date:Jan 31, 2019
// Update By :
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function CloseAcrobatInstances(TestName,exestatus)
 {
if (equal(exestatus,true)) 
    {
  
  // Obtains the pdf.exe process
  var pdfProcess = Sys.FindChild("ProcessName","AcroRd32");

  // Iterates through all the instances of the pdf.exe process
  // until all of them are closed
  while (pdfProcess.Exists)
  {
    pdfProcess.Terminate();
    // Waits until the process is closed
    var isClosed = pdfProcess.WaitProperty("Exists", false);
   } 
    //Close the Newly opened IE Browser
//var Browser=Sys.Browser("iexplore");
//Browser.BrowserWindow(0).Close();

    // Checks whether the process has been closed successfully
//    if (! isClosed)
//      // Terminates the process
//      pdfProcess.Terminate();
  
}
else{
       Log.Message("CloseAcrobatInstances","The action is skipped since the execution status is set as '"+exestatus+"'");
 
       } 
       
 return exestatus ; 

}
//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MveHOCRegularPRNMedication
// Desc :Feature to validate regular and PRN medication details in eHOC report
// Owner :Satheeshkumar C
// Creation date: 07 Feb 2018
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MveHOCRegularPRNMedication(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"eHOC","TC_DESC");

Log.Checkpoint("To validate regular and PRN medication details in eHOC report ","The flow is started");

	
  //Start of the feature 
	 
 var pdf = Sys.Process("AcroRd32", 2);
 var FilePath =  Data.getData(TestName,"eHOC","FilePath"); 
 var Startlimit = Data.getData(TestName,"eHOC","Startlimit");
 var Endlimit = Data.getData(TestName,"eHOC","Endlimit");
 
  
var drug = Data.getData(TestName,"Medications","drug");
var SetInterval=Data.getData(TestName,"Medications","SetInterval");
var quantity= Data.getData(TestName,"Medications","quantity");
var allcomment = Data.getData(TestName,"Medications","allcomment");
var Dose = Data.getData(TestName,"Medications","Dose");
var Route = Data.getData(TestName,"Medications","Route");
var CurDate = aqDateTime.Today();
var EndDateValue = aqDateTime.AddTime(CurDate, 3, 0, 0, 0);


// To validate the regular & PRN medication details 
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,drug,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,SetInterval,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,quantity,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Dose,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Route,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,EndDateValue,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,allcomment,exestatus);
 
 

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Regular and PRN medication details are validated successfully in eHOC report");
      Log.Checkpoint("End of validating regular and PRN medication details in eHOC report ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of regular and PRN medication details in eHOC report in eHOC report","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//


//******************************************************************************************//
//******************************************************************************************//
// Name :MveHOCAdministrativeDeatils
// Desc :Feature to validate administrative details in eHOC report
// Owner :Satheeshkumar C
// Creation date: 08 Feb 2018
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MveHOCAdministrativeDeatils(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"eHOC","TC_DESC");

Log.Checkpoint("To validate the administrative details in eHOC report ","The flow is started");

	
  //Start of the feature 
	 
 var pdf = Sys.Process("AcroRd32", 2);
 var FilePath =  Data.getData(TestName,"eHOC","FilePath"); 
 var Startlimit = Data.getData(TestName,"eHOC","Startlimit");
 var Endlimit = Data.getData(TestName,"eHOC","Endlimit");
 
  
var HospiName = Data.getData(TestName,"eHOC","HospiName");
var WardName = Data.getData(TestName,"eHOC","WardName");
var DischargeStatus = Data.getData(TestName,"eHOC","DischargeStatus");

let MedicalDischargeSummary = new Object();
MedicalDischargeSummary.UnitAdmiDate = Data.getData(TestName,"OtherCare","HospAdmDT")
Log.Message("Admission date :" +MedicalDischargeSummary.UnitAdmiDate);
MedicalDischargeSummary.UnitDiscDeciDate = Data.getData(TestName,"OtherCare","UntDeciDischDT")
Log.Message("UnitDiscDeciDate :" +MedicalDischargeSummary.UnitDiscDeciDate);
MedicalDischargeSummary.UnitDischargDate = Data.getData(TestName,"OtherCare","UDisDatTime")     
Log.Message("UnitDischargDate :" +MedicalDischargeSummary.UnitDischargDate);

//var Today = aqDateTime.Today();
//var UnitAdmiDate = aqDateTime.AddTime(Today , -2, 0, 0, 0);
//var UnitDiscDeciDate = aqDateTime.AddTime(Today , -1, 0, 0, 0);
//var UnitDischargDate = aqDateTime.AddTime(Today , -1, 0, 0, 0);
////Log.Message(UnitAdmiDate);


var DocumStaus = Data.getData(TestName,"eHOC","DocumStaus");
// The values for the below variable needs to be updated based based the user who logged into MV
var Author = Data.getData(TestName,"eHOC","Author");

var userDepartment = Data.getData(TestName,"Navigation","Department");
var Res_Add_L1 = Data.getData(TestName,"Patient","Res_Add_L1");
var Res_Add_L2 = Data.getData(TestName,"Patient","Res_Add_L2");
var Res_Suburb = Data.getData(TestName,"Patient","Res_Suburb");
var Res_State = Data.getData(TestName,"Patient","Res_State");
var Res_Pcode = Data.getData(TestName,"Patient","Res_Pcode");
var Res_Country = Data.getData(TestName,"Patient","Res_Country");

var CurDate = aqDateTime.Today();
var EndDateValue = aqDateTime.AddTime(CurDate, 3, 0, 0, 0);

if (aqString.Compare(userDepartment, "CHH-ICU",false)== 0 ||aqString.Compare(userDepartment, "GBH-ICU",false)== 0 || aqString.Compare(userDepartment, "LBH-ICU",false)== 0 ||aqString.Compare(userDepartment, "PMB-ICU",false)== 0 ||aqString.Compare(userDepartment, "TTH-ICU",false)== 0)
{
exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,HospiName,exestatus);
exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,WardName,exestatus);

}else{
Log.Error("Entered facility not configured in MV");
exestatus = false;
}


// To validate the regular & PRN medication details 
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,DischargeStatus,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,MedicalDischargeSummary.UnitAdmiDate,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Res_Add_L1,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Res_Add_L2,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Res_Suburb,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Res_State,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Res_Pcode,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,DocumStaus,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,Author,exestatus);
 var isReleased = Data.getData(TestName,"eHOC","isReleased");
 if (aqString.Compare(isReleased,"Yes", false)==0){
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,MedicalDischargeSummary.UnitDiscDeciDate,exestatus);
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,MedicalDischargeSummary.UnitDischargDate,exestatus);
 }else{
 Log.Message("No Action required");
 }
 
 

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint(" Administrative details are validated successfully in eHOC report");
      Log.Checkpoint("End of validating administrative details in eHOC report ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of administrative details in eHOC report in eHOC report","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MveHOCNoDetails
// Desc :Feature to validate the null value detail in between the two spicified limits
// Owner :Satheeshkumar C
// Creation date: 08 Feb 2018
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MveHOCNoDetails(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"eHOC","TC_DESC");

Log.Checkpoint("To validate null value detail in between the two spicified limits in eHOC report ","The flow is started");

	
  //Start of the feature 
	 
 var pdf = Sys.Process("AcroRd32", 2);
 var FilePath =  Data.getData(TestName,"eHOC","FilePath"); 
 var Startlimit = Data.getData(TestName,"eHOC","Startlimit");
 var Endlimit = Data.getData(TestName,"eHOC","Endlimit");
 
 var NoMedication = Data.getData(TestName,"eHOC","NoMedication");

// To validate the regular & PRN medication details 
 exestatus = PDF_Function.findtext(FilePath,Startlimit,Endlimit,NoMedication,exestatus);
 
   if (equal(exestatus,true)) {
	 	  Log.Checkpoint("Null value detail in between the two specified limits in eHOC report validated successfully");
      Log.Checkpoint("End of validating Null value detail in between the two spicified limits in eHOC report ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped validation of Null value detail in between the two spicified limits in eHOC report","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//

//******************************************************************************************//
//******************************************************************************************//
// Name :MveSaveImages
// Desc :Feature to feature to save the images from PDF
// Owner :Jyoti Sonar
// Creation date: 09 Feb 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvSaveImages(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


var tcDesc = Data.getData(TestName,"eHOC","TC_DESC");

Log.Checkpoint("To save all the images in eHOC report ","The flow is started");

	
  //Start of the feature 
	 
 var pdf = Sys.Process("AcroRd32", 2);
 var FilePath =  Data.getData(TestName,"eHOC","FilePath"); 
 var ImageFolderPath = Data.getData(TestName,"eHOC","ImageFolderPath");
 var ImageFilePath1 = Data.getData(TestName,"eHOC","ImageFilePath1");
 var ImageFilePath2 = Data.getData(TestName,"eHOC","ImageFilePath2");
 var ImageFilePath3 = Data.getData(TestName,"eHOC","ImageFilePath3");
 var ImageFilePath4 = Data.getData(TestName,"eHOC","ImageFilePath4");
 
 

// To validate the regular & PRN medication details 
 exestatus = PDF_Function.getImage(FilePath,ImageFolderPath,ImageFilePath1,ImageFilePath2,ImageFilePath3,ImageFilePath4,exestatus);
 
 
 

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("All the images in the PDF file saved successfully");
      Log.Checkpoint("End of saving all the images in eHOC report ","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped saving all the images in eHOC report","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :ComparePDFAsImg
// Desc :This function is to compare the source and target images 
// Owner :Jyoti Sonar
// Creation date: 09 Feb 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function ComparePDFAsImg(TestName,exestatus)
{
  
  var pageindex = 0;
  
  //Picture object variables for eNMIC file downloaded during test run
  var ApictureObj1, ApictureObj2, ApictureObj3, MaskImg;
  
  //Picobjects for expected PDF eNMIC comparision
  var SourcepicObj1, SourcepicObj2, SourcepicObj3;
  
  //Doc objects for Source and Actual eNMIC PDF
  var SourcedocObj, ActualdocObj;
  
  //Variables to compare the total number of page
  var totalPages_1, totalPages_2;
  
  var SourcePDF = Data.getData(TestName,"eNMIC","SourceFileName");   //Expected result for PDF eNMIC file. The has to be downloaded and saved under the test folder.
  var ActualPDF = Data.getData(TestName,"eNMIC","ActualFileName");   //PDF eNMIC file from test run
  
  
  //Load the PDF in the document object
  SourcedocObj = PDF_Function.loadDocument(SourcePDF);
  ActualdocObj = PDF_Function.loadDocument(ActualPDF);
  
  //Compare if the expected eNMIC file and the actual eNMIC file both have the same number of pages.
  totalPages_1 = SourcedocObj.getNumberOfPages();
  totalPages_2 = ActualdocObj.getNumberOfPages();
  
  Log.Message("Source doc has "+totalPages_1+" pages. Actual doc has "+totalPages_2+" pages");
  
  if (totalPages_1 != totalPages_2)
  {
    Log.Message("The documents contain different number of pages.");
  } else
  {
    for (i = 0; i < totalPages_1-1; i++)
    {
      //Convert the Actual eNMIC PDF to images
      ApictureObj1 = PDF_Function.ConvertActualPdftoImage(TestName, i);
      
      //Convert the Expected eNMIC PDF to images
      SourcepicObj1 = PDF_Function.ConvertSourcePdftoImage(TestName, i);
      
            
      //If the pages beings compared are the first page in eNMIC PDF
      if(i == 0){
        
        var Sourcepic = SourcepicObj1.GetRect(209,525,337,619);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        var Actualpic = ApictureObj1.GetRect(209,525,337,619);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);
        
        //Validate that the regular meds sections match
        Sourcepic = SourcepicObj1.GetRect(1316,372,935,1245);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        Actualpic = ApictureObj1.GetRect(1316,372,935,1245);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);
        
        //Compare allergy section
        if(TestName == "CMP20_TC012")
        {
          Sourcepic = SourcepicObj1.GetRect(102,34,445,241);
          Log.Picture(Sourcepic, "Allergy Region captured from Source Image");
      
          Actualpic = ApictureObj1.GetRect(102,34,445,241);
          Log.Picture(Actualpic, "Allergy Region captured from Actual Image");
        
          //Compare images.
          PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);
        }
      
      }
      
      //If the page being comapared are the second page in eNMIC PDF
      if(i == 1){
        
      //Validate that the VTE meds and the warfarin sections match
        var Sourcepic = SourcepicObj1.GetRect(205,477,807,1105);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        var Actualpic = ApictureObj1.GetRect(205,477,807,1105);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);
        
        //Validate that the regular meds sections match
        Sourcepic = SourcepicObj1.GetRect(1379,471,825,1109);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        Actualpic = ApictureObj1.GetRect(1379,471,825,1109);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);
     }
        
    }
    
  }
 
}

//******************************************************************************************//
//******************************************************************************************//
// Name :CompareLastPDFAsImg
// Desc :This function is to compare the source and target images of the last page
// Owner :Jyoti Sonar
// Creation date: 09 Feb 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function CompareLastPDFAsImg(TestName,exestatus)
{
  
  var pageindex = 0;
  
  //Picture object variables for eNMIC file downloaded during test run
  var ApictureObj1, ApictureObj2, ApictureObj3, MaskImg;
  
  //Picobjects for expected PDF eNMIC comparision
  var SourcepicObj1, SourcepicObj2, SourcepicObj3;
  
  //Doc objects for Source and Actual eNMIC PDF
  var SourcedocObj, ActualdocObj;
  
  //Variables to compare the total number of page
  var totalPages_1, totalPages_2;
  
  var SourcePDF = Data.getData(TestName,"eNMIC","SourceFileName");   //Expected result for PDF eNMIC file. The has to be downloaded and saved under the test folder.
  var ActualPDF = Data.getData(TestName,"eNMIC","ActualFileName");   //PDF eNMIC file from test run
  
  
  //Load the PDF in the document object
  SourcedocObj = PDF_Function.loadDocument(SourcePDF);
  ActualdocObj = PDF_Function.loadDocument(ActualPDF);
  
  //Compare if the expected eNMIC file and the actual eNMIC file both have the same number of pages.
  totalPages_1 = SourcedocObj.getNumberOfPages();
  totalPages_2 = ActualdocObj.getNumberOfPages();
  
  Log.Message("Source doc has "+totalPages_1+" pages. Actual doc has "+totalPages_2+" pages");
  
  if (totalPages_1 != totalPages_2)
  {
    Log.Message("The documents contain different number of pages.");
  } else
  {
    for (i = 0; i < totalPages_1; i++)
    {
      //Convert the Actual eNMIC PDF to images
      ApictureObj1 = PDF_Function.ConvertActualPdftoImage(TestName, i);
      
      //Convert the Expected eNMIC PDF to images
      SourcepicObj1 = PDF_Function.ConvertSourcePdftoImage(TestName, i);
      
            
      //If the pages beings compared are the first page in eNMIC PDF
      if(i == totalPages_2-1){
        
        var Sourcepic = SourcepicObj1.GetRect(148,500,850,71);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        var Actualpic = ApictureObj1.GetRect(148,500,850,71);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);      
      }  
    }
    
  }
 
}

//******************************************************************************************//
//******************************************************************************************//
// Name :CompareRoutePRN
// Desc :This function is to compare the source and target images for route for PRN meds
// Owner :Jyoti Sonar
// Creation date: 28 Feb 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function CompareRoutePRN(TestName,exestatus)
{
  
  var pageindex = 0;
  
  //Picture object variables for eNMIC file downloaded during test run
  var ApictureObj1, ApictureObj2, ApictureObj3, MaskImg;
  
  //Picobjects for expected PDF eNMIC comparision
  var SourcepicObj1, SourcepicObj2, SourcepicObj3;
  
  //Doc objects for Source and Actual eNMIC PDF
  var SourcedocObj, ActualdocObj;
  
  //Variables to compare the total number of page
  var totalPages_1, totalPages_2;
  
  var SourcePDF = Data.getData(TestName,"eNMIC","SourceFileName");   //Expected result for PDF eNMIC file. The has to be downloaded and saved under the test folder.
  var ActualPDF = Data.getData(TestName,"eNMIC","ActualFileName");   //PDF eNMIC file from test run
  
  
  //Load the PDF in the document object
  SourcedocObj = PDF_Function.loadDocument(SourcePDF);
  ActualdocObj = PDF_Function.loadDocument(ActualPDF);
  
  //Compare if the expected eNMIC file and the actual eNMIC file both have the same number of pages.
  totalPages_1 = SourcedocObj.getNumberOfPages();
  totalPages_2 = ActualdocObj.getNumberOfPages();
  
  Log.Message("Source doc has "+totalPages_1+" pages. Actual doc has "+totalPages_2+" pages");
  
  if (totalPages_1 != totalPages_2)
  {
    Log.Message("The documents contain different number of pages.");
  } else
  {
    for (i = 0; i < totalPages_1; i++)
    {
      //Convert the Actual eNMIC PDF to images
      ApictureObj1 = PDF_Function.ConvertActualPdftoImage(TestName, i);
      
      //Convert the Expected eNMIC PDF to images
      SourcepicObj1 = PDF_Function.ConvertSourcePdftoImage(TestName, i);
      
            
      //If the pages beings compared are the first page in eNMIC PDF
      if(i == 0){
        
        var Sourcepic = SourcepicObj1.GetRect(1243,441,57,64);
        Log.Picture(Sourcepic, "Region captured from Source Image");
      
        var Actualpic = ApictureObj1.GetRect(1243,441,57,64);
        Log.Picture(Actualpic, "Region captured from Actual Image");
        
        //Compare images.
        PDF_Function.compareimg(Actualpic, Sourcepic, ApictureObj1, SourcepicObj1, i);      
      }  
    }
    
  }
 
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPrescribePRNmeds
// Desc :This function prescribes PRN meds at regular intervals 
// Owner :Jyoti Sonar
// Creation date: 25 Feb 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//

function MvPrescribePRNmeds(TestName, exestatus)
{
  
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {

//var objData = Data.getData(TestName,"MedicalCare");
var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
Log.Checkpoint("Start of Review Medication Timeline "+tcDesc ,"The flow is started");
	
  
  //Start of the feature 
	 vProcess = Sys.Process("iMDSoft.Metavision");

	      

    //** Fill in the details for prescribe medication tab**
//    
Log.Message("*** Enter details for Prescribe medication");
var drug = Data.getData(TestName,"Medications","drug");
var template=Data.getData(TestName,"Medications","template");
var medicaltype=Data.getData(TestName,"Medications","medicaltype");
var quantity = Data.getData(TestName,"Medications","drug_quantity");
var PRNText = Data.getData(TestName,"Medications","PRNText");
var SetInterval = Data.getData(TestName,"Medications","SetInterval");
var Password = Data.getData(TestName,"Navigation","Password");   

Log.Message("*** Enter details for PRN Medication");
//Prescribe Medication- To order PRN medication 
exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"TabItem\"),\"\"\,11",exestatus);

//Click on Prescribe 
exestatus = mvObjects.buttonClick(vProcess,"FullName", "*WPFObject(\"CustomWrapPanel\", \"\", 1).WPFObject(\"ImdButton\", \"\",1)",exestatus);

aqUtils.Delay(10000);

//Entering values in orderable window 
exestatus = mvObjects.SearchSelectItem(vProcess, "WPFObject(\"FindComboBoxEdit\")",5,2,drug,2,exestatus);
exestatus = mvObjects.selectToggleItem(vProcess,"Text",template,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"FullName","*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"PRNToggleButton\")",exestatus);
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row1\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"TextEdit\", \"\", 1)",PRNText,exestatus);
exestatus = mvObjects.wildcardfullname(vProcess, "*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 1).WPFObject(\"ComboBoxEdit\", \"\", 1).WPFObject(\"ButtonContainer\", \"\", 1).WPFObject(\"PART_Item\")","ComboBoxEditItem",medicaltype,exestatus)
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"Frequency_Row2\").WPFObject(\"LayoutItem\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"Grid\", \"\", 1).WPFObject(\"SpinEdit\", \"\", 1)",SetInterval,exestatus);


// Enter medication quantity
exestatus = mvObjects.Fullnametext(vProcess,"*WPFObject(\"LayoutGroup\", \"\", 2).WPFObject(\"ContentControl\", \"\", 1).WPFObject(\"GridMedications\").WPFObject(\"DVGridMedications\").WPFObject(\"view\").WPFObject(\"HierarchyPanel\", \"\", 1).WPFObject(\"GridRow\", \"\", 1).WPFObject(\"BandedViewContentSelector\", \"\", 1).WPFObject(\"GridCellContentPresenter\", \"\", 4).WPFObject(\"TextEdit\", \"\", 1)",quantity,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\", \"Save & Close\",1)",exestatus);

//Click on Signow
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdSign\")",exestatus);

//Click on Signnow in Signature Review

exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"cmdSignNow\")",exestatus);
exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"PasswordBoxEdit\ ,\"\"\,1)", Password,exestatus);
exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"Button\" , \"OK\",1)",exestatus); 

  if (equal(exestatus,true)) {
	 	  Log.Checkpoint("MvPrescribePRNmeds is successful");
      Log.Checkpoint("End MvPrescribePRNmeds","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped MvPrescribePRNmeds","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPatientRegisterQuick
// Desc :This function registers new patients  
// Owner :Mohammad Zeeshan
// Creation date: 11 March 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//


function MvPatientRegisterQuick(TestName,PatientNumber,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) {


  var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
  Log.Checkpoint("Start Patient Quick Registeration","The flow has started");
	
  //Start of the feature 
  var newPatientMRN = Data.getData(TestName,"Jira","Patient") + PatientNumber;
	var visitID = Data.getData(TestName,"Jira","VisitID") + PatientNumber;
  var firstName = Data.getData(TestName,"Jira","FirstName") + PatientNumber;
  var lastName = Data.getData(TestName,"Jira","LastName") + PatientNumber;
  	
	//Get the Meta vision process Id for automation
	vProcess = Sys.Process("iMDSoft.Metavision");
		
	// Add Patient and demographics
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Emergency Patient Registration");
	
	
	// Patient MRN	
	Log.Message("New Patient MRN = " + newPatientMRN);
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtMRNumber\")", newPatientMRN,exestatus);
  
	// Visit ID WinFormsObject("cboSocialSecurity")
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"cboSocialSecurity\")", visitID,exestatus);
  
	// first name WinFormsObject("txtFirstName")

	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtFirstName\")", firstName,exestatus);
  
	// last name WinFormsObject("txtLastName")
	exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"txtLastName\")", lastName,exestatus);
  
	// Enter the Status - commented the code to made it as pre-admitted.
	//exestatus = mvObjects.ImdListBoxSelection("WinFormsObject(\"cboStatuses\")", "Admitted",exestatus);
	//aqUtils.Delay(500);
  
	// To proceed with normal registration
  var statusValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpStatusFromTime\")", 1000);
	var fromValueObject = vProcess.Find("Name", "WinFormsObject(\"dtpLocationFromTime\")", 1000);
  
  
  // Apply
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdApply\")",exestatus);
  
  // To proceed with pop up
  var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
	// Save Patient
	exestatus  = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"cmdOK\")",exestatus);
	
	// Wait for screen to appear
	exestatus = mvObjects.waitForObjectNotVisible(vProcess, "WinFormsObject(\"FormCaption\")", 120,exestatus);
	//aqUtils.Delay(10000);
	
	exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Patient File");
	exestatus = mvObjects.waitForObject(vProcess, "WinFormsObject(\"FormCaption\")", 30,exestatus);
	patientListFormObject = vProcess.Find("Name", "WinFormsObject(\"frmPatientRegistration\")");
  
	screenMRNObject = vProcess.Find("Name", "WinFormsObject(\"txtMRNumber\")", 100); 
	// Find Patient Number
	screenMRNValue =  aqObject.GetPropertyValue(screenMRNObject, "Text");
	if (aqString.Compare(screenMRNValue, newPatientMRN, false) == 0) {
		Log.Checkpoint("Found expected value "+ newPatientMRN);
	} else {
		Log.Error("Expected value, "+ newPatientMRN +", not found. Found: "+ screenMRNValue);
		exestatus = false;
	}
  
	// Find First Name
	screenFirstNameObject = vProcess.Find("Name", "WinFormsObject(\"txtFirstName\")", 100);
	screenFirstNameValue =  aqObject.GetPropertyValue(screenFirstNameObject, "Text");
	if (aqString.Compare(screenFirstNameValue, firstName, false) == 0) {
		Log.Checkpoint("Found expected value "+ firstName);
	} else {
		Log.Error("Expected value, "+ firstName +", not found. Found: "+ screenFirstNameObject);
		exestatus = false;
	}
    
	// Find Last Name
	screenLastNameObject = vProcess.Find("Name", "WinFormsObject(\"txtLastName\")", 100);
	screenLastNameValue =  aqObject.GetPropertyValue(screenLastNameObject, "Text");
	if (aqString.Compare(screenLastNameValue, lastName, false) == 0) {
    Log.Picture(Sys.Desktop.Picture());
		Log.Checkpoint("Found expected value "+ lastName);
	} else {
		Log.Error("Expected value, "+ lastName +", not found. Found: "+ screenLastNameObject);
		exestatus = false;
	}
  
  exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"CmdCancel\")",exestatus);  
  if (equal(exestatus,true)) {
     
	 	  Log.Checkpoint("Patient Registeration is successful for '"+newPatientMRN+"'.");
      Log.Checkpoint("End Patient Registeration","The flow is completed");
      SetHeartRate("50");
    }
  }
  else {
  Log.Message("Skipped Patient Registeration","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvPressureRiskAssessment
// Desc :This function records the pressure risk assessment for a patient  
// Owner :Mohammad Zeeshan
// Creation date: 13 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvPressureRiskAssessment(TestName,exestatus)
{
 
//Controller for executing or skipping the feature
if (equal(exestatus,true)) 
{
  var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
  Log.Checkpoint("Start Patient pressure risk assessment scoring","The flow has started");
	
  //Start of the feature 
  var sensoryPerception = Data.getData(TestName,"Othercare","SensoryPerception");
	var moisture = Data.getData(TestName,"Othercare","Moisture");
  var activity = Data.getData(TestName,"Othercare","Activity");
  var mobility = Data.getData(TestName,"Othercare","Mobility");
  var nutrition = Data.getData(TestName,"Othercare","Nutrition");
  var frictionAndSheer = Data.getData(TestName,"Othercare","FrictionAndSheer");
  var totalScore = Data.getData(TestName,"Othercare","TotalScore");
  	
	//Get the Meta vision process Id for automation
	vProcess = Sys.Process("iMDSoft.Metavision");
		
  //Launch the Pressure risk assessment form
	exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Pressure Injury Risk Assessment");
  
  // Fill in the details to Pressure Injury Risk Assessment
  Log.Message("*** enter details for Pressure Injury Risk Assessment for patient ***");
		
	var pressureRiskAssmntFormVisible = vProcess.Find("Name", "WPFObject(\"TextBlock\", \"*Pressure Injury Risk Assessment*\", 1)", 1000);
  
  //Form is loaded now enter the data and save it
  if(pressureRiskAssmntFormVisible.exists)
  {
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",sensoryPerception,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",moisture,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_3\")",activity,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_4\")",mobility,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_5\")",nutrition,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_6\")",frictionAndSheer,exestatus);
    
    //Verify the total score which is loaded
    var scorePRA = vProcess.Find("Name", "WPFObject(\"txtFormula_1\")", 1000);
    
    if(scorePRA.exists)
    {
      scorePRAValue =  aqObject.GetPropertyValue(scorePRA, "Text");
    	if (aqString.Compare(scorePRAValue, totalScore, false) == 0) 
      {
    		Log.Checkpoint("Found expected value "+ totalScore);
    	} 
      else 
      {
    		Log.Error("Expected value, "+ totalScore +", not found. Found: "+ scorePRAValue);
    		exestatus = false;
    	}
    }
  }
  
  //Save and close the Pressure risk assessment form
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  
  //Wait for sometime before reopening the form to verify
  aqUtils.Delay ("1000", "Wait before reopening Pressure risk assessment form");
  
  //Again open the form to verify the data entered is saved
  //Launch the Pressure risk assessment form
	exestatus = mvObjects.selectMenuOption(exestatus,"Scores", "Pressure Injury Risk Assessment");
  
  Log.Message("*** verify details for Pressure Injury Risk Assessment for patient ***");
		
	var pressureRiskAssmntFormVisible = vProcess.Find("Name", "WPFObject(\"TextBlock\", \"*Pressure Injury Risk Assessment*\", 1)", 1000);
  
  //Form is loaded now verify the data and close the form
  if(pressureRiskAssmntFormVisible.exists)
  {
    //Goto the last session of the saved assessment
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
    //verify sensory perception
    var senPercp = vProcess.Find("Name", "WPFObject(\"cboTextCombo_1\")", 1000);
    senPercpValue =  aqObject.GetPropertyValue(senPercp, "Text");
  	if (aqString.Compare(senPercpValue, sensoryPerception, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ sensoryPerception);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ sensoryPerception +", not found. Found: "+ senPercpValue);
  		exestatus = false;
  	}
    
    //verify moisture
    var moistureField = vProcess.Find("Name", "WPFObject(\"cboTextCombo_2\")", 1000);
    moistureValue =  aqObject.GetPropertyValue(moistureField, "Text");
  	if (aqString.Compare(moistureValue, moisture, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ moisture);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ moisture +", not found. Found: "+ moistureValue);
  		exestatus = false;
  	}
    
    //verify activity
    var activityField = vProcess.Find("Name", "WPFObject(\"cboTextCombo_3\")", 1000);
    activityValue =  aqObject.GetPropertyValue(activityField, "Text");
  	if (aqString.Compare(activityValue, activity, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ activity);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ activity +", not found. Found: "+ activityValue);
  		exestatus = false;
  	}
    
    //verify mobility
    var mobilityField = vProcess.Find("Name", "WPFObject(\"cboTextCombo_4\")", 1000);
    mobilityValue =  aqObject.GetPropertyValue(mobilityField, "Text");
  	if (aqString.Compare(mobilityValue, mobility, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ mobility);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ mobility +", not found. Found: "+ mobilityValue);
  		exestatus = false;
  	}
    
    //verify nutrition
    var nutritionField = vProcess.Find("Name", "WPFObject(\"cboTextCombo_5\")", 1000);
    nutritionValue =  aqObject.GetPropertyValue(nutritionField, "Text");
  	if (aqString.Compare(nutritionValue, nutrition, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ nutrition);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ nutrition +", not found. Found: "+ nutritionValue);
  		exestatus = false;
  	}
    
    //verify frictionAndSheer
    var frictionAndSheerField = vProcess.Find("Name", "WPFObject(\"cboTextCombo_6\")", 1000);
    frictionAndSheerValue =  aqObject.GetPropertyValue(frictionAndSheerField, "Text");
  	if (aqString.Compare(frictionAndSheerValue, frictionAndSheer, false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ frictionAndSheer);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ frictionAndSheer +", not found. Found: "+ frictionAndSheerValue);
  		exestatus = false;
  	}
    
    //verify PRA score
    var scorePRA = vProcess.Find("Name", "WPFObject(\"txtFormula_1\")", 1000);
    
    if(scorePRA.exists)
    {
      scorePRAValue =  aqObject.GetPropertyValue(scorePRA, "Text");
    	if (aqString.Compare(scorePRAValue, totalScore, false) == 0) 
      {
    		Log.Checkpoint("Found expected value: "+ totalScore);
    	} 
      else 
      {
    		Log.Error("Expected value: "+ totalScore +", not found. Found: "+ scorePRAValue);
    		exestatus = false;
    	}
    }
  }
  
  //Wait for sometime before clsoing the form
  aqUtils.Delay ("1000", "Wait before closing Pressure risk assessment form");
  
  //close the form
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ucFormBuilder_FBForm\")",exestatus);
  exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
  //Wait for sometime 
  aqUtils.Delay ("500", "Wait before exiting Pressure risk assessment function");
   
  if (equal(exestatus,true)) 
  {
     
	 	  Log.Checkpoint("Patient Pressure risk assessment is successful");
  }
  else 
  {
    Log.Message("Pressure risk assessment failed","the execution status is set as '"+exestatus+"'");   
  }
  return exestatus;
  
  }
    
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvVerifyAdmissionDischargeTime
// Desc :This function verifies the admission discharge time form  
// Owner :Mohammad Zeeshan
// Creation date: 17 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvVerifyAdmissionDischargeTime(TestName,exestatus)
{ 
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
      
    var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
    Log.Checkpoint("Start Admission Discharge Time Form","The flow has started");
	
    //Get the Meta vision process Id for automation
  	vProcess = Sys.Process("iMDSoft.Metavision");
  
    // Open Patient Admission/Discharge Times
  	exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Admission/Discharge Times");
  	// Wait for screen to appear
  	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"*Admission/Discharge Times*\", 1)", 1000,exestatus);
  
    //Get the data of the patient from the excel sheet
  
    let AdmissionDischargeTime = new Object();
  
    //Medically cleared for ICU discharge
    AdmissionDischargeTime.MedClearedForICUDschrge = Data.getData(TestName,"OtherCare","MedClearedForICUDschrge");
    MedClearedDay = aqDateTime.GetDay(AdmissionDischargeTime.MedClearedForICUDschrge);
  	MedClearedMonth = aqDateTime.GetMonth(AdmissionDischargeTime.MedClearedForICUDschrge);
  	MedClearedYear= aqDateTime.GetYear(AdmissionDischargeTime.MedClearedForICUDschrge);
  
    exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_1\")", MedClearedDay,MedClearedMonth,MedClearedYear,"18","30",exestatus);
    
    //Store this value for further validation
    var medicallyClearedIcuDisToVerify = vProcess.Find("Name", "WPFObject(\"dtpDate_1\")", 1000);
    medicallyClearedIcuDisToVerifyValue =  aqObject.GetPropertyValue(medicallyClearedIcuDisToVerify, "Text");
    Log.Checkpoint("medicallyClearedIcuDisToVerifyValue value: "+ medicallyClearedIcuDisToVerifyValue);
  
    //Unit Discharge Date/Time
    AdmissionDischargeTime.UDisDatTime = Data.getData(TestName,"OtherCare","UDisDatTime");
    UDisDatTimeDay = aqDateTime.GetDay(AdmissionDischargeTime.UDisDatTime);
  	UDisDatTimeMonth = aqDateTime.GetMonth(AdmissionDischargeTime.UDisDatTime);
  	UDisDatTimeYear= aqDateTime.GetYear(AdmissionDischargeTime.UDisDatTime);
  
    exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_2\")", UDisDatTimeDay,UDisDatTimeMonth,UDisDatTimeYear,"19","00",exestatus);
    
    //Store this value for further validation
    var unitDisDatTimeVerify = vProcess.Find("Name", "WPFObject(\"dtpDate_2\")", 1000);
    unitDisDatTimeVerifyValue =  aqObject.GetPropertyValue(unitDisDatTimeVerify, "Text");
    Log.Checkpoint("unitDisDatTimeVerifyValue value: "+ unitDisDatTimeVerifyValue);  
  
    //Discharge against medical advice
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"chkFalse_1\")",exestatus);
      
    //Death Date/Time
    AdmissionDischargeTime.DeathDate = Data.getData(TestName,"Patient","DeathDate");
    DeathDateDay = aqDateTime.GetDay(AdmissionDischargeTime.UDisDatTime);
  	DeathDateMonth = aqDateTime.GetMonth(AdmissionDischargeTime.UDisDatTime);
  	DeathDateYear= aqDateTime.GetYear(AdmissionDischargeTime.UDisDatTime);
  
    exestatus =  mvObjects.enterImdDateTimePicker(vProcess, "WPFObject(\"dtpDate_3\")", DeathDateDay,DeathDateMonth,DeathDateYear,"18","45",exestatus);
    
    //Store this value for further validation
    var deathDateToVerify = vProcess.Find("Name", "WPFObject(\"dtpDate_3\")", 1000);
    deathDateToVerifyValue =  aqObject.GetPropertyValue(deathDateToVerify, "Text");
    Log.Checkpoint("unitDisDatTimeVerifyValue value: "+ deathDateToVerifyValue);
  
    //Organ and tissue donation  
    var Organ = Data.getData(TestName,"OtherCare1","Organ");
  	exestatus = mvObjects.selectComboItem(vProcess, "WPFObject(\"cboTextCombo_1\")",Organ,exestatus);
 
    //Save and close the Admission Discharge Time form
    exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
  
    //Wait for sometime before reopening the form to verify
    aqUtils.Delay ("1000", "Wait before reopening Admission Discharge Time form");
  
    //Again open the form to verify the data entered is saved
    //Launch the Admission Discharge Time form
    exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Admission/Discharge Times");
  	// Wait for screen to appear
  	exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"TextBlock\", \"*Admission/Discharge Times*\", 1)", 1000,exestatus);
  
    Log.Message("*** verify details for Admission Discharge Time for patient ***");
		
  	var admissionDischargeFormVisible = vProcess.Find("Name", "WPFObject(\"TextBlock\", \"*Admission/Discharge Times*\", 1)", 1000);
  
    //Form is loaded now verify the data and close the form
    if(admissionDischargeFormVisible.exists)
    {
      //Goto the last session of the saved assessment
      exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"cmdCancelNewSessionText\")",exestatus);
      exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
  
      //verify medically cleared for ICU discharge
      var medicallyClearedIcuDis = vProcess.Find("Name", "WPFObject(\"dtpDate_1\")", 1000);
      medicallyClearedIcuDisValue =  aqObject.GetPropertyValue(medicallyClearedIcuDis, "Text");
    	if (aqString.Compare(medicallyClearedIcuDisValue, medicallyClearedIcuDisToVerifyValue, false) == 0) 
      {
    		Log.Checkpoint("Found expected value: "+ medicallyClearedIcuDisValue);
    	} 
      else 
      {
    		Log.Error("Expected value: "+ medicallyClearedIcuDisToVerifyValue +", not found. Found: "+ medicallyClearedIcuDisValue);
    		exestatus = false;
    	} 
      
      //verify unit discharge date and time
      var unitDischargeDateTime = vProcess.Find("Name", "WPFObject(\"dtpDate_2\")", 1000);
      unitDischargeDateTimeValue =  aqObject.GetPropertyValue(unitDischargeDateTime, "Text");
    	if (aqString.Compare(unitDischargeDateTimeValue, unitDisDatTimeVerifyValue, false) == 0) 
      {
    		Log.Checkpoint("Found expected value: "+ unitDischargeDateTimeValue);
    	} 
      else 
      {
    		Log.Error("Expected value: "+ unitDisDatTimeVerifyValue +", not found. Found: "+ unitDischargeDateTimeValue);
    		exestatus = false;
    	}
      
      //verify death date and time
      var deathDateTime = vProcess.Find("Name", "WPFObject(\"dtpDate_3\")", 1000);
      deathDateTimeValue =  aqObject.GetPropertyValue(deathDateTime, "Text");
    	if (aqString.Compare(deathDateTimeValue, deathDateToVerifyValue, false) == 0) 
      {
    		Log.Checkpoint("Found expected value: "+ deathDateTimeValue);
    	} 
      else 
      {
    		Log.Error("Expected value: "+ deathDateToVerifyValue +", not found. Found: "+ deathDateTimeValue);
    		exestatus = false;
    	}  
  
      //Wait for sometime before clsoing the form
      aqUtils.Delay ("1000", "Wait before closing Admission Discharge Time form");
  
      //close the form
      exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"ucFormBuilder_FBForm\")",exestatus);
      exestatus  = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdCancel\")",exestatus);
  
      //Wait for sometime 
      aqUtils.Delay ("500", "Wait before exiting Pressure risk assessment function");
   
      if (equal(exestatus,true)) 
      {     
    	 	  Log.Checkpoint("Patient Admission Discharge Time is successfully verified");
      }
      else 
      {
        Log.Message("Patient Admission Discharge Time verification failed","the execution status is set as '"+exestatus+"'"); 
        return exestatus;  
      } 
    }
  }  
  return exestatus;
}

//Function to enter values for a patient
function MvPopulatePatientData(TestName,PatientNumber,exestatus)
{
  
  //Start of the feature 
  var newPatientMRN = Data.getData(TestName,"Jira","Patient") + PatientNumber;
	var visitID = Data.getData(TestName,"Jira","VisitID") + PatientNumber;
  var firstName = Data.getData(TestName,"Jira","FirstName") + PatientNumber;
  var lastName = Data.getData(TestName,"Jira","LastName") + PatientNumber;
  
  if (equal(exestatus,true))
  {
    //Get the Meta vision process Id for automation
  	vProcess = Sys.Process("iMDSoft.Metavision");
  
    //Open the worklist
    exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
    
    //Search a patient to update the details
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"SearchControl\", \"\", 1)",newPatientMRN,exestatus);
    
    //Update the details of the patients 
    //Find the First child of the patients Grid and then enter data
    var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000);
    patientsGrid.Keys("[Home]");
    //rows in the grid = number of patients
    var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
    Log.Message(RowCount);
    
    var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\",1)", 1000);
    patGridRow.Click();
    
    var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000)
    
    var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);
    
    for(i=0;i<RowCount;i++)
    {
      patGridRow.Keys("[Up]");
    }
    
    if(admittedPatientList.exists)
    {
      admittedPatientList.Click();
      admittedPatientList.DblClick();
    }       
    
    //Allocated staff
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\")",newPatientMRN,exestatus);
    //Save the Allocated staff
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);  
      
    //Alerts and save it
    var alerts = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 3)", 1000);     
    if(alerts.exists)
    {
      alerts.Click();
      alerts.DblClick();
    }    
    //select value in Alerts option
    var alertType = vProcess.Find("Name", "WinFormsObject(\"lstValues\")", 1000);
    if(alertType.exists)
    {
      alertType.Click();
      alertType.Click();
    }       
    //and then save it.
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);
    
    //Enter Past medical history and save it
    var pmhx = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 7)", 1000);            
    if(pmhx.exists)
    {
      pmhx.Click();
      pmhx.DblClick();
    }
    //Enter details    
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\")",newPatientMRN,exestatus);
    //and then save it.
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);
    
    //Nursing management plan
    var nmp = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 9)", 1000);            
    if(nmp.exists)
    {
      nmp.Click();
      nmp.DblClick();
    }
    //Enter details    
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\")",newPatientMRN,exestatus);
    //and then save it.
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);
    
        
    //enter social history and save it
    var shistory = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 12)", 1000);            
    if(shistory.exists)
    {
      shistory.Click();
      shistory.DblClick();
    }
    //Enter details    
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\")",newPatientMRN,exestatus);
    //and then save it.
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);
    
    //Discharge status and save it
    var dischargeStatus = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 13)", 1000);            
    if(dischargeStatus.exists)
    {
      dischargeStatus.Click();
      dischargeStatus.DblClick();
    }
    //Enter details    
    exestatus = mvObjects.enterEditText(vProcess, "WinFormsObject(\"TextBox\", \"\")",newPatientMRN,exestatus);
    //and then save it.
    exestatus = mvObjects.buttonClick(vProcess,"Name","WinFormsObject(\"CmdSave\")",exestatus);
    
    //Close the list to search again for the other patient
    // check if on Worklist screen. If so, close Worklist 
    control = vProcess.Find("Name", "WPFObject(\"view\")", 1000);
    if (control.Exists) 
    {
  	  control = vProcess.Find("ToolTip", "Close", 1000);
  	  control.click();      
      Log.Picture(Sys.Desktop.Picture());
	  }
    
  }  
  return exestatus;  
}

function MvReleasePatientAtWorkList(TestName,PatientNumber,exestatus)
{
  //Start of the feature 
  var newPatientMRN = Data.getData(TestName,"Jira","Patient") + PatientNumber;
  
  if (equal(exestatus,true))
  {
    //Get the Meta vision process Id for automation
  	vProcess = Sys.Process("iMDSoft.Metavision");
  
    //Open the worklist
    exestatus = mvObjects.selectMenuOption(exestatus,"Menu", "Select a Patient");
    
    //Find the First child of the patients Grid and then enter data
    var patientsGrid = vProcess.Find("Name", "WPFObject(\"patientsGrid\")", 1000);
    patientsGrid.Keys("[Home]");
    //rows in the grid = number of patients
    var RowCount = aqObject.GetPropertyValue(patientsGrid, "wRowCount");
    Log.Message(RowCount);
    
    var patGridRow = patientsGrid.FindChild("Name", "WPFObject(\"GridRow\", \"\",1)", 1000);
    patGridRow.Click();
    
    var PatientListObject = patGridRow.FindChild("Name", "WPFObject(\"BandedViewContentSelector\", \"\", 1)", 1000)
    
    var admittedPatientList = PatientListObject.FindChild("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);

    
    //Search a patient to update the details
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"SearchControl\", \"\", 1)",newPatientMRN,exestatus);
    
    //Allocated staff
    control = vProcess.Find("Name", "WPFObject(\"GridCellContentPresenter\", \"\", 2)", 1000);
    if(control.Exists)
    {
      control.ClickR();
    }
    
  }
  
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOperationalReports
// Desc :This function launches operational reports  
// Owner :Mohammad Zeeshan
// Creation date: 20 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvLaunchOperationalReports(TestName, browser, exestatus)
{ 
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
      
    var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
    Log.Checkpoint("Start Summary regression 1 ","The flow has started");
    
    //Close any internet explorer browser which is open for OR
    if (Sys.WaitBrowser("iexplore").Exists)
    {
      Log.Message("Internet Explorer is running.")
    }
    
    while (Sys.WaitBrowser("iexplore").Exists)
    {
      // if (Sys.WaitBrowser().Exists)
      Sys.WaitBrowser().Close();
    }
	
    //Get the Meta vision process Id for automation
  	vProcess = Sys.Process("iMDSoft.Metavision");
  
    // Open Patient Admission/Discharge Times
  	exestatus = mvObjects.selectMenuOption(exestatus,"Help & Reports", "Operational Reports");
    
  	// Wait for operational reports browser to appear
    var browser = Sys.Process("iexplore"); 
    
    //Verify that the operational reports page is loaded
    var page = browser.WaitPage("*", 20000);
    if (aqString.Compare(page.contentDocument.title, "Operational Report - Report Viewer", false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ page.contentDocument.title);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ "Operational Report - Report Viewer" +", not found. Found: "+ page.contentDocument.title);
  		exestatus = false;
  	}   
  	exestatus = mvObjects.waitForObject(browser, "TabButton(\"Operational Report - Report Viewer\")", 1000,exestatus);
  }
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvOperationalReports
// Desc :This function launches operational reports  
// Owner :Mohammad Zeeshan
// Creation date: 20 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvBrowserLogout(TestName, browser, exestatus)
{ 
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
      
    var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
    Log.Checkpoint("Closing the internet explorer","The flow has started");
    
    var browser = Sys.Process("iexplore");
    
    //CLose the browser
    browser.Close();
    
  }
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvLaunchInitialOpReports
// Desc :This function launches Operational reports and stores the initial values.  
// Owner :Mohammad Zeeshan
// Creation date: 19/06/2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvLaunchInitialOpReports(TestName, browser, exestatus)
{
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    // Wait for operational reports browser to appear
    var browser = Sys.Process("iexplore"); 
    
    //Verify that the operational reports page is loaded
    var page = browser.WaitPage("*", 20000);
    
    if (aqString.Compare(page.contentDocument.title, "Operational Report - Report Viewer", false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ page.contentDocument.title);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ "Operational Report - Report Viewer" +", not found. Found: "+ page.contentDocument.title);
  		exestatus = false;
  	}   
  	exestatus = mvObjects.waitForObject(browser, "TabButton(\"Operational Report - Report Viewer\")", 1000,exestatus);  
    
    //Now click on the summary and select the last 1 week duration
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl03_ddDropDownButton",exestatus);
    
    //Mechanical Ventilated Hours
    if (aqString.Compare(TestName, "OR_MechanicalVentillationHours", false) == 0) 
    {
        //Scroll into view
        var mechVentHours = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl11", 500);
        if(mechVentHours != null)
        {
            mechVentHours.scrollIntoView();
            mechVentHours.click();
            Log.Message("mechVentHours clicked!!");
        }
    }
    
    //Now again click on the summary and select the last 1 day duration
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl03_ddDropDownButton",exestatus);

    // Find an object that corresponds to the specified criteria
    //exestatus = webObjects.selectDropDownItem(page, props, values, 2, exestatus);
    
    //Select the date range from last 1 day
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl07_ddDropDownButton", exestatus);   
      
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth() + 1;
    var yyyy = today.getFullYear();
    var yesterdaymm = 0;
    monthChangedFlag = false;
            
    if(dd<10) 
    {
        dd = '0'+dd;
    }
    if(mm<10) 
    {
        mm = '0'+mm;
    }    
    today = yyyy + mm + dd;
    var todayToInsert = dd + '/' + mm + '/' + yyyy;
    
    //Calculate yesterday based on month
    if((mm == 2 || mm == 4 || mm == 6 || mm == 9 || mm == 11) && dd == 1)
    {
      yesterdaydd = 31;
      yesterdaymm = mm - 1;
      monthChangedFlag = true;  
    }
    else if((mm == 1 || mm == 3 || mm == 5 || mm == 7 || mm == 8 || mm == 10 || mm == 12) && dd == 1)
    {
      yesterdaydd = 30;
      yesterdaymm = mm - 1; 
      monthChangedFlag = true;       
    }
    else
    {
      yesterdaydd = dd - 1;    
      yesterdaymm = mm;
      monthChangedFlag = false;
    }
    
    if(yesterdaydd<10) 
    {
        yesterdaydd = '0'+yesterdaydd;
    }
    if(yesterdaymm<10 && monthChangedFlag == true) 
    {
        yesterdaymm = '0'+yesterdaymm;
    }    
        
    //one day before 
    yesterday = yyyy + yesterdaymm + yesterdaydd;
    
    var yesterdayToInsert = yesterdaydd + '/' + yesterdaymm + '/' + yyyy;
    
        
    //Select date 2 days ago
    //exestatus = webObjects.clickWebObject(page, "id", yesterday, exestatus);  
    
    //Insert 2 days ago date
    exestatus = webObjects.insertTextWebObject(page, "id", "ReportViewerControl_ctl04_ctl07_txtValue", yesterdayToInsert, exestatus);
    
    //select todays date
    //exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl09_ddDropDownButton", exestatus);
    
    //Insert date instead of selecting
    exestatus = webObjects.insertTextWebObject(page, "id", "ReportViewerControl_ctl04_ctl09_txtValue", todayToInsert, exestatus);
    
    //Select today's date    
    //exestatus = webObjects.clickWebObject(page, "id", today, exestatus);
    
    //View Report
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl00", exestatus);
    
    aqUtils.Delay(10000);
	
   }
   return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvExtractInitialOpReports
// Desc :This function launches Operational reports and stores the initial values.  
// Owner :Mohammad Zeeshan
// Creation date: 20 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvExtractInitialOpReports(TestName, browser, exestatus)
{
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    // Wait for operational reports browser to appear
    var browser = Sys.Process("iexplore"); 
    
    //Verify that the operational reports page is loaded
    var page = browser.WaitPage("*", 20000);
    
    if (aqString.Compare(page.contentDocument.title, "Operational Report - Report Viewer", false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ page.contentDocument.title);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ "Operational Report - Report Viewer" +", not found. Found: "+ page.contentDocument.title);
  		exestatus = false;
  	}   
  	exestatus = mvObjects.waitForObject(browser, "TabButton(\"Operational Report - Report Viewer\")", 1000,exestatus);  
    
    //Now click on the summary and select the last 1 week duration
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl03_ddDropDownButton",exestatus);
    
    //Summary
    if (aqString.Compare(TestName, "OR_SUMMARY01", false) == 0) 
    {
        //Scroll into view
        var summary = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl02", 500);
        if(summary != null)
        {
            summary.scrollIntoView();
            summary.click();
            Log.Message("Summary is clicked!!");
        }
    }
    
    //Exit block from ICU
    if (aqString.Compare(TestName, "OR_ExitBlockFromICU", false) == 0) 
    {
        //Scroll into view
        var exitBlockFromICU = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl03", 500);
        if(exitBlockFromICU != null)
        {
            exitBlockFromICU.scrollIntoView();
            exitBlockFromICU.click();
            Log.Message("Summary is clicked!!");
        }
    }
    
    //Admission due to Rapid response call
    if (aqString.Compare(TestName, "OR_AdmssnDueToRRT", false) == 0) 
    {
        //Scroll into view
        var summary = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl05", 500);
        if(summary != null)
        {
            summary.scrollIntoView();
            summary.click();
            Log.Message("Summary is clicked!!");
        }
    }
    
    //After hours discharge
    if (aqString.Compare(TestName, "OR_AfterHrsDschrge", false) == 0) 
    {
        //Scroll into view
        var summary = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl06", 500);
        if(summary != null)
        {
            summary.scrollIntoView();
            summary.click();
            Log.Message("Summary is clicked!!");
        }
    }
    
    //Admissions and discharges
    if (aqString.Compare(TestName, "OR_AdmissionsAndDischarges", false) == 0) 
    {
        //Scroll into view
        var addAndDis = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl10", 500);
        if(addAndDis != null)
        {
            addAndDis.scrollIntoView();
            addAndDis.click();
            Log.Message("Admissions and discharges clicked!!");
        }
    }    
    
    //Types of Tracheostomies
    if (aqString.Compare(TestName, "OR_Tracheostomies", false) == 0) 
    {
        //Scroll into view
        var tracheostomies = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl07", 500);
        if(tracheostomies != null)
        {
            tracheostomies.scrollIntoView();
            tracheostomies.click();
            Log.Message("Types of tracheostomies clicked!!");
        }
    }
    
    //Renal Replacement Therapy
    if (aqString.Compare(TestName, "OR_RenalReplacmentTherapy", false) == 0) 
    {
        //Scroll into view
        var rrt = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl09", 500);
        if(rrt != null)
        {
            rrt.scrollIntoView();
            rrt.click();
            Log.Message("Renal replacement therapy clicked!!");
        }
    }
    
    //Reason for Intubation
    if (aqString.Compare(TestName, "OR_ReasonOfIntubation", false) == 0) 
    {
        //Scroll into view
        var reasonOfIntubations = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl08", 500);
        if(reasonOfIntubations != null)
        {
            reasonOfIntubations.scrollIntoView();
            reasonOfIntubations.click();
            Log.Message("reasonOfIntubations clicked!!");
        }
    }
    
    //Mechanical Ventilated Hours
    if (aqString.Compare(TestName, "OR_MechanicalVentillationHours", false) == 0) 
    {
        //Scroll into view
        var mechVentHours = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl11", 500);
        if(mechVentHours != null)
        {
            mechVentHours.scrollIntoView();
            mechVentHours.click();
            Log.Message("mechVentHours clicked!!");
        }
    }
    
    //Mechanically Ventilated Patients
    if (aqString.Compare(TestName, "OR_MechanicallyVentilatedPatients", false) == 0) 
    {
        //Scroll into view
        var mechVentPatients = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl12", 500);
        if(mechVentPatients != null)
        {
            mechVentPatients.scrollIntoView();
            mechVentPatients.click();
            Log.Message("mechVentPatients clicked!!");
        }
    }
    
    //ICU Line Days
    if (aqString.Compare(TestName, "OR_ICULineDays", false) == 0) 
    {
        //Scroll into view
        var iCULineDays = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl13", 500);
        if(iCULineDays != null)
        {
            iCULineDays.scrollIntoView();
            iCULineDays.click();
            Log.Message("iCULineDays clicked!!");
        }
    }
    
    //MR on Admission
    if (aqString.Compare(TestName, "OR_MROonAdmission", false) == 0) 
    {
        //Scroll into view
        var mroOnAdmission = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl14", 500);
        if(mroOnAdmission != null)
        {
            mroOnAdmission.scrollIntoView();
            mroOnAdmission.click();
            Log.Message("mroOnAdmission clicked!!");
        }
    }
    
    //MRO in ICU
    if (aqString.Compare(TestName, "OR_MROinICU", false) == 0) 
    {
        //Scroll into view
        var mroInICU = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl15", 500);
        //var mroInICU = page.FindChildByXPath("//*[@id='ReportViewerControl_ctl04_ctl03_divDropDown_ctl15']", true);
        if(mroInICU != null)
        {
            mroInICU.scrollIntoView();
            mroInICU.click();
            Log.Message("Object found & enabled on screen!");
        }
    }
        
    //FreeTextMedicationUsage
    if (aqString.Compare(TestName, "OR_FreeTextMedicationUsage", false) == 0) 
    {
        //Scroll into view
        var freeTxtMedUsg = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl16", 500);
        //var freeTxtMedUsg = page.FindChildByXPath("//*[@id='ReportViewerControl_ctl04_ctl03_divDropDown_ctl16']", true);
        if(freeTxtMedUsg != null)
        {
            freeTxtMedUsg.scrollIntoView();
            freeTxtMedUsg.click();
            Log.Message("Object found & enabled on screen!");
        }
    }
        
    //Known Allergy/ADR presriptions override
    if (aqString.Compare(TestName, "OR_KnownAllergyADRPrescriptionOverride", false) == 0) 
    {
        //Scroll into view
        var knownADRAllrgy = page.Find("NativeWebObject.id", "ReportViewerControl_ctl04_ctl03_divDropDown_ctl17", 500);
        //var knownADRAllrgy = page.FindChildByXPath("//*[@id='ReportViewerControl_ctl04_ctl03_divDropDown_ctl17']", true);
        if(knownADRAllrgy != null)
        {
            knownADRAllrgy.scrollIntoView();
            knownADRAllrgy.click();
            Log.Message("Object found & enabled on screen!");
        }
     }        
    
    //Now again click on the summary and select the last 1 day duration
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl03_ddDropDownButton",exestatus);

    // Find an object that corresponds to the specified criteria
    //exestatus = webObjects.selectDropDownItem(page, props, values, 2, exestatus);
    
    //Select the date range from last 1 day
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl07_ddDropDownButton", exestatus);   
      
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth() + 1;
    var yyyy = today.getFullYear();
    var yesterdaymm = 0;
    monthChangedFlag = false;
            
    if(dd<10) 
    {
        dd = '0'+dd;
    }
    if(mm<10) 
    {
        mm = '0'+mm;
    }    
    today = yyyy + mm + dd;
    var todayToInsert = dd + '/' + mm + '/' + yyyy;
    
    //Calculate yesterday based on month
    if((mm == 2 || mm == 4 || mm == 6 || mm == 9 || mm == 11) && dd == 1)
    {
      yesterdaydd = 31;
      yesterdaymm = mm - 1;
      monthChangedFlag = true;  
    }
    else if((mm == 1 || mm == 3 || mm == 5 || mm == 7 || mm == 8 || mm == 10 || mm == 12) && dd == 1)
    {
      yesterdaydd = 30;
      yesterdaymm = mm - 1; 
      monthChangedFlag = true;       
    }
    else
    {
      yesterdaydd = dd - 1;    
      yesterdaymm = mm;
      monthChangedFlag = false;
    }
    
    if(yesterdaydd<10) 
    {
        yesterdaydd = '0'+yesterdaydd;
    }
    if(yesterdaymm<10 && monthChangedFlag == true) 
    {
        yesterdaymm = '0'+yesterdaymm;
    }    
        
    //one day before 
    yesterday = yyyy + yesterdaymm + yesterdaydd;
    
    var yesterdayToInsert = yesterdaydd + '/' + yesterdaymm + '/' + yyyy;
    
        
    //Select date 2 days ago
    //exestatus = webObjects.clickWebObject(page, "id", yesterday, exestatus);  
    
    //Insert 2 days ago date
    exestatus = webObjects.insertTextWebObject(page, "id", "ReportViewerControl_ctl04_ctl07_txtValue", yesterdayToInsert, exestatus);
    
    //select todays date
    //exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl09_ddDropDownButton", exestatus);
    
    //Insert date instead of selecting
    exestatus = webObjects.insertTextWebObject(page, "id", "ReportViewerControl_ctl04_ctl09_txtValue", todayToInsert, exestatus);
    
    //Select today's date    
    //exestatus = webObjects.clickWebObject(page, "id", today, exestatus);
    
    //View Report
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl00", exestatus);
    
    aqUtils.Delay(10000);
    
    //Summary operational report
    if (aqString.Compare(TestName, "OR_SUMMARY01", false) == 0) 
    {
    
      //*************Get the values of various summary attributes*************
      //Number of Admissions 
      //Number of ICU Admissions 
      //Number of HDU Admissions 
      //Number of CCU Admissions 
      //Number of Undocumented Admissions 
      //Number of Patients 
      //Number of ICU Deaths
    
      var numberOfAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfAdmissionsObj != null)
      {
        var numberOfAdmissions = numberOfAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfAdmissions was not found.");
      }
    
      var numberOfICUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfICUAdmissionsObj != null)
      {
        var numberOfICUAdmissions = numberOfICUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUAdmissions was not found.");
      }
    
      var numberOfHDUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfHDUAdmissionsObj != null)
      {
        var numberOfHDUAdmissions = numberOfHDUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfHDUAdmissionsObj was not found.");
      }
    
      var numberOfCCUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCCUAdmissionsObj != null)
      {
        var numberOfCCUAdmissions = numberOfCCUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCCUAdmissions was not found.");
      }
    
      var numberOfUndocAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[7]/td[3]/div", true);
      if(numberOfUndocAdmissionsObj != null)
      {
        var numberOfUndocAdmissions = numberOfUndocAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfUndocAdmissions was not found.");
      }
    
      var numberOfPatientsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[8]/td[3]/div", true);
      if(numberOfPatientsObj != null)
      {
        var numberOfPatients = numberOfPatientsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfPatients was not found.");
      }
    
      var numberOfICUDeathsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[17]/td[3]/div", true);
      if(numberOfICUDeathsObj != null)
      {
        var numberOfICUDeaths = numberOfICUDeathsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUDeaths was not found.");
      }
    
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","numberOfAdmissions",numberOfAdmissions);
      Data.UpdateData(TestName,"OpReports","numberOfICUAdmissions",numberOfICUAdmissions);
      Data.UpdateData(TestName,"OpReports","numberOfHDUAdmissions",numberOfHDUAdmissions);
      Data.UpdateData(TestName,"OpReports","numberOfCCUAdmissions",numberOfCCUAdmissions);
      Data.UpdateData(TestName,"OpReports","numberOfUndocAdmissions",numberOfUndocAdmissions);
      Data.UpdateData(TestName,"OpReports","numberOfPatients",numberOfPatients);
      Data.UpdateData(TestName,"OpReports","numberOfICUDeaths",numberOfICUDeaths);
    
    }
    
    //Get data for Exit block from ICU
    if (aqString.Compare(TestName, "OR_ExitBlockFromICU", false) == 0) 
    {    
      var numberOfDisAliveObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfDisAliveObj != null)
      {
        var numberOfDisAlive = numberOfDisAliveObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfDisAlive was not found.");
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","caseDischargedAliveFrmICU",numberOfDisAlive);
   }
   
   //Number of ICU admissions due to RRC
   if (aqString.Compare(TestName, "OR_AdmssnDueToRRT", false) == 0) 
   { 
      var numberOfICUDueToRRCObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfICUDueToRRCObj != null)
      {
      var numberOfICUDueToRRC = numberOfICUDueToRRCObj.innerText;
      }
      else
      {
      Log.Error("The element numberOfICUDueToRRC was not found.");
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","numberOfICUDueToRRC",numberOfICUDueToRRC);
   }
   
   //After hours ICU discharge
   if (aqString.Compare(TestName, "OR_AfterHrsDschrge", false) == 0) 
   {
      var numberOfAfterHoursDschrgObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfAfterHoursDschrgObj != null)
      {
      var numberOfAfterHoursDschrg = numberOfAfterHoursDschrgObj.innerText;
      }
      else
      {
      Log.Error("The element numberOfAfterHoursDschrg was not found.");
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","numberOfAfterHoursDschrg",numberOfAfterHoursDschrg);
   }
   
   //Number of different types of Tracheostomies
   if (aqString.Compare(TestName, "OR_Tracheostomies", false) == 0) 
   {
     //Surgical   
      var surgicalTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[3]/div", true);
      if(surgicalTracheostomiesObj != null)
      {
        var surgicalTracheostomies = surgicalTracheostomiesObj.innerText;
        //Store the values in the OpReports excel sheet and use this for comparison
        Data.UpdateData(TestName,"OpReports","surgicalTracheostomies",surgicalTracheostomies);
      }
      else
      {
        Log.Error("The element surgicalTracheostomies was not found.");
      }     
      
      //Dilation
      var dilationTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[4]/div", true);
      if(dilationTracheostomiesObj != null)
      {
        var dilationTracheostomies = dilationTracheostomiesObj.innerText;
        //Store the values in the OpReports excel sheet and use this for comparison
        Data.UpdateData(TestName,"OpReports","dilationTracheostomies",dilationTracheostomies);
      }
      else
      {
        Log.Error("The element dilationTracheostomies was not found.");
      }
      
      //Limited Dissection
      var limitedDissectionTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[5]/div", true);
      if(limitedDissectionTracheostomiesObj != null)
      {
        var limitedDissectionTracheostomies = limitedDissectionTracheostomiesObj.innerText;
        //Store the values in the OpReports excel sheet and use this for comparison
        Data.UpdateData(TestName,"OpReports","limitedDissectionTracheostomies",limitedDissectionTracheostomies);
      }
      else
      {
        Log.Error("The element limitedDissectionTracheostomies was not found.");
      }    
   } 
   
   //Number of free medication usage
   if (aqString.Compare(TestName, "OR_FreeTextMedicationUsage", false) == 0) 
   {
      //Find the number of table entries and store it
      //If this count increases it means the new free text medication is added in the report
      var arrayOfRows = page.EvaluateXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[2]/table[contains(@cols, '21')]/tbody/tr[*]");
      var numberOfRows = arrayOfRows.length;
   
      var freeTextMedicationUsageObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[2]/table[contains(@cols, '21')]/tbody/tr[3]/td[5]/div", true);
      if(freeTextMedicationUsageObj != null)
      {
        var freeTextMedicationUsage = freeTextMedicationUsageObj.innerText;
      }
      else
      {
        var freeTextMedicationUsage = 0;      
        Log.Message("The element freeTextMedicationUsage was not found.");
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","freeTextMedicationUsage",numberOfRows);
   } 
   
   //Known Allergy ADR Prescription Override
   if (aqString.Compare(TestName, "OR_KnownAllergyADRPrescriptionOverride", false) == 0) 
   {
      //Find the number of table entries and store it
      //If this count increases it means the new free text medication is added in the report
      var arrayOfRows = page.EvaluateXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[2]/table[contains(@cols, '22')]/tbody/tr[*]");
      if(arrayOfRows != null)
      {
        var numberOfRows = arrayOfRows.length;
        exestatus = true;
      }
      else
      {
        Log.Error("The element KnownAllergyADRPrescriptionOverride was not found.");
        exestatus = false;
      }   
            
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","KnownAllergyADRPrescriptionOverride",numberOfRows);
   }
   
   //MRO in ICU
   if (aqString.Compare(TestName, "OR_MROinICU", false) == 0) 
   {    
      var numberOfVREinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfVREinICUObj != null)
      {
        var numberOfVREinICU = numberOfVREinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfVREinICU was not found.");
        exestatus = false;
      }
      
      var numberOfMRSAinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfMRSAinICUObj != null)
      {
        var numberOfMRSAinICU = numberOfMRSAinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfMRSAinICU was not found.");
        exestatus = false;
      }
      
      var numberOfESBLinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfESBLinICUObj != null)
      {
        var numberOfESBLinICU = numberOfESBLinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfESBLinICU was not found.");
        exestatus = false;
      }
      
      var numberOfCREinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCREinICUObj != null)
      {
        var numberOfCREinICU = numberOfCREinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCREinICU was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","numberOfVREinICU",numberOfVREinICU);
      Data.UpdateData(TestName,"OpReports","numberOfMRSAinICU",numberOfMRSAinICU);
      Data.UpdateData(TestName,"OpReports","numberOfESBLinICU",numberOfESBLinICU);
      Data.UpdateData(TestName,"OpReports","numberOfCREinICU",numberOfCREinICU);
   }
   
   //MRO on Admission
   if (aqString.Compare(TestName, "OR_MROonAdmission", false) == 0) 
   {    
      var numberOfVREonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfVREonAdmissionObj != null)
      {
        var numberOfVREonAdmission = numberOfVREonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfVREonAdmission was not found.");
        exestatus = false;
      }
      
      var numberOfMRSAonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfMRSAonAdmissionObj != null)
      {
        var numberOfMRSAonAdmission = numberOfMRSAonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfMRSAonAdmission was not found.");
        exestatus = false;
      }
      
      var numberOfESBLonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfESBLonAdmissionObj != null)
      {
        var numberOfESBLonAdmission = numberOfESBLonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfESBLonAdmission was not found.");
        exestatus = false;
      }
      
      var numberOfCREonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCREonAdmissionObj != null)
      {
        var numberOfCREonAdmission = numberOfCREonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCREonAdmission was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","numberOfVREonAdmission",numberOfVREonAdmission);
      Data.UpdateData(TestName,"OpReports","numberOfMRSAonAdmission",numberOfMRSAonAdmission);
      Data.UpdateData(TestName,"OpReports","numberOfESBLonAdmission",numberOfESBLonAdmission);
      Data.UpdateData(TestName,"OpReports","numberOfCREonAdmission",numberOfCREonAdmission);
   }

   //ICU Line Days
   if (aqString.Compare(TestName, "OR_ICULineDays", false) == 0) 
   {    
      var cvcLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[2]/div", true);
      if(cvcLineDaysObj != null)
      {
        var cvcLineDays = cvcLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element cvcLineDays was not found.");
        exestatus = false;
      }
      
      var piccLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[3]/div", true);
      if(piccLineDaysObj != null)
      {
        var piccLineDays = piccLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element piccLineDays was not found.");
        exestatus = false;
      }
      
      var vascathLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[4]/div", true);
      if(vascathLineDaysObj != null)
      {
        var vascathLineDays = vascathLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element vascathLineDays was not found.");
        exestatus = false;
      }
      
      var centralLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[5]/div", true);
      if(centralLineDaysObj != null)
      {
        var centralLineDays = centralLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element centralLineDays was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","cvcLineDays",cvcLineDays);
      Data.UpdateData(TestName,"OpReports","piccLineDays",piccLineDays);
      Data.UpdateData(TestName,"OpReports","vascathLineDays",vascathLineDays);
      Data.UpdateData(TestName,"OpReports","centralLineDays",centralLineDays);
   }  
   
   //Mechanically Ventilated Patients
   if (aqString.Compare(TestName, "OR_MechanicallyVentilatedPatients", false) == 0) 
   {    
      var invasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[3]/div", true);
      if(invasiveObj != null)
      {
        var invasive = invasiveObj.innerText;
      }
      else
      {
        Log.Error("The element invasive was not found.");
        exestatus = false;
      }
      
      var nonInvasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[4]/div", true);
      if(nonInvasiveObj != null)
      {
        var nonInvasive = nonInvasiveObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasive was not found.");
        exestatus = false;
      }
      
      var bothInvNonInvObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[5]/div", true);
      if(bothInvNonInvObj != null)
      {
        var bothInvNonInv = bothInvNonInvObj.innerText;
      }
      else
      {
        Log.Error("The element bothInvNonInv was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","invasive",invasive);
      Data.UpdateData(TestName,"OpReports","nonInvasive",nonInvasive);
      Data.UpdateData(TestName,"OpReports","bothInvNonInv",bothInvNonInv);      
   }   
   
   //Mechanically Ventilated Hours
   if (aqString.Compare(TestName, "OR_MechanicalVentillationHours", false) == 0) 
   {    
      var invasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[3]/div", true);
      if(invasiveObj != null)
      {
        var invasive = invasiveObj.innerText;
      }
      else
      {
        Log.Error("The element invasive was not found.");
        exestatus = false;
      }
      
      var nonInvasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[4]/div", true);
      if(nonInvasiveObj != null)
      {
        var nonInvasive = nonInvasiveObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasive was not found.");
        exestatus = false;
      }
      
      var highFlowObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[5]/div", true);
      if(highFlowObj != null)
      {
        var highFlow = highFlowObj.innerText;
      }
      else
      {
        Log.Error("The element highFlow was not found.");
        exestatus = false;
      }
      
      var patientHoursObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[3]/div", true);
      if(patientHoursObj != null)
      {
        var patientHours = patientHoursObj.innerText;
      }
      else
      {
        Log.Error("The element patientHours was not found.");
        exestatus = false;
      }
      
      var invasivePercntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[3]/div", true);
      if(invasivePercntObj != null)
      {
        var invasivePercnt = invasivePercntObj.innerText;
      }
      else
      {
        Log.Error("The element invasivePercnt was not found.");
        exestatus = false;
      }
      
      var nonInvasivePrcntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[4]/div", true);
      if(nonInvasivePrcntObj != null)
      {
        var nonInvasivePrcnt = nonInvasivePrcntObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasivePrcnt was not found.");
        exestatus = false;
      }
      
      var highFlowPrcntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[5]/div", true);
      if(highFlowPrcntObj != null)
      {
        var highFlowPrcnt = highFlowPrcntObj.innerText;
      }
      else
      {
        Log.Error("The element highFlowPrcnt was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","invasive",invasive);
      Data.UpdateData(TestName,"OpReports","nonInvasive",nonInvasive);
      Data.UpdateData(TestName,"OpReports","highFlow",highFlow);  
      Data.UpdateData(TestName,"OpReports","patientHours",patientHours);
      Data.UpdateData(TestName,"OpReports","invasivePercnt",invasivePercnt);
      Data.UpdateData(TestName,"OpReports","nonInvasivePrcnt",nonInvasivePrcnt);
      Data.UpdateData(TestName,"OpReports","highFlowPrcnt",highFlowPrcnt);          
   }
   
   //Reason for Intubation
   if (aqString.Compare(TestName, "OR_ReasonOfIntubation", false) == 0) 
   {    
      var unplannedExtubationsObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(unplannedExtubationsObj != null)
      {
        var unplannedExtubations = unplannedExtubationsObj.innerText;
      }
      else
      {
        Log.Error("The element unplannedExtubations was not found.");
        exestatus = false;
      }
      
      var failedExtubationsObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(failedExtubationsObj != null)
      {
        var failedExtubations = failedExtubationsObj.innerText;
      }
      else
      {
        Log.Error("The element failedExtubations was not found.");
        exestatus = false;
      }
      
      var failedNIVObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(failedNIVObj != null)
      {
        var failedNIV = failedNIVObj.innerText;
      }
      else
      {
        Log.Error("The element failedNIV was not found.");
        exestatus = false;
      }
      
      var intubationsCountObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(intubationsCountObj != null)
      {
        var intubationsCount = intubationsCountObj.innerText;
      }
      else
      {
        Log.Error("The element intubationsCount was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","unplannedExtubations",unplannedExtubations);
      Data.UpdateData(TestName,"OpReports","failedExtubations",failedExtubations);
      Data.UpdateData(TestName,"OpReports","failedNIV",failedNIV);  
      Data.UpdateData(TestName,"OpReports","intubationsCount",intubationsCount);          
   }
   
   //RRT
   if (aqString.Compare(TestName, "OR_RenalReplacmentTherapy", false) == 0) 
   {    
      var rrtCountObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(rrtCountObj != null)
      {
        var rrtCount = rrtCountObj.innerText;
      }
      else
      {
        Log.Error("The element rrtCount was not found.");
        exestatus = false;
      }
      
      var icuCasesCountObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(icuCasesCountObj != null)
      {
        var icuCasesCount = icuCasesCountObj.innerText;
      }
      else
      {
        Log.Error("The element icuCasesCount was not found.");
        exestatus = false;
      }
      
      var rrtIndicatorObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(rrtIndicatorObj != null)
      {
        var rrtIndicator = rrtIndicatorObj.innerText;
      }
      else
      {
        Log.Error("The element rrtIndicator was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","rrtCount",rrtCount);
      Data.UpdateData(TestName,"OpReports","icuCasesCount",icuCasesCount);
      Data.UpdateData(TestName,"OpReports","rrtIndicator",rrtIndicator);           
   }
   
   //Admissions and discharges
   if (aqString.Compare(TestName, "OR_AdmissionsAndDischarges", false) == 0) 
   {  
     //OT/Recovery   
      var otRecoveryObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[3]/td[3]/div", true);
      if(otRecoveryObj != null)
      {
        var otRecovery = otRecoveryObj.innerText;
      }
      else
      {
        Log.Error("The element otRecovery was not found.");
        exestatus = false;
      }
      
      //Emergency department
      var emergncyDeptttObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[4]/td[3]/div", true);
      if(emergncyDeptttObj != null)
      {
        var emergncyDepttt = emergncyDeptttObj.innerText;
      }
      else
      {
        Log.Error("The element emergncyDepttt was not found.");
        exestatus = false;
      }
      
      //Ward
      var wardObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[5]/td[3]/div", true);
      if(wardObj != null)
      {
        var ward = wardObj.innerText;
      }
      else
      {
        Log.Error("The element ward was not found.");
        exestatus = false;
      }
      
      //ICU
      var careTypeICUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[12]/td[3]/div", true);
      if(careTypeICUObj != null)
      {
        var careTypeICU = careTypeICUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeICU was not found.");
        exestatus = false;
      }
      
      //HDU
      var careTypeHDUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[13]/td[3]/div", true);
      if(careTypeHDUObj != null)
      {
        var careTypeHDU = careTypeHDUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeHDU was not found.");
        exestatus = false;
      }
      
      //CCU
      var careTypeCCUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[14]/td[3]/div", true);
      if(careTypeCCUObj != null)
      {
        var careTypeCCU = careTypeCCUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeCCU was not found.");
        exestatus = false;
      }
      
      //Died in ICU/HDU
      var outcomeDiedInICUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[20]/td[3]/div", true);
      if(outcomeDiedInICUObj != null)
      {
        var outcomeDiedInICU = outcomeDiedInICUObj.innerText;
      }
      else
      {
        Log.Error("The element outcomeDiedInICU was not found.");
        exestatus = false;
      }
      
      //Undocumented Admissions
      var unDocAdmissionsAnDObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[10]/td[3]/div", true);
      if(unDocAdmissionsAnDObj != null)
      {
        var unDocAdmissionsAnD = unDocAdmissionsAnDObj.innerText;
      }
      else
      {
        Log.Error("The element unDocAdmissionsAnD was not found.");
        exestatus = false;
      }
      
      //Number Of ICU Admissions
      var numberOfICUAdmissionsAnDObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[2]/td[2]/div", true);
      if(numberOfICUAdmissionsAnDObj != null)
      {
        var numberOfICUAdmissionsAnD = numberOfICUAdmissionsAnDObj.innerText.split(':')[1];
      }
      else
      {
        Log.Error("The element numberOfICUAdmissionsAnD was not found.");
        exestatus = false;
      }
      
      //Store the values in the OpReports excel sheet and use this for comparison
      Data.UpdateData(TestName,"OpReports","unDocAdmissionsAnD",unDocAdmissionsAnD);
      Data.UpdateData(TestName,"OpReports","numberOfICUAdmissionsAnD",numberOfICUAdmissionsAnD);
      Data.UpdateData(TestName,"OpReports","otRecovery",otRecovery);
      Data.UpdateData(TestName,"OpReports","emergncyDepttt",emergncyDepttt);
      Data.UpdateData(TestName,"OpReports","ward",ward);  
      Data.UpdateData(TestName,"OpReports","careTypeICU",careTypeICU);
      Data.UpdateData(TestName,"OpReports","careTypeHDU",careTypeHDU);
      Data.UpdateData(TestName,"OpReports","careTypeCCU",careTypeCCU);
      Data.UpdateData(TestName,"OpReports","outcomeDiedInICU",outcomeDiedInICU);         
   }
   
  }
  return exestatus;  
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvRefreshOpReports
// Desc :This function fetches the latest Op reports 
// Owner :Mohammad Zeeshan
// Creation date: 24 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvRefreshOpReports(TestName, exestatus)
{
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    // Wait for operational reports browser to appear
    var browser = Sys.Process("iexplore"); 
    
    //Verify that the operational reports page is loaded
    var page = browser.WaitPage("*", 20000);
    
    if (aqString.Compare(page.contentDocument.title, "Operational Report - Report Viewer", false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ page.contentDocument.title);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ "Operational Report - Report Viewer" +", not found. Found: "+ page.contentDocument.title);
  		exestatus = false;
  	}
    
    //View Report
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl00", exestatus);
  }
  return exestatus;  
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvVerifyFinalOR
// Desc :This function fetches the latest Op reports 
// Owner :Mohammad Zeeshan
// Creation date: 24 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvVerifyFinalOR(TestName, whichFieldToVerify, exestatus)
{
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    // Wait for operational reports browser to appear
    var browser = Sys.Process("iexplore"); 
    
    //Verify that the operational reports page is loaded
    var page = browser.WaitPage("*", 20000);
    
    if (aqString.Compare(page.contentDocument.title, "Operational Report - Report Viewer", false) == 0) 
    {
  		Log.Checkpoint("Found expected value: "+ page.contentDocument.title);
  	} 
    else 
    {
  		Log.Error("Expected value: "+ "Operational Report - Report Viewer" +", not found. Found: "+ page.contentDocument.title);
  		exestatus = false;
  	}
    
    //Put a delay for Mechanical Ventilation Hours
    //if(aqString.Compare(whichFieldToVerify, "MechanicalVentillationHours", false) == 0)
    //{
        //aqUtils.Delay(300000);
    //}
    
    //View Report
    exestatus = webObjects.clickWebObject(page, "id", "ReportViewerControl_ctl04_ctl00", exestatus);
    aqUtils.Delay(5000);
    Log.Picture(Sys.Desktop.Picture());
    
    //Verify the required field
    //Get the old values from eRIC_TestAutomation_Data.xls and compare it with the current value
    
    var tcDesc = Data.getData(TestName,"OpReports","TC_DESC");
    
    if (aqString.Compare(whichFieldToVerify, "numberOfAdmissions", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfAdmissionsBefore = Data.getData(TestName,"OpReports","numberOfAdmissions");
      
      //Get the latest data from the internet explorer
      var numberOfAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfAdmissionsObj != null)
      {
        var numberOfAdmissionsAfter = numberOfAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfAdmissions was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfAdmissionsBefore) + 1;
      numberOfAdmissionsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfAdmissionsBefore, numberOfAdmissionsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of admissions count increased to: "+ numberOfAdmissionsAfter);      
      }
      else
      {
        Log.Error("The element numberOfAdmissions didn't increase: " + numberOfAdmissionsAfter);
        exestatus = false;
      }      
	  }
    
    //Verify number of undocumented admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfUndocAdmissions", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfUndocAdmissionsBefore = Data.getData(TestName,"OpReports","numberOfUndocAdmissions");
      
      //Get the latest data from the internet explorer
      var numberOfUndocAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[7]/td[3]/div", true);
      if(numberOfUndocAdmissionsObj != null)
      {
        var numberOfUndocAdmissionsAfter = numberOfUndocAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfUndocAdmissions was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfUndocAdmissionsBefore) + 1;
      numberOfUndocAdmissionsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfUndocAdmissionsBefore, numberOfUndocAdmissionsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of undoc admissions count increased to: "+ numberOfUndocAdmissionsAfter);      
      }
      else
      {
        Log.Error("The element numberOfUndocAdmissions didn't increase: " + numberOfUndocAdmissionsAfter);
        exestatus = false;
      }      
	  }
    
    //Verify number of ICU admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfICUAdmissions", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfICUAdmissionsBefore = Data.getData(TestName,"OpReports","numberOfICUAdmissions");
      
      //Get the latest data from the internet explorer
      var numberOfICUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfICUAdmissionsObj != null)
      {
        var numberOfICUAdmissionsAfter = numberOfICUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUAdmissions was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfICUAdmissionsBefore) + 1;
      numberOfICUAdmissionsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfICUAdmissionsBefore, numberOfICUAdmissionsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ICU admissions count increased to: "+ numberOfICUAdmissionsAfter);      
      }
      else
      {
        Log.Error("The element numberOfICUAdmissions didn't increase: " + numberOfICUAdmissionsAfter);
        exestatus = false;
      }      
	  }
    
    //Verify number of HDU admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfHDUAdmissions", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfHDUAdmissionsBefore = Data.getData(TestName,"OpReports","numberOfHDUAdmissions");
      
      //Get the latest data from the internet explorer
      var numberOfHDUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfHDUAdmissionsObj != null)
      {
        var numberOfHDUAdmissionsAfter = numberOfHDUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfHDUAdmissions was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfHDUAdmissionsBefore) + 1;
      numberOfHDUAdmissionsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfHDUAdmissionsBefore, numberOfHDUAdmissionsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of HDU admissions count increased to: "+ numberOfHDUAdmissionsAfter);      
      }
      else
      {
        Log.Error("The element numberOfHDUAdmissions didn't increase: " + numberOfHDUAdmissionsAfter);
        exestatus = false;
      }    
	  }
    
    //Verify number of CCU admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfCCUAdmissions", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfCCUAdmissionsBefore = Data.getData(TestName,"OpReports","numberOfCCUAdmissions");
      
      //Get the latest data from the internet explorer
      var numberOfCCUAdmissionsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCCUAdmissionsObj != null)
      {
        var numberOfCCUAdmissionsAfter = numberOfCCUAdmissionsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCCUAdmissions was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfCCUAdmissionsBefore) + 1;
      numberOfCCUAdmissionsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfCCUAdmissionsBefore, numberOfCCUAdmissionsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of CCU admissions count increased to: "+ numberOfCCUAdmissionsAfter);      
      }
      else
      {
        Log.Error("The element numberOfCCUAdmissions didn't increase: " + numberOfCCUAdmissionsAfter);
        exestatus = false;
      }      
	  }
    
    //Verify number of Patients 
    if (aqString.Compare(whichFieldToVerify, "numberOfPatients", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfPatientsBefore = Data.getData(TestName,"OpReports","numberOfPatients");
      
      //Get the latest data from the internet explorer
      var numberOfPatientsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[8]/td[3]/div", true);
      if(numberOfPatientsObj != null)
      {
        var numberOfPatientsAfter = numberOfPatientsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfPatients was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfPatientsBefore) + 1;
      numberOfPatientsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfPatientsBefore, numberOfPatientsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of patients count increased to: "+ numberOfPatientsAfter);      
      }
      else
      {
        Log.Error("The element numberOfPatients didn't increase: " + numberOfPatientsAfter);
        exestatus = false;
      }      
	  }
    
    //Verify number of deaths
    if (aqString.Compare(whichFieldToVerify, "numberOfICUDeaths", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfICUDeathsBefore = Data.getData(TestName,"OpReports","numberOfICUDeaths");
      
      //Get the latest data from the internet explorer
      var numberOfICUDeathsObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[17]/td[3]/div", true);
      if(numberOfICUDeathsObj != null)
      {
        var numberOfICUDeathsAfter = numberOfICUDeathsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUDeaths was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfICUDeathsBefore) + 1;
      numberOfICUDeathsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfICUDeathsBefore, numberOfICUDeathsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ICU death count increased to: "+ numberOfICUDeathsAfter);      
      }
      else
      {
        Log.Error("The element numberOfICUDeaths didn't increase: " + numberOfICUDeathsAfter);
        exestatus = false;
      }      
	  }
    
    //ICU source - OT/Recovery
    if (aqString.Compare(whichFieldToVerify, "sourceOTRecovery", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var sourceOTRecoveryBefore = Data.getData(TestName,"OpReports","otRecovery");
      
      //Get the latest data from the internet explorer
      var sourceOTRecoveryObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[3]/td[3]/div", true);
      if(sourceOTRecoveryObj != null)
      {
        var sourceOTRecoveryAfter = sourceOTRecoveryObj.innerText;
      }
      else
      {
        Log.Error("The element sourceOTRecovery was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(sourceOTRecoveryBefore) + 1;
      sourceOTRecoveryBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(sourceOTRecoveryBefore, sourceOTRecoveryAfter, false) == 0) 
      {
        Log.Checkpoint("Number of sourceOTRecovery increased to: "+ sourceOTRecoveryAfter);      
      }
      else
      {
        Log.Error("The element sourceOTRecovery didn't increase: " + sourceOTRecoveryAfter);
        exestatus = false;
      }      
	  }
    
    //ICU source - Emergency department
    if (aqString.Compare(whichFieldToVerify, "sourceEmergncyDepttt", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var emergncyDeptttBefore = Data.getData(TestName,"OpReports","emergncyDepttt");
      
      //Get the latest data from the internet explorer
      var emergncyDeptttObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[4]/td[3]/div", true);
      if(emergncyDeptttObj != null)
      {
        var emergncyDeptttAfter = emergncyDeptttObj.innerText;
      }
      else
      {
        Log.Error("The element emergncyDepttt was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(emergncyDeptttBefore) + 1;
      emergncyDeptttBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(emergncyDeptttBefore, emergncyDeptttAfter, false) == 0) 
      {
        Log.Checkpoint("Number of emergncyDepttt increased to: "+ emergncyDeptttAfter);      
      }
      else
      {
        Log.Error("The element emergncyDepttt didn't increase: " + emergncyDeptttAfter);
        exestatus = false;
      }      
	  }
    
    //ICU source - ward
    if (aqString.Compare(whichFieldToVerify, "sourceWard", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var wardBefore = Data.getData(TestName,"OpReports","ward");
      
      //Get the latest data from the internet explorer
      var wardObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[5]/td[3]/div", true);
      if(wardObj != null)
      {
        var wardAfter = wardObj.innerText;
      }
      else
      {
        Log.Error("The element ward was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(wardBefore) + 1;
      wardBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(wardBefore, wardAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ward increased to: "+ wardAfter);      
      }
      else
      {
        Log.Error("The element ward didn't increase: " + wardAfter);
        exestatus = false;
      }      
	  }
    
    //Care Type - ICU
    if (aqString.Compare(whichFieldToVerify, "careTypeICU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var careTypeICUBefore = Data.getData(TestName,"OpReports","careTypeICU");
      
      //Get the latest data from the internet explorer
      var careTypeICUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[12]/td[3]/div", true);
      if(careTypeICUObj != null)
      {
        var careTypeICUAfter = careTypeICUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(careTypeICUBefore) + 1;
      careTypeICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(careTypeICUBefore, careTypeICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of careTypeICU increased to: "+ careTypeICUAfter);      
      }
      else
      {
        Log.Error("The element careTypeICU didn't increase: " + careTypeICUAfter);
        exestatus = false;
      }      
	  }
    
    //Care Type - HDU
    if (aqString.Compare(whichFieldToVerify, "careTypeHDU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var wardBefore = Data.getData(TestName,"OpReports","careTypeHDU");
      
      //Get the latest data from the internet explorer
      var careTypeHDUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[13]/td[3]/div", true);
      if(careTypeHDUObj != null)
      {
        var careTypeHDUAfter = careTypeHDUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeHDU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(careTypeHDUBefore) + 1;
      careTypeHDUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(careTypeHDUBefore, careTypeHDUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of careTypeHDU increased to: "+ careTypeHDUAfter);      
      }
      else
      {
        Log.Error("The element careTypeHDU didn't increase: " + careTypeHDUAfter);
        exestatus = false;
      }      
	  }
    
    //Care Type - CCU
    if (aqString.Compare(whichFieldToVerify, "careTypeCCU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var careTypeCCUBefore = Data.getData(TestName,"OpReports","careTypeCCU");
      
      //Get the latest data from the internet explorer
      var careTypeCCUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[14]/td[3]/div", true);
      if(careTypeCCUObj != null)
      {
        var careTypeCCUAfter = careTypeCCUObj.innerText;
      }
      else
      {
        Log.Error("The element careTypeCCU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(careTypeCCUBefore) + 1;
      careTypeCCUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(careTypeCCUBefore, careTypeCCUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of careTypeCCU increased to: "+ careTypeCCUAfter);      
      }
      else
      {
        Log.Error("The element careTypeCCU didn't increase: " + careTypeCCUAfter);
        exestatus = false;
      }      
	  }
    
    //Died in ICU/HDU
    if (aqString.Compare(whichFieldToVerify, "outcomeDiedInICU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var outcomeDiedInICUBefore = Data.getData(TestName,"OpReports","outcomeDiedInICU");
      
      //Get the latest data from the internet explorer
      var outcomeDiedInICUObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[20]/td[3]/div", true);
      if(outcomeDiedInICUObj != null)
      {
        var outcomeDiedInICUAfter = outcomeDiedInICUObj.innerText;
      }
      else
      {
        Log.Error("The element outcomeDiedInICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(outcomeDiedInICUBefore) + 1;
      outcomeDiedInICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(outcomeDiedInICUBefore, outcomeDiedInICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of outcomeDiedInICU increased to: "+ outcomeDiedInICUAfter);      
      }
      else
      {
        Log.Error("The element outcomeDiedInICU didn't increase: " + outcomeDiedInICUAfter);
        exestatus = false;
      }      
	  }
    
    //Admission and Discharges - Number Of Undocumented Admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfUndocAdmissionsAnD", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var unDocAdmissionsAnDBefore = Data.getData(TestName,"OpReports","unDocAdmissionsAnD");
      
      //Get the latest data from the internet explorer
      var unDocAdmissionsAnDObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[10]/td[3]/div", true);
      if(unDocAdmissionsAnDObj != null)
      {
        var unDocAdmissionsAnDAfter = unDocAdmissionsAnDObj.innerText;
      }
      else
      {
        Log.Error("The element unDocAdmissionsAnD was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(unDocAdmissionsAnDBefore) + 1;
      unDocAdmissionsAnDBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(unDocAdmissionsAnDBefore, unDocAdmissionsAnDAfter, false) == 0) 
      {
        Log.Checkpoint("Number of unDocAdmissionsAnD increased to: "+ unDocAdmissionsAnDAfter);      
      }
      else
      {
        Log.Error("The element unDocAdmissionsAnD didn't increase: " + unDocAdmissionsAnDAfter);
        exestatus = false;
      }      
	  }
    
    //Admission and Discharges - Number Of ICU Admissions
    if (aqString.Compare(whichFieldToVerify, "numberOfICUAdmissionsAnD", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfICUAdmissionsAnDBefore = Data.getData(TestName,"OpReports","numberOfICUAdmissionsAnD");
      
      //Get the latest data from the internet explorer
      var numberOfICUAdmissionsAnDObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[2]/td[2]/div", true);
      if(numberOfICUAdmissionsAnDObj != null)
      {
        var numberOfICUAdmissionsAnDAfter = numberOfICUAdmissionsAnDObj.innerText.split(':')[1];;
      }
      else
      {
        Log.Error("The element numberOfICUAdmissionsAnD was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfICUAdmissionsAnDBefore) + 1;
      numberOfICUAdmissionsAnDBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfICUAdmissionsAnDBefore.trim(), numberOfICUAdmissionsAnDAfter.trim(), false) == 0) 
      {
        Log.Checkpoint("Number of numberOfICUAdmissionsAnD increased to: "+ numberOfICUAdmissionsAnDAfter);      
      }
      else
      {
        Log.Error("The element numberOfICUAdmissionsAnD didn't increase: " + numberOfICUAdmissionsAnDAfter);
        exestatus = false;
      }      
	  }
    
    //Admission and Discharges - Verify number of deaths
    if (aqString.Compare(whichFieldToVerify, "numberOfICUDeathsAnD", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfICUDeathsBefore = Data.getData(TestName,"OpReports","outcomeDiedInICU");
      
      //Get the latest data from the internet explorer
      var numberOfICUDeathsObj = page.FindChildByXPath("//table[contains(@cols, '5')]/tbody/tr[7]/td[3]/table[contains(@cols, '4')]/tbody/tr[20]/td[3]/div", true);
      if(numberOfICUDeathsObj != null)
      {
        var numberOfICUDeathsAfter = numberOfICUDeathsObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUDeaths was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfICUDeathsBefore) + 1;
      numberOfICUDeathsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfICUDeathsBefore, numberOfICUDeathsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ICU death count increased to: "+ numberOfICUDeathsAfter);      
      }
      else
      {
        Log.Error("The element numberOfICUDeaths didn't increase: " + numberOfICUDeathsAfter);
        exestatus = false;
      }      
	  }
       
    //Verify Cases discharged alive from ICU    
    if (aqString.Compare(whichFieldToVerify, "caseDischargedAliveFrmICU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var caseDischargedAliveFrmICUBefore = Data.getData(TestName,"OpReports","caseDischargedAliveFrmICU");
      
      //Get the latest data from the internet explorer
      var caseDischargedAliveFrmICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(caseDischargedAliveFrmICUObj != null)
      {
        var caseDischargedAliveFrmICUAfter = caseDischargedAliveFrmICUObj.innerText;
      }
      else
      {
        Log.Error("The element caseDischargedAliveFrmICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(caseDischargedAliveFrmICUBefore) + 1;
      caseDischargedAliveFrmICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(caseDischargedAliveFrmICUBefore, caseDischargedAliveFrmICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ICU death count increased to: "+ caseDischargedAliveFrmICUAfter);      
      }
      else
      {
        Log.Error("The element caseDischargedAliveFrmICU didn't increase: " + caseDischargedAliveFrmICUAfter);
        exestatus = false;
      }      
	  }
    
    //Verify Cases in ICU due to RRC   
    if (aqString.Compare(whichFieldToVerify, "numberOfICUDueToRRC", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfICUDueToRRCBefore = Data.getData(TestName,"OpReports","numberOfICUDueToRRC");
      
      //Get the latest data from the internet explorer
      var numberOfICUDueToRRCObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfICUDueToRRCObj != null)
      {
        var numberOfICUDueToRRCAfter = numberOfICUDueToRRCObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfICUDueToRRC was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfICUDueToRRCBefore) + 1;
      numberOfICUDueToRRCBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfICUDueToRRCBefore, numberOfICUDueToRRCAfter, false) == 0) 
      {
        Log.Checkpoint("Number of ICU death count increased to: "+ numberOfICUDueToRRCAfter);      
      }
      else
      {
        Log.Error("The element numberOfICUDueToRRC didn't increase: " + numberOfICUDueToRRCAfter);
        exestatus = false;
      }      
	  }
    
    //Verify after hours ICU discharges   
    if (aqString.Compare(whichFieldToVerify, "numberOfAfterHoursDschrg", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var numberOfAfterHoursDschrgBefore = Data.getData(TestName,"OpReports","numberOfAfterHoursDschrg");
      
      //Get the latest data from the internet explorer
      var numberOfAfterHoursDschrgObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfAfterHoursDschrgObj != null)
      {
        var numberOfAfterHoursDschrgAfter = numberOfAfterHoursDschrgObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfAfterHoursDschrg was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfAfterHoursDschrgBefore) + 1;
      numberOfAfterHoursDschrgBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfAfterHoursDschrgBefore, numberOfAfterHoursDschrgAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfAfterHoursDschrg increased to: "+ numberOfAfterHoursDschrgAfter);      
      }
      else
      {
        Log.Error("The element numberOfAfterHoursDschrg didn't increase: " + numberOfAfterHoursDschrgAfter);
        exestatus = false;
      }      
	  }
    
    //Verify free text medications   
    if (aqString.Compare(whichFieldToVerify, "freeTextMedicationUsage", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var freeTextMedicationUsageBefore = Data.getData(TestName,"OpReports","freeTextMedicationUsage");
      
      //Get the latest data from the internet explorer
      var arrayOfRows = page.EvaluateXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[2]/table[contains(@cols, '21')]/tbody/tr[*]");
      if(arrayOfRows != null)
      {
        var numberOfRows = arrayOfRows.length;
        exestatus = true;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(freeTextMedicationUsageBefore) + 1;
      freeTextMedicationUsageBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(freeTextMedicationUsageBefore, numberOfRows, false) == 0) 
      {
        Log.Checkpoint("Number of freeTextMedicationUsage increased to: "+ numberOfRows);      
      }
      else
      {
        Log.Error("The element freeTextMedicationUsage didn't increase: " + numberOfRows);
        exestatus = false;
      }      
	  }
    
    //Verify Known Allergy ADR Prescription Override   
    if (aqString.Compare(whichFieldToVerify, "KnownAllergyADRPrescriptionOverride", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      var KnownAllrgyADRPresOverrideBefore = Data.getData(TestName,"OpReports","KnownAllergyADRPrescriptionOverride");
      
      //Get the latest data from the internet explorer
      var arrayOfRows = page.EvaluateXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[2]/table[contains(@cols, '22')]/tbody/tr[*]");
      if(arrayOfRows != null)
      {
        var numberOfRows = arrayOfRows.length;
        exestatus = true;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(KnownAllrgyADRPresOverrideBefore) + 1;
      KnownAllrgyADRPresOverrideBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(KnownAllrgyADRPresOverrideBefore, numberOfRows, false) == 0) 
      {
        Log.Checkpoint("Number of KnownAllrgyADRPresOverride count increased to: "+ numberOfRows);
        Log.Message("Test passed for KnownAllrgyADRPresOverride count");      
      }
      else
      {
        Log.Error("The element KnownAllrgyADRPresOverride didn't increase: " + numberOfRows);
        exestatus = false;
      }      
	  }
    
    //Verify MRO in ICU   
    if (aqString.Compare(whichFieldToVerify, "MROinICU", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      
      var numberOfVREinICUBefore = Data.getData(TestName,"OpReports","numberOfVREinICU");
      
      //Get the latest data from the internet explorer
      var numberOfVREinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfVREinICUObj != null)
      {
        var numberOfVREinICUAfter = numberOfVREinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfVREinICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfVREinICUBefore) + 1;
      numberOfVREinICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfVREinICUBefore, numberOfVREinICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfVREinICU increased to: "+ numberOfVREinICUAfter);      
      }
      else
      {
        Log.Error("The element numberOfVREinICU didn't increase: " + numberOfVREinICUAfter);
        exestatus = false;
      }      
	  
    
      var numberOfMRSAinICUBefore = Data.getData(TestName,"OpReports","numberOfMRSAinICU");
      
      //Get the latest data from the internet explorer
      var numberOfMRSAinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfMRSAinICUObj != null)
      {
        var numberOfMRSAinICUAfter = numberOfMRSAinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfMRSAinICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfMRSAinICUBefore) + 1;
      numberOfMRSAinICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfMRSAinICUBefore, numberOfMRSAinICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfMRSAinICU increased to: "+ numberOfMRSAinICUAfter);      
      }
      else
      {
        Log.Error("The element numberOfMRSAinICU didn't increase: " + numberOfMRSAinICUAfter);
        exestatus = false;
      }      
	  
    
      var numberOfESBLinICUBefore = Data.getData(TestName,"OpReports","numberOfESBLinICU");
      
      //Get the latest data from the internet explorer
      var numberOfESBLinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfESBLinICUObj != null)
      {
        var numberOfESBLinICUAfter = numberOfESBLinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfESBLinICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfESBLinICUBefore) + 1;
      numberOfESBLinICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfESBLinICUBefore, numberOfESBLinICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfESBLinICU increased to: "+ numberOfESBLinICUAfter);      
      }
      else
      {
        Log.Error("The element numberOfESBLinICU didn't increase: " + numberOfESBLinICUAfter);
        exestatus = false;
      }      
	  
    
      var numberOfCREinICUBefore = Data.getData(TestName,"OpReports","numberOfVREinICU");
      
      //Get the latest data from the internet explorer
      var numberOfCREinICUObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCREinICUObj != null)
      {
        var numberOfCREinICUAfter = numberOfCREinICUObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCREinICU was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfCREinICUBefore) + 1;
      numberOfCREinICUBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfCREinICUBefore, numberOfCREinICUAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfCREinICU increased to: "+ numberOfCREinICUAfter);      
      }
      else
      {
        Log.Error("The element numberOfCREinICU didn't increase: " + numberOfCREinICUAfter);
        exestatus = false;
      }      
    } 
    
    //Verify MRO on Admission   
    if (aqString.Compare(whichFieldToVerify, "MROonAdmission", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      
      var numberOfVREonAdmissionBefore = Data.getData(TestName,"OpReports","numberOfVREonAdmission");
      
      //Get the latest data from the internet explorer
      var numberOfVREonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(numberOfVREonAdmissionObj != null)
      {
        var numberOfVREonAdmissionAfter = numberOfVREonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfVREonAdmission was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfVREonAdmissionBefore) + 1;
      numberOfVREonAdmissionBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfVREonAdmissionBefore, numberOfVREonAdmissionAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfVREonAdmission increased to: "+ numberOfVREonAdmissionAfter);      
      }
      else
      {
        Log.Error("The element numberOfVREonAdmission didn't increase: " + numberOfVREonAdmissionAfter);
        exestatus = false;
      }      
	  
    
      var numberOfMRSAonAdmissionBefore = Data.getData(TestName,"OpReports","numberOfMRSAonAdmission");
      
      //Get the latest data from the internet explorer
      var numberOfMRSAonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(numberOfMRSAonAdmissionObj != null)
      {
        var numberOfMRSAonAdmissionAfter = numberOfMRSAonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfMRSAonAdmission was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfMRSAonAdmissionBefore) + 1;
      numberOfMRSAonAdmissionBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfMRSAonAdmissionBefore, numberOfMRSAonAdmissionAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfMRSAonAdmission increased to: "+ numberOfMRSAonAdmissionAfter);      
      }
      else
      {
        Log.Error("The element numberOfMRSAonAdmission didn't increase: " + numberOfMRSAonAdmissionAfter);
        exestatus = false;
      }      
	  
    
      var numberOfESBLonAdmissionBefore = Data.getData(TestName,"OpReports","numberOfESBLonAdmission");
      
      //Get the latest data from the internet explorer
      var numberOfESBLonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(numberOfESBLonAdmissionObj != null)
      {
        var numberOfESBLonAdmissionAfter = numberOfESBLonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfESBLonAdmission was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfESBLonAdmissionBefore) + 1;
      numberOfESBLonAdmissionBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfESBLonAdmissionBefore, numberOfESBLonAdmissionAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfESBLonAdmission increased to: "+ numberOfESBLonAdmissionAfter);      
      }
      else
      {
        Log.Error("The element numberOfESBLonAdmission didn't increase: " + numberOfESBLonAdmissionAfter);
        exestatus = false;
      }      
	  
    
      var numberOfCREonAdmissionBefore = Data.getData(TestName,"OpReports","numberOfVREonAdmission");
      
      //Get the latest data from the internet explorer
      var numberOfCREonAdmissionObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(numberOfCREonAdmissionObj != null)
      {
        var numberOfCREonAdmissionAfter = numberOfCREonAdmissionObj.innerText;
      }
      else
      {
        Log.Error("The element numberOfCREonAdmission was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(numberOfCREonAdmissionBefore) + 1;
      numberOfCREonAdmissionBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(numberOfCREonAdmissionBefore, numberOfCREonAdmissionAfter, false) == 0) 
      {
        Log.Checkpoint("Number of numberOfCREonAdmission increased to: "+ numberOfCREonAdmissionAfter);      
      }
      else
      {
        Log.Error("The element numberOfCREonAdmission didn't increase: " + numberOfCREonAdmissionAfter);
        exestatus = false;
      }      
    }
    
    //Verify ICU Line Days   
    if (aqString.Compare(whichFieldToVerify, "ICULineDays", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);
      
      var cvcLineDaysBefore = Data.getData(TestName,"OpReports","cvcLineDays");
      
      //Get the latest data from the internet explorer
      var cvcLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[2]/div", true);
      if(cvcLineDaysObj != null)
      {
        var cvcLineDaysAfter = cvcLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element cvcLineDays was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(cvcLineDaysBefore) + 1;
      cvcLineDaysBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(cvcLineDaysBefore, cvcLineDaysAfter, false) == 0) 
      {
        Log.Checkpoint("Number of cvcLineDays increased to: "+ cvcLineDaysAfter);      
      }
      else
      {
        Log.Error("The element cvcLineDays didn't increase: " + cvcLineDaysAfter);
        exestatus = false;
      }      
	  
    
      var piccLineDaysBefore = Data.getData(TestName,"OpReports","piccLineDays");
      
      //Get the latest data from the internet explorer
      var piccLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[3]/div", true);
      if(piccLineDaysObj != null)
      {
        var piccLineDaysAfter = piccLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element piccLineDays was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(piccLineDaysBefore) + 1;
      piccLineDaysBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(piccLineDaysBefore, piccLineDaysAfter, false) == 0) 
      {
        Log.Checkpoint("Number of piccLineDays increased to: "+ piccLineDaysAfter);      
      }
      else
      {
        Log.Error("The element piccLineDays didn't increase: " + piccLineDaysAfter);
        exestatus = false;
      }      
	  
    
      var vascathLineDaysBefore = Data.getData(TestName,"OpReports","vascathLineDays");
      
      //Get the latest data from the internet explorer
      var vascathLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[4]/div", true);
      if(vascathLineDaysObj != null)
      {
        var vascathLineDaysAfter = vascathLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element vascathLineDays was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(vascathLineDaysBefore) + 1;
      vascathLineDaysBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(vascathLineDaysBefore, vascathLineDaysAfter, false) == 0) 
      {
        Log.Checkpoint("Number of vascathLineDays increased to: "+ vascathLineDaysAfter);      
      }
      else
      {
        Log.Error("The element vascathLineDays didn't increase: " + vascathLineDaysAfter);
        exestatus = false;
      }      
	  
    
      var centralLineDaysBefore = Data.getData(TestName,"OpReports","centralLineDays");
      
      //Get the latest data from the internet explorer
      var centralLineDaysObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[5]/div", true);
      if(centralLineDaysObj != null)
      {
        var centralLineDaysAfter = centralLineDaysObj.innerText;
      }
      else
      {
        Log.Error("The element centralLineDays was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(centralLineDaysBefore) + 1;
      centralLineDaysBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(centralLineDaysBefore, centralLineDaysAfter, false) == 0) 
      {
        Log.Checkpoint("Number of centralLineDays increased to: "+ centralLineDaysAfter);      
      }
      else
      {
        Log.Error("The element centralLineDays didn't increase: " + centralLineDaysAfter);
        exestatus = false;
      }      
    }
    
    //Verify Mechanically Ventilated Patients   
    if (aqString.Compare(whichFieldToVerify, "MechanicallyVentilatedPatients", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);      
      
      //Invasive
      var invasiveBefore = Data.getData(TestName,"OpReports","invasive");
      
      var invasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[3]/div", true);
      if(invasiveObj != null)
      {
        var invasiveAfter = invasiveObj.innerText;
      }
      else
      {
        Log.Error("The element invasive was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      //var count = aqConvert.StrToInt(invasiveBefore) + 1;
      //invasiveBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(invasiveBefore, invasiveAfter, false) == 0) 
      {
        Log.Checkpoint("Number of invasive increased to: "+ invasiveAfter);      
      }
      else
      {
        Log.Error("The element invasive didn't increase: " + invasiveAfter);
        exestatus = false;
      }  
      
      //Non-Invasive
      var nonInvasiveBefore = Data.getData(TestName,"OpReports","nonInvasive");
      
      var nonInvasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[4]/div", true);
      if(nonInvasiveObj != null)
      {
        var nonInvasiveAfter = nonInvasiveObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasive was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      //var count = aqConvert.StrToInt(invasiveBefore) + 1;
      //invasiveBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(nonInvasiveBefore, nonInvasiveAfter, false) == 0) 
      {
        Log.Checkpoint("Number of nonInvasive increased to: "+ nonInvasiveAfter);      
      }
      else
      {
        Log.Error("The element nonInvasive didn't increase: " + nonInvasiveAfter);
        exestatus = false;
      }
      
      //Both Invasive and non invasive
      var bothInvNonInvBefore = Data.getData(TestName,"OpReports","bothInvNonInv");
      
      var bothInvNonInvObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[5]/div", true);
      if(bothInvNonInvObj != null)
      {
        var bothInvNonInvAfter = bothInvNonInvObj.innerText;
      }
      else
      {
        Log.Error("The element bothInvNonInv was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(bothInvNonInvBefore) + 1;
      bothInvNonInvBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(bothInvNonInvBefore, bothInvNonInvAfter, false) == 0) 
      {
        Log.Checkpoint("Number of bothInvNonInv increased to: "+ bothInvNonInvAfter);      
      }
      else
      {
        Log.Error("The element bothInvNonInv didn't increase: " + bothInvNonInvAfter);
        exestatus = false;
      }    
	  }
    
    //Verify Mechanical Ventilation Hours
    if (aqString.Compare(whichFieldToVerify, "MechanicalVentillationHours", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);      
      
      //Invasive
      var invasiveBefore = Data.getData(TestName,"OpReports","invasive");
      
      var invasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[3]/div", true);
      if(invasiveObj != null)
      {
        var invasiveAfter = invasiveObj.innerText;
      }
      else
      {
        Log.Error("The element invasive was not found.");
        exestatus = false;
      }
      
      if (invasiveBefore < invasiveAfter) 
      {
        Log.Checkpoint("Number of invasive increased to: "+ invasiveAfter);      
      }
      else
      {
        Log.Error("The element invasive didn't increase: " + invasiveAfter);
        exestatus = false;
      }  
      
      //Non-Invasive
      var nonInvasiveBefore = Data.getData(TestName,"OpReports","nonInvasive");
      
      var nonInvasiveObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[4]/div", true);
      if(nonInvasiveObj != null)
      {
        var nonInvasiveAfter = nonInvasiveObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasive was not found.");
        exestatus = false;
      }
      
      if (nonInvasiveBefore < nonInvasiveAfter) 
      {
        Log.Checkpoint("Number of nonInvasive increased to: "+ nonInvasiveAfter);      
      }
      else
      {
        Log.Error("The element nonInvasive didn't increase: " + nonInvasiveAfter);
        exestatus = false;
      }
      
      //High Flow
      var highFlowBefore = Data.getData(TestName,"OpReports","highFlow");
      
      var highFlowObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[4]/td[5]/div", true);
      if(highFlowObj != null)
      {
        var highFlowAfter = highFlowObj.innerText;
      }
      else
      {
        Log.Error("The element highFlow was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      if (highFlowBefore < highFlowAfter) 
      {
        Log.Checkpoint("Number of highFlow increased to: "+ highFlowAfter);      
      }
      else
      {
        Log.Error("The element highFlow didn't increase: " + highFlowAfter);
        exestatus = false;
      }
      
      //Invasive percent
      var invasivePercntBefore = Data.getData(TestName,"OpReports","invasivePercnt");
      
      var invasivePercntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[3]/div", true);
      if(invasivePercntObj != null)
      {
        var invasivePercntAfter = invasivePercntObj.innerText;
      }
      else
      {
        Log.Error("The element invasivePercnt was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      invasivePercntBefore = invasivePercntBefore.split('%')[0];
      invasivePercntAfter = invasivePercntAfter.split('%')[0];
      
      if (invasivePercntBefore < invasivePercntAfter) 
      {
        Log.Checkpoint("Number of invasivePercnt increased to: "+ invasivePercntAfter);      
      }
      else
      {
        Log.Error("The element invasivePercnt didn't increase: " + invasivePercntAfter);
        exestatus = false;
      }
      
      //nonInvasivePrcnt
      var nonInvasivePrcntBefore = Data.getData(TestName,"OpReports","nonInvasivePrcnt");
      
      var nonInvasivePrcntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[4]/div", true);
      if(nonInvasivePrcntObj != null)
      {
        var nonInvasivePrcntAfter = nonInvasivePrcntObj.innerText;
      }
      else
      {
        Log.Error("The element nonInvasivePrcnt was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      nonInvasivePrcntBefore = nonInvasivePrcntBefore.split('%')[0];
      nonInvasivePrcntAfter = nonInvasivePrcntAfter.split('%')[0];
      
      if (nonInvasivePrcntBefore < nonInvasivePrcntAfter) 
      {
        Log.Checkpoint("Number of nonInvasivePrcnt increased to: "+ nonInvasivePrcntAfter);      
      }
      else
      {
        Log.Error("The element nonInvasivePrcnt didn't increase: " + nonInvasivePrcntAfter);
        exestatus = false;
      }
      
      //highFlowPrcnt
      var highFlowPrcntBefore = Data.getData(TestName,"OpReports","highFlowPrcnt");
      
      var highFlowPrcntObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[6]/td[5]/div", true);
      if(highFlowPrcntObj != null)
      {
        var highFlowPrcntAfter = highFlowPrcntObj.innerText;
      }
      else
      {
        Log.Error("The element highFlowPrcnt was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      highFlowPrcntBefore = highFlowPrcntBefore.split('%')[0];
      highFlowPrcntAfter = highFlowPrcntAfter.split('%')[0];
      
      if (highFlowPrcntBefore < highFlowPrcntAfter) 
      {
        Log.Checkpoint("Number of highFlowPrcnt increased to: "+ highFlowPrcntAfter);      
      }
      else
      {
        Log.Error("The element highFlowPrcnt didn't increase: " + highFlowPrcntAfter);
        exestatus = false;
      }          
	  }
    
    //Verify Reason for Intubation
    if (aqString.Compare(whichFieldToVerify, "ReasonOfIntubation", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);      
      
      //unplannedExtubations
      var unplannedExtubationsBefore = Data.getData(TestName,"OpReports","unplannedExtubations");
      
      var unplannedExtubationsObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(unplannedExtubationsObj != null)
      {
        var unplannedExtubationsAfter = unplannedExtubationsObj.innerText;
      }
      else
      {
        Log.Error("The element unplannedExtubations was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(unplannedExtubationsBefore) + 1;
      unplannedExtubationsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(unplannedExtubationsBefore, unplannedExtubationsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of unplannedExtubations increased to: "+ unplannedExtubationsAfter);      
      }
      else
      {
        Log.Error("The element unplannedExtubations didn't increase: " + unplannedExtubationsAfter);
        exestatus = false;
      }  
      
      //failedExtubations
      var failedExtubationsBefore = Data.getData(TestName,"OpReports","failedExtubations");
      
      var failedExtubationsObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[4]/td[3]/div", true);
      if(failedExtubationsObj != null)
      {
        var failedExtubationsAfter = failedExtubationsObj.innerText;
      }
      else
      {
        Log.Error("The element failedExtubations was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(failedExtubationsBefore) + 1;
      failedExtubationsBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(failedExtubationsBefore, failedExtubationsAfter, false) == 0) 
      {
        Log.Checkpoint("Number of failedExtubations increased to: "+ failedExtubationsAfter);      
      }
      else
      {
        Log.Error("The element failedExtubations didn't increase: " + failedExtubationsAfter);
        exestatus = false;
      }
      
      //failedNIV
      var failedNIVBefore = Data.getData(TestName,"OpReports","failedNIV");
      
      var failedNIVObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[5]/td[3]/div", true);
      if(failedNIVObj != null)
      {
        var failedNIVAfter = failedNIVObj.innerText;
      }
      else
      {
        Log.Error("The element failedNIV was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(failedNIVBefore) + 1;
      failedNIVBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(failedNIVBefore, failedNIVAfter, false) == 0) 
      {
        Log.Checkpoint("Number of failedNIV increased to: "+ failedNIVAfter);      
      }
      else
      {
        Log.Error("The element failedNIV didn't increase: " + failedNIVAfter);
        exestatus = false;
      }
      
      //intubationsCount
      var intubationsCountBefore = Data.getData(TestName,"OpReports","intubationsCount");
      
      var intubationsCountObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[6]/td[3]/div", true);
      if(intubationsCountObj != null)
      {
        var intubationsCountAfter = intubationsCountObj.innerText;
      }
      else
      {
        Log.Error("The element intubationsCount was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(intubationsCountBefore) + 1;
      intubationsCountBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(intubationsCountBefore, intubationsCountAfter, false) == 0) 
      {
        Log.Checkpoint("Number of intubationsCount increased to: "+ intubationsCountAfter);      
      }
      else
      {
        Log.Error("The element intubationsCount didn't increase: " + intubationsCountAfter);
        exestatus = false;
      }                
	  }
    
    //Renal Replacement Therapy
    if (aqString.Compare(whichFieldToVerify, "RenalReplacmentTherapy", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);      
      
      //rrtCount
      var rrtCountBefore = Data.getData(TestName,"OpReports","rrtCount");
      
      var rrtCountObj = page.FindChildByXPath("//table[contains(@cols, '7')]/tbody/tr[7]/td[3]/table[contains(@cols, '3')]/tbody/tr[3]/td[3]/div", true);
      if(rrtCountObj != null)
      {
        var rrtCountAfter = rrtCountObj.innerText;
      }
      else
      {
        Log.Error("The element rrtCount was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(rrtCountBefore) + 1;
      rrtCountBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(rrtCountBefore, rrtCountAfter, false) == 0) 
      {
        Log.Checkpoint("Number of rrtCount increased to: "+ rrtCountAfter);      
      }
      else
      {
        Log.Error("The element rrtCount didn't increase: " + rrtCountAfter);
        exestatus = false;
      }
    }
    
    //Number of Tracheostomies
    if (aqString.Compare(whichFieldToVerify, "Tracheostomies", false) == 0) 
    {
		  Log.Checkpoint("Validation for the "+ whichFieldToVerify);      
      
      //surgical Tracheostomies
      var surgicalTracheostomiesBefore = Data.getData(TestName,"OpReports","surgicalTracheostomies");
      
      var surgicalTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[3]/div", true);
      if(surgicalTracheostomiesObj != null)
      {
        var surgicalTracheostomiesAfter = surgicalTracheostomiesObj.innerText;
      }
      else
      {
        Log.Error("The element surgicalTracheostomies was not found.");
        exestatus = false;
      }
      
      //Compare both the values
      var count = aqConvert.StrToInt(surgicalTracheostomiesBefore) + 1;
      surgicalTracheostomiesBefore = aqConvert.VarToStr(count);
      
      if (aqString.Compare(surgicalTracheostomiesBefore, surgicalTracheostomiesAfter, false) == 0) 
      {
        Log.Checkpoint("Number of surgicalTracheostomies increased to: "+ surgicalTracheostomiesAfter);      
      }
      else
      {
        Log.Error("The element surgicalTracheostomies didn't increase: " + surgicalTracheostomiesAfter);
        exestatus = false;
      }
        
    //dilation Tracheostomies
    var dilationTracheostomiesBefore = Data.getData(TestName,"OpReports","dilationTracheostomies");
      
    var dilationTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[4]/div", true);
    if(dilationTracheostomiesObj != null)
    {
      var dilationTracheostomiesAfter = dilationTracheostomiesObj.innerText;
    }
    else
    {
      Log.Error("The element dilationTracheostomies was not found.");
      exestatus = false;
    }
      
    //Compare both the values
    var count = aqConvert.StrToInt(dilationTracheostomiesBefore) + 1;
    dilationTracheostomiesBefore = aqConvert.VarToStr(count);
      
    if (aqString.Compare(dilationTracheostomiesBefore, dilationTracheostomiesAfter, false) == 0) 
    {
      Log.Checkpoint("Number of dilationTracheostomies increased to: "+ dilationTracheostomiesAfter);      
    }
    else
    {
      Log.Error("The element dilationTracheostomies didn't increase: " + dilationTracheostomiesAfter);
      exestatus = false;
    }
    
    //limited Dissection Tracheostomies
    var limitedDissectionTracheostomiesBefore = Data.getData(TestName,"OpReports","limitedDissectionTracheostomies");
      
    var limitedDissectionTracheostomiesObj = page.FindChildByXPath("//table[contains(@cols, '6')]/tbody/tr[7]/td[3]/table[contains(@cols, '5')]/tbody/tr[5]/td[5]/div", true);
    if(limitedDissectionTracheostomiesObj != null)
    {
      var limitedDissectionTracheostomiesAfter = limitedDissectionTracheostomiesObj.innerText;
    }
    else
    {
      Log.Error("The element limitedDissectionTracheostomies was not found.");
      exestatus = false;
    }
      
    //Compare both the values
    var count = aqConvert.StrToInt(limitedDissectionTracheostomiesBefore) + 1;
    limitedDissectionTracheostomiesBefore = aqConvert.VarToStr(count);
      
    if (aqString.Compare(limitedDissectionTracheostomiesBefore, limitedDissectionTracheostomiesAfter, false) == 0) 
    {
      Log.Checkpoint("Number of limitedDissectionTracheostomies increased to: "+ limitedDissectionTracheostomiesAfter);      
    }
    else
    {
      Log.Error("The element limitedDissectionTracheostomies didn't increase: " + limitedDissectionTracheostomiesAfter);
      exestatus = false;
    }
   }
 
  }
  return exestatus;  
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvChangeTypeOfAdmission
// Desc :Feature to change the type of care on admission
// Owner :Mohammad Zeeshan
// Creation date:28/05/2019
// Update By :
// Update date:
// Update desc: 

//******************************************************************************************//
//******************************************************************************************// 

function MvChangeTypeOfAdmission(TestName, typeOfCare, exestatus)
{
 
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    //var objData = Data.getData(TestName,"MedicalCare");
    var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
    Log.Checkpoint("Start admission summary documentation for "+tcDesc ,"The flow is started");
	
  
    //Start of the feature 
  	 vProcess = Sys.Process("iMDSoft.Metavision");

	 
  
  	/*exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  	// Wait for screen to appear
    exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus); */ 
        
    // ** Fill in the details for Admission Summary **
    Log.Message("*** change admitted department ***");
	
    //Open the last saved session to modify the type of care only
    Log.Message(exestatus);
    exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
    //var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 

    //Click allergy button and close it
    var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
    if (AllergyButton.VisibleOnScreen)
    {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
     exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }
  
    //Goto the ANZICS tab and change the type of care on admission 
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);
  
    //Change the type of care now
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",typeOfCare,exestatus);
  
    //Save and close the form
    // **Get the save time value**
  	//var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
  	//timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
  	//timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  	//Log.Checkpoint("Admission Summary Saved Time: "+ timeSavedValue);
    
    //Get the form saved time and date
     aqUtils.Delay(10000);
    //exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"sessionscontrol\")", 120,exestatus); 
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
    //var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  
    // Save the form data
    exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"cmdSave\")",exestatus);
   
    //To proceed with windowspopup 
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
    //************Verify the saved value for type of care**********      
  	//Validation part open form again
    Log.Message(exestatus);
    exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
    //var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
    //if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
    //{
      //Log.Checkpoint("Time and date are matching");
    //}
   // else
    //{
      //Log.Error("time and date are not matched");
      //exestatus = false;
    //}
  
    //Validation of documented values 
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);  
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);  
    exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",typeOfCare,"CareType",exestatus); 
  
  
    // To handle allergy pop  
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 1))",exestatus);
    var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
    if (AllergyButton.VisibleOnScreen)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
      exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }
   
     // close the form   
  	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
    // To proceed with pop up
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
    // Handling the allergies system error pop up
    aqUtils.Delay(10000);
    var MsgForm = vProcess.Find("Name", "Window(\"#32770\",\"Error\", 1)", 1000);
    if (MsgForm.Exists)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\",1)",exestatus);
    }
  
    if (equal(exestatus,true)) 
    {
  	 	  Log.Checkpoint("Successfully changed type of care");
        Log.Checkpoint("End of change of type of care in the admission summary","The flow is completed");
    }
    else 
    {
      Log.Message("Skipped admission summary documentation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
    }
  }
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvChangeSourceAndTypeOfAdmission
// Desc :Feature to change source of admission and type of care on admission
// Owner :Mohammad Zeeshan
// Creation date:26/06/2019
// Update By :
// Update date:
// Update desc: 

//******************************************************************************************//
//******************************************************************************************// 

function MvChangeSourceAndTypeOfAdmission(TestName, sourceOfAdmission, typeOfCare, exestatus)
{
 
  //Controller for executing or skipping the feature
  if (equal(exestatus,true)) 
  {
    //var objData = Data.getData(TestName,"MedicalCare");
    var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
    Log.Checkpoint("Start admission summary documentation for "+tcDesc ,"The flow is started");
	
  
    //Start of the feature 
  	 vProcess = Sys.Process("iMDSoft.Metavision");

	 
  
  	/*exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  	// Wait for screen to appear
    exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"cboTextCombo_1\")", 120,exestatus); */ 
        
    // ** Fill in the details for Admission Summary **
    Log.Message("*** change admitted department ***");
	
    //Open the last saved session to modify the type of care only
    Log.Message(exestatus);
    exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
    //var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 

    //Click allergy button and close it
    var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
    if (AllergyButton.VisibleOnScreen)
    {
     exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
     exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }
  
    //Goto the ANZICS tab and change the type of care on admission 
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);
  
    //Change the source of admission here
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_9\")",sourceOfAdmission,exestatus);
    
    //Change the type of care now
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_11\")",typeOfCare,exestatus);
  
    //Save and close the form
    // **Get the save time value**
  	//var timeSavedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"mvtFormTime\")", "Value",exestatus); 
  	//timeSavedValue = aqString.Replace(timeSavedValue, ":00", "", false);
  	//timeSavedValue = aqString.Replace(timeSavedValue, "0", "", false);
  	//Log.Checkpoint("Admission Summary Saved Time: "+ timeSavedValue);
    
    //Get the form saved time and date
     aqUtils.Delay(10000);
    //exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"sessionscontrol\")", 120,exestatus); 
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
    //var savedTimevalue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus);
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);
  
    // Save the form data
    exestatus = mvObjects.buttonClick(vProcess, "Name","WPFObject(\"cmdSave\")",exestatus);
   
    //To proceed with windowspopup 
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
    //************Verify the saved value for type of care**********      
  	//Validation part open form again
    Log.Message(exestatus);
    exestatus = mvObjects.selectMenuOption(exestatus,"Medical", "Admission Summary");
  
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus); 
    //var timedocumentedValue = mvObjects.getObjectProperty(vProcess, "Name", "WPFObject(\"TextEdit\", \"\", 1)", "Text",exestatus); 
  
    //if(aqString.Compare(savedTimevalue,timedocumentedValue,false) ==0)
    //{
      //Log.Checkpoint("Time and date are matching");
    //}
   // else
    //{
      //Log.Error("time and date are not matched");
      //exestatus = false;
    //}
  
    //Validation of documented values 
    //exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"sessionscontrol\")",exestatus);  
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 4))",exestatus);  
    exestatus = mvObjects.verifyObjectProperty(vProcess, "Name", "WPFObject(\"cboTextCombo_11\")", "Text",typeOfCare,"CareType",exestatus); 
  
  
    // To handle allergy pop  
    exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"DXTabItem\", \"\", 1))",exestatus);
    var AllergyButton = vProcess.Find("Name", "WPFObject(\"cmdAction_4\")", 1000);
    if (AllergyButton.VisibleOnScreen)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdAction_4\")",exestatus);
      exestatus = mvObjects.buttonClick(vProcess, "WndCaption", "&Close",exestatus);
    }
   
     // close the form   
  	exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);
    // To proceed with pop up
    var MsgForm = vProcess.Find("Name", "WinFormsObject(\"ImdFormBase\")", 1000);
    if (MsgForm.Exists)
    {    
      exestatus = mvObjects.buttonClick(vProcess, "Name", "WinFormsObject(\"Yes\")",exestatus);
    }
  
    // Handling the allergies system error pop up
    aqUtils.Delay(10000);
    var MsgForm = vProcess.Find("Name", "Window(\"#32770\",\"Error\", 1)", 1000);
    if (MsgForm.Exists)
    {
      exestatus = mvObjects.buttonClick(vProcess, "Name", "Window(\"Button\",\"OK\",1)",exestatus);
    }
  
    if (equal(exestatus,true)) 
    {
  	 	  Log.Checkpoint("Successfully changed type of care");
        Log.Checkpoint("End of change of type of care in the admission summary","The flow is completed");
    }
    else 
    {
      Log.Message("Skipped admission summary documentation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
    }
  }
  return exestatus;
}

//Enter Renal Replacement Therapies
function MvRRTSelect(TestName, RRTtype,exestatus)
{
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) 
    {
        //var objData = Data.getData(TestName,"MedicalCare");
        var tcDesc = Data.getData(TestName,"Navigation","TC_DESC");
        Log.Checkpoint("Start Endotracheal Tube documentation for "+tcDesc ,"The flow is started");
        
        //Start of the feature 
        vProcess = Sys.Process("iMDSoft.Metavision");
        
        // Select the RRT tab   
        exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
       	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
        // Wait for sometime before initiating
        aqUtils.Delay(5000);
        
        //Click the RRT type selection drop down and select the desired value        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemHd", false) == 0)
        {
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemHd.Click(39, 18);        
        } 
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemCvvhdf", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemCvvhdf.Click(39, 18);        
        }  
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemCvvhd", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemCvvhd.Click(39, 18);        
        }
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemCvvh", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemCvvh.Click(39, 18);        
        }
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemScuf", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemScuf.Click(39, 18);        
        }
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemTpe", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemTpe.Click(39, 18);        
        }
        
        if (aqString.Compare(RRTtype, "ImdcomboboxitemHp", false) == 0)
        {
            // Goto Clinical Overview   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 1)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 1)",exestatus);  
        
            // Select the RRT tab   
            exestatus = mvObjects.waitForObject(vProcess,"WPFObject(\"TabItem\", \"\", 8)",120,exestatus);
           	exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 8)",exestatus);
        
            var iMDSoft_Metavision;
            iMDSoft_Metavision = Aliases.iMDSoft_Metavision;
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            iMDSoft_Metavision.HwndSource_root.root.FloatingDockPanel.Grid.Items.ContentControl.Grid.Items.ContentControl2.tChartConcrol.Click(317, 26);
            aqUtils.Delay(1000);
            iMDSoft_Metavision.HwndSource_PopupRoot.PopupRoot.ImdcomboboxitemHp.Click(39, 18);        
        }
     }
     return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvExtractInitialOpReports
// Desc :This function launches generates the Summary from eRIC  
// Owner :Mohammad Zeeshan
// Creation date: 20 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvExitBlockFromICUOR(TestName, exestatus)
{
  return exestatus;
}

//******************************************************************************************//
//******************************************************************************************//
// Name :MvTracheostomyTube
// Desc :This function launches generates the Tracheostomies Operational report from eRIC  
// Owner :Mohammad Zeeshan
// Creation date: 30 May 2019
// Update By : 
// Update date:
// Update desc:
//******************************************************************************************//
//******************************************************************************************//
function MvTracheostomyTube(TestName, TypeOfTracheostomy, exestatus)
{
 
    //Controller for executing or skipping the feature
    if (equal(exestatus,true)) {

    //var objData = Data.getData(TestName,"MedicalCare");
    var tcDesc = Data.getData(TestName,"MedicalCare","TC_DESC");
    Log.Checkpoint("Start Endotracheal Tube documentation for "+tcDesc ,"The flow is started");
    //Start of the feature 
 
 
    vProcess = Sys.Process("iMDSoft.Metavision");

      // Patient Details and defaults
     //var ms = 6000;
        //var HelpStr = "Delaying test run for " + ms + " milliseconds, To add family meeting note.";
        //aqUtils.Delay (ms, HelpStr);
  
    exestatus = mvObjects.selectMenuOption(exestatus,"Nursing", "Input / Output Devices and Observations","Tubes","Airway",TypeOfTracheostomy);
    // Wait for screen to appear

    exestatus = mvObjects.waitForObjectProperty(vProcess, "WPFObject(\"Button\", \"Initiate\", 1)","IsEnabled",true, 120,exestatus);
    exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"Button\", \"\", 1)", 120,exestatus);  
    //exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"\", 1)",exestatus);    
     Sys.Process("iMDSoft.Metavision").WPFObject("HwndSource: ImdGenericWindow", "").WPFObject("ImdGenericWindow", "", 1).WPFObject("Border", "", 1).WPFObject("Border", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("OrphanDoseEntryView", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutControl", "", 2).WPFObject("Buttom_Group").WPFObject("LayoutItem", "", 1).WPFObject("ContentControl", "", 1).WPFObject("AttachedFormsView", "", 1).WPFObject("Grid", "", 1).WPFObject("ScrollableToolBar", "", 1).WPFObject("ContentPresenter", "", 1).WPFObject("Button", "", 1).Click();   
    // ** Fill in the details for Tracheostomy Tube **
    Log.Message("*** enter details for Tracheostomy Tube ***");
 
    var ETTType = Data.getData(TestName,"MedicalCare","ETTType");
    var ETTSize  = Data.getData(TestName,"MedicalCare","ETTSize");
    var CuffPressure = Data.getData(TestName,"MedicalCare","CuffPressure");
    //var ETTPositionatTeeth = Data.getData(TestName,"MedicalCare","ETTPositionatTeeth");


    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",ETTType,exestatus);  
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_2\")",ETTSize,exestatus);
    exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",CuffPressure,exestatus);
    //exestatus = mvObjects.enterEditText(vProcess, "WPFObject(\"txtNumeric_3\")",ETTPositionatTeeth,exestatus);

    // Save the form data
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

    // Wait for sometime before initiating
    aqUtils.Delay(5000);
    exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"Button\", \"Initiate\", 1)",exestatus);
    exestatus = mvObjects.waitForObject(vProcess, "WPFObject(\"picFrameIn_1\")", 120,exestatus);



    var Airway = Data.getData(TestName,"MedicalCare","Airway");
    var LarynxGrade = Data.getData(TestName,"MedicalCare","LarynxGrade");
    var FailedExtubation = Data.getData(TestName,"MedicalCare","FailedExtubation");
    var FailedNIV = Data.getData(TestName,"MedicalCare","FailedNIV");
    var InsertionFailure = Data.getData(TestName,"MedicalCare","InsertionFailure");
    var Malposition = Data.getData(TestName,"MedicalCare","Malposition");
    var PositionConfirmed = Data.getData(TestName,"MedicalCare","PositionConfirmed");

    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_1\")",Airway,exestatus);
    exestatus = mvObjects.selectComboItem(vProcess,"WPFObject(\"cboTextCombo_2\")",LarynxGrade,exestatus);
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_4\")",FailedExtubation,exestatus);
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_5\")",FailedNIV,exestatus);
    exestatus = mvObjects.waitForObject (vProcess, "WPFObject(\"chkTrue_1\")", 120,exestatus);
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_1\")",InsertionFailure,exestatus);
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_2\")",Malposition,exestatus);
    exestatus = mvObjects.enterEditText(vProcess,"WPFObject(\"chkTrue_3\")",PositionConfirmed,exestatus);

// Save the form data
   exestatus = mvObjects.buttonClick(vProcess, "Name", "WPFObject(\"cmdSave\")",exestatus);

       
   // Validation of data in input and output tab
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"TabItem\", \"\", 6)",exestatus);
   exestatus = mvObjects.buttonClick(vProcess,"Name","WPFObject(\"btnMoveToCurrentTime\")",exestatus);
   
   
    //var objData = Data.getData(TestName,"Patient");
  //var newPatientMRN = objData("MRN").Value;

  
  if (equal(exestatus,true)) {
 Log.Checkpoint(" successfully initiated Endotracheal Tube");
      Log.Checkpoint("End Endotracheal Tube","The flow is completed");
    }
  }
  else {
  Log.Message("Skipped Endotracheal Tube initiation","The feature is skipped since the execution status is set as '"+exestatus+"'"); 
  
  }
  return exestatus;
    
}

module.exports.MvPrescribePRNmeds = MvPrescribePRNmeds;
module.exports.MVANZICSDetails = MVANZICSDetails;
module.exports.ComparePDFAsImg = ComparePDFAsImg;
module.exports.MvLogin = MvLogin;
module.exports.MvLogout = MvLogout;
module.exports.MvPatientRegister = MvPatientRegister;
module.exports.MvPatientDemographics = MvPatientDemographics;
module.exports.MvChangePatientStatus = MvChangePatientStatus;
module.exports.MvPatientBelongings = MvPatientBelongings;
module.exports.MvWorklist = MvWorklist;
module.exports.MvSearchPatient = MvSearchPatient;
module.exports.MVFamilyMeetingNote = MVFamilyMeetingNote;
module.exports.MvGuardianshiporder = MvGuardianshiporder;
module.exports.MvMotorVehicleAccidentNote = MvMotorVehicleAccidentNote;
module.exports.MvReferralConsultationForm = MvReferralConsultationForm;
module.exports.MvprescribeMedication = MvprescribeMedication;
module.exports.MvUpdateProblemList = MvUpdateProblemList;
module.exports.MvEndotrachealTube = MvEndotrachealTube;
module.exports.MvOrogastricTube = MvOrogastricTube;
module.exports.MvAllergies = MvAllergies;
module.exports.MVRadiology = MVRadiology;
module.exports.MVPolicies = MVPolicies;
module.exports.MVWounds = MVWounds;
module.exports.MVeNIMC = MVeNIMC;
module.exports.MVMedicationReview = MVMedicationReview;
module.exports.MVResolveMedication = MVResolveMedication;
module.exports.MvReviewBurnDepthDescription = MvReviewBurnDepthDescription;
module.exports.MvWeightsandDimensions = MvWeightsandDimensions;
module.exports.MvWeightsPopulates = MvWeightsPopulates;
module.exports.MvMedicationAdministrationRecord = MvMedicationAdministrationRecord;
module.exports.MvprescribeIntravenous = MvprescribeIntravenous;
module.exports.MvprescribeIntramuscular = MvprescribeIntramuscular;
module.exports.MvEnterFreeTextMedication = MvEnterFreeTextMedication;
module.exports.MvPrescribeIntravenousBolus = MvPrescribeIntravenousBolus;
module.exports.MvPrescribeMedicationGreater = MvPrescribeMedicationGreater;
module.exports.MvBurnsOnAdmission = MvBurnsOnAdmission;
module.exports.MvAutomaticallyMatch = MvAutomaticallyMatch;
module.exports.MvAutomaticallyCalculateDose = MvAutomaticallyCalculateDose;
module.exports.MvReviewFluidBalance = MvReviewFluidBalance;
module.exports.MvOrderMultipleMedications = MvOrderMultipleMedications;
module.exports.MvReviewPatientSepsis = MvReviewPatientSepsis;
module.exports.MvReviewPatientBGL = MvReviewPatientBGL;
module.exports.MvReviewPatientWounds = MvReviewPatientWounds;
module.exports.MVClinicalProcedureSafetyChecklist = MVClinicalProcedureSafetyChecklist;
module.exports.MvPericardialDrain= MvPericardialDrain;
module.exports.MvNasoduodenalTube = MvNasoduodenalTube;
module.exports.MvRenalReplacementTherapies = MvRenalReplacementTherapies;
module.exports.MvOtherDrain = MvOtherDrain;
module.exports.MvAdmissionSummary = MvAdmissionSummary;
module.exports.MvDefaultCurrentTime = MvDefaultCurrentTime;
module.exports.MvCeaseMedications = MvCeaseMedications;
module.exports.MvOrderMedicationsNutrition = MvOrderMedicationsNutrition; 
module.exports.MvDiscontinueMedication = MvDiscontinueMedication;
module.exports.MvOverrideNonAdministration = MvOverrideNonAdministration;
module.exports.MvReviewMetabolicTab = MvReviewMetabolicTab;
module.exports.MvReviewMedicationTimeline = MvReviewMedicationTimeline;
module.exports.MvOverRideAlleryReason = MvOverRideAlleryReason;
module.exports.MVPhysicalRestraints = MVPhysicalRestraints;
module.exports.MvBolusToolTip = MvBolusToolTip;
module.exports.MvMedicationChart = MvMedicationChart;
module.exports.MvNoteOnMedicationOrder = MvNoteOnMedicationOrder;
module.exports.MvAdministerMedication = MvAdministerMedication;
module.exports.MvTrackChangesMedicationOrder = MvTrackChangesMedicationOrder;
module.exports.MvPrescribeWarfarin = MvPrescribeWarfarin;
module.exports.MvPrescribeTPN = MvPrescribeTPN;
module.exports.MvPrescribeTopicalPatch = MvPrescribeTopicalPatch;

module.exports.MvPrescribeIntravenousInfusion = MvPrescribeIntravenousInfusion;
module.exports.MvPrescribeModifiedRelease = MvPrescribeModifiedRelease;
module.exports.MvPrescribeProductOpposed = MvPrescribeProductOpposed;
module.exports.MvOrderingPRNDisplay = MvOrderingPRNDisplay;
module.exports.MvOrderingPRNIndication = MvOrderingPRNIndication;
module.exports.MvDetectGenericDrugName = MvDetectGenericDrugName;
module.exports.MvDisplayGenericDrugName = MvDisplayGenericDrugName;
module.exports.MvBSAAutomaticallyCalculated = MvBSAAutomaticallyCalculated;
module.exports.MvModifyVariableDose = MvModifyVariableDose;
module.exports.MvEnterPatientPreference = MvEnterPatientPreference;
module.exports.MvEnterTotalDose = MvEnterTotalDose;
module.exports.MvChangeRate = MvChangeRate;
module.exports.MvPrescribeAdministerVariableDose = MvPrescribeAdministerVariableDose;
module.exports.MvModifyOrder = MvModifyOrder;
module.exports.MvModifyInsulinOrNutritionDose = MvModifyInsulinOrNutritionDose;
module.exports.MvNoZeroAfterdecimal = MvNoZeroAfterdecimal;
module.exports.MvPRNMaximumdailyDose = MvPRNMaximumdailyDose;
module.exports.MvPRNAdministerDose = MvPRNAdministerDose;
module.exports.MvDocumentMedicationManagementPlan = MvDocumentMedicationManagementPlan;
module.exports.MvMarkDoseNotAdministered = MvMarkDoseNotAdministered;
module.exports.MvDocumentVIPScore = MvDocumentVIPScore;
module.exports.MvAssessMetabolicStatus = MvAssessMetabolicStatus;
module.exports.MvRecordVentilation = MvRecordVentilation;
module.exports.MvReviewNeurological = MvReviewNeurological;
module.exports.MvRecordKnownAllergies = MvRecordKnownAllergies;
module.exports.MvDocumentDoseAdministration = MvDocumentDoseAdministration;
module.exports.MvReviewBurnsAdmission = MvReviewBurnsAdmission;
module.exports.MvDocumentInsertionCVC = MvDocumentInsertionCVC;
module.exports.MvDoubleSignoff = MvDoubleSignoff;
module.exports.MvAccessReferenceMaterial = MvAccessReferenceMaterial;
module.exports.MvReviewMedicationList = MvReviewMedicationList;
module.exports.MvDocumentOccupationalTheraphy = MvDocumentOccupationalTheraphy;
module.exports.MvDocumentPastoralCare = MvDocumentPastoralCare;
module.exports.MvDocumentVictimofCrime = MvDocumentVictimofCrime;
module.exports.MvDocumentPhysiotherapyProgress = MvDocumentPhysiotherapyProgress;
module.exports.MvDocumentPhysiotherapySOAP = MvDocumentPhysiotherapySOAP;
module.exports.MvDocumentResearchProgress = MvDocumentResearchProgress;
module.exports.MvDocumentResuscitation = MvDocumentResuscitation;
module.exports.MvDocumentClinicalEvent = MvDocumentClinicalEvent;
module.exports.MvReviewReferral = MvReviewReferral;
module.exports.MvReviewStatus = MvReviewStatus;
module.exports.MvPlacePatient = MvPlacePatient;
module.exports.MvValidateCorrectPatient = MvValidateCorrectPatient;
module.exports.MvPrescriberDetails = MvPrescriberDetails;
module.exports.MvAdministerInfusedMedication = MvAdministerInfusedMedication;
module.exports.MvUretericDrain = MvUretericDrain;
module.exports.MvReviewNutrition = MvReviewNutrition;
module.exports.MvSafetyCheckList = MvSafetyCheckList;
module.exports.MvArterialCatheter = MvArterialCatheter;
module.exports.MvDocumentFasthug = MvDocumentFasthug;
module.exports.MvNursingManagent = MvNursingManagent;
module.exports.MVNursingProgressNote = MVNursingProgressNote;
module.exports.MvDocumentFoodChart = MvDocumentFoodChart;
module.exports.MvValidateOverdueMedication = MvValidateOverdueMedication;
module.exports.MvDocumentAndScheduleWoundCare = MvDocumentAndScheduleWoundCare;
module.exports.MVPrintPatientRecord =MVPrintPatientRecord; 
module.exports.MVNDISNote = MVNDISNote;
module.exports.MVMedicalNote = MVMedicalNote;
module.exports.MVDomesticViolenceAVONote = MVDomesticViolenceAVONote;
module.exports.MVNursingAssessmentNote =MVNursingAssessmentNote;
module.exports.MVAdvancedCareDirective = MVAdvancedCareDirective;
module.exports.MVAlertsAndIsolationRequirements = MVAlertsAndIsolationRequirements;
module.exports.MVPharmacyProgressNote = MVPharmacyProgressNote;
module.exports.MVAlliedHealthProgressNotes = MVAlliedHealthProgressNotes
module.exports.MvPrintPatientBelongings = MvPrintPatientBelongings;
module.exports.MvAssessMetabolicDischarge = MvAssessMetabolicDischarge;
module.exports.MvPlanPatientCare = MvPlanPatientCare;
module.exports.MvNavigatePatientFiles = MvNavigatePatientFiles;
module.exports.MvFluidBalancesCheck = MvFluidBalancesCheck;
module.exports.MvRecordPatientDeath = MvRecordPatientDeath;
module.exports.MvAssembleModifyPatient = MvAssembleModifyPatient;
module.exports.MvDocumentPresenceTTube = MvDocumentPresenceTTube;
module.exports.MvCompleteRuleNinesChart = MvCompleteRuleNinesChart;
module.exports.MvViewPathology = MvViewPathology;
module.exports.MvCompleteInjurySeverity = MvCompleteInjurySeverity;
module.exports.MvUploadMedicalRetrieval = MvUploadMedicalRetrieval;
module.exports.MvConfirmCurrentAllergies = MvConfirmCurrentAllergies;
module.exports.MvReviewBurnDepthDescrip = MvReviewBurnDepthDescrip;
module.exports.MvReviewAlliedHealthProgress = MvReviewAlliedHealthProgress;
module.exports.MvValidateCorrectUser = MvValidateCorrectUser;
module.exports.MvMedicationRecordView = MvMedicationRecordView;
module.exports.MvVitalSignsWeightsHeights = MvVitalSignsWeightsHeights;
module.exports.MveHOCPatientDetails = MveHOCPatientDetails;
module.exports.MvPrescribeAntimicrobialMedication = MvPrescribeAntimicrobialMedication;
module.exports.MVPhysiotherapyAssessmentTool = MVPhysiotherapyAssessmentTool;
module.exports.MVManualHandling = MVManualHandling;
module.exports.MVMedicalDischargeSummary = MVMedicalDischargeSummary;
module.exports.MVPrintMedicalDischargeSummary = MVPrintMedicalDischargeSummary;
module.exports.MVExcel = MVExcel;
module.exports.MvReleasePatient =MvReleasePatient;
module.exports.MvPatientDeathDateTime = MvPatientDeathDateTime;
module.exports.MVNursingDischargeSummary = MVNursingDischargeSummary;
module.exports.MvAdvancedSearchPatient = MvAdvancedSearchPatient;
module.exports.MvChronologicalPrint =MvChronologicalPrint;
module.exports.MvIntraAorticBalloonCatheter = MvIntraAorticBalloonCatheter;
module.exports.MvSubduralDrain = MvSubduralDrain;
module.exports.MvBalloonTamponadeDevice = MvBalloonTamponadeDevice;
module.exports.MvCAMICU= MvCAMICU;
module.exports.MvDBUpdateLogin = MvDBUpdateLogin;
module.exports.MvDBUpdateLogout = MvDBUpdateLogout;
module.exports.MvDBUpdateSearchByAllFields = MvDBUpdateSearchByAllFields;
module.exports.MvClosePatient = MvClosePatient;
module.exports.MvDBUpdateAllFields = MvDBUpdateAllFields;
module.exports.MvDBUpdateUnsaved= MvDBUpdateUnsaved;
module.exports.MvPatientDetailsFromDB = MvPatientDetailsFromDB;
module.exports.MvDBUpdateSearchByFacility =MvDBUpdateSearchByFacility;
module.exports.MvDBUpdateSearchByAUID =MvDBUpdateSearchByAUID;
module.exports.MvDBUpdateArhiveDBSearchByFields =MvDBUpdateArhiveDBSearchByFields;
module.exports.MvDBUpdateArhiveDBSearchAllPatient = MvDBUpdateArhiveDBSearchAllPatient;
module.exports.MvDBUpdateNoResult =MvDBUpdateNoResult;
module.exports.MveHOCRegularMedication = MveHOCRegularMedication;
module.exports.MvDocumentClinicalEventNew = MvDocumentClinicalEventNew;
module.exports.MvPrescribePharmaVTE = MvPrescribePharmaVTE;
module.exports.SavePDF = SavePDF;
module.exports.CloseAcrobatInstances = CloseAcrobatInstances;
module.exports.MvSaveImages = MvSaveImages;
module.exports.MvPrescribeMeds_Resolve = MvPrescribeMeds_Resolve;
module.exports.MvPrescribeMedsSelectedtime = MvPrescribeMedsSelectedtime;
module.exports.MvPrescribeSetInterval = MvPrescribeSetInterval;
module.exports.MvPrescribeOralMedication = MvPrescribeOralMedication;
module.exports.MvPatientRegisterNoBed = MvPatientRegisterNoBed;
module.exports.CompareLastPDFAsImg = CompareLastPDFAsImg;
module.exports.CompareRoutePRN = CompareRoutePRN;
module.exports.MvPatientRegisterQuick = MvPatientRegisterQuick;
module.exports.MvPopulatePatientData = MvPopulatePatientData;
module.exports.MvReleasePatientAtWorkList = MvReleasePatientAtWorkList;
module.exports.MvPressureRiskAssessment = MvPressureRiskAssessment;
module.exports.MvVerifyAdmissionDischargeTime = MvVerifyAdmissionDischargeTime;
module.exports.MvLaunchOperationalReports = MvLaunchOperationalReports;
module.exports.MvExtractInitialOpReports = MvExtractInitialOpReports;
module.exports.MvBrowserLogout = MvBrowserLogout;
module.exports.MvRefreshOpReports = MvRefreshOpReports;
module.exports.MvVerifyFinalOR = MvVerifyFinalOR;
module.exports.MvChangeTypeOfAdmission = MvChangeTypeOfAdmission;
module.exports.MvExitBlockFromICUOR = MvExitBlockFromICUOR;
module.exports.MvTracheostomyTube = MvTracheostomyTube;
module.exports.MvAllergiesOR = MvAllergiesOR;
module.exports.MvDocumentInsertionPICC = MvDocumentInsertionPICC;
module.exports.MvDocumentDialysisCatherer = MvDocumentDialysisCatherer;
module.exports.MvRecordInvasiveVentilation = MvRecordInvasiveVentilation;
module.exports.MvRecordNonInvasiveVentilation = MvRecordNonInvasiveVentilation;
module.exports.MvHighFlowVentilation = MvHighFlowVentilation;
module.exports.MvLaunchInitialOpReports = MvLaunchInitialOpReports;
module.exports.MvAddSpecificClinicalEvent = MvAddSpecificClinicalEvent;
module.exports.MvRRTSelect = MvRRTSelect;
module.exports.MvChangeSourceAndTypeOfAdmission = MvChangeSourceAndTypeOfAdmission;
module.exports.MVVerifyANZICSDetailsTab01 = MVVerifyANZICSDetailsTab01;
//module.exports.MVVerifyANZICSDetailsTab02 = MVVerifyANZICSDetailsTab02;
//module.exports.MVVerifyANZICSDetailsTab03 = MVVerifyANZICSDetailsTab03;
//module.exports.MVVerifyANZICSDetailsTab04 = MVVerifyANZICSDetailsTab04;